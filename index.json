[{"content":"1. MySQL Error in log file Server stopped immediately after running ./server in shell, and output an error MySQL Error in log file.\n  Find the source of the error: Although the error log is fairly vague, it\u0026rsquo;s not difficult to find out that it was thrown by the function connection_pool::init in the file CGImysql/sql_connection_pool.cpp.\n mysql_init(): return an initialized MYSQL* handler (i.e. a MYSQL object suitable for mysql_real_connect()), or NULL in case of insufficient memory. mysql_real_connect(): return a MYSQL* connection handler if the connection was successful, NULL if the connection was unsuccessful. It\u0026rsquo;s no doubt that detailed error output helps us to locate the problem.  void connection_pool::init(string url, string User, string PassWord, string DBName, int Port, int MaxConn, int close_log) { m_url = url; m_Port = Port; m_User = User; m_PassWord = PassWord; m_DatabaseName = DBName; m_close_log = close_log; for (int i = 0; i \u0026lt; MaxConn; i++) { MYSQL* con = NULL; con = mysql_init(con); if (con == NULL) { // If `mysql_init()` return NULL, print corresponding error log.  // LOG_ERROR(\u0026#34;MySQL Error\u0026#34;);  LOG_ERROR(\u0026#34;MySQL Error: `mysql_init()` return NULL, maybe there was insufficient memory to allocate a new object.\u0026#34;); exit(1); } MYSQL* temp = con; con = mysql_real_connect(con, url.c_str(), User.c_str(), PassWord.c_str(), DBName.c_str(), Port, NULL, 0); if (con == NULL) { // If `mysql_real_connect()` return NULL, print correspnding error log.  // LOG_ERROR(\u0026#34;MySQL Error\u0026#34;);  string err_info( mysql_error(temp) ); err_info = (string(\u0026#34;MySQL Error [errno=\u0026#34;) + std::to_string(mysql_errno(temp)) + string(\u0026#34;]: \u0026#34;) + err_info); LOG_ERROR( err_info.c_str() ); exit(1); } connList.push_back(con); ++m_FreeConn; } reserve = sem(m_FreeConn); m_MaxConn = m_FreeConn; }   Identify error type: after modifying the log output style, the following error ocurrs:\n2022-04-03 19:30:29.360109 [erro]: MySQL Error [errno=1045]: Access denied for user \u0026#39;USER_NAME\u0026#39;@\u0026#39;localhost\u0026#39; (using password: YES)   Solutions:\n Check whether the database information in the main.cpp file is correct, including USER_NAME, PASSWORD, and DATABASE_NAME. Verify that user USER_NAME has access privileges to the target database DATABASE_NAME.    ","permalink":"https://jifan.tech/projects/tiny-web-server/problems/","summary":"1. MySQL Error in log file Server stopped immediately after running ./server in shell, and output an error MySQL Error in log file.\n  Find the source of the error: Although the error log is fairly vague, it\u0026rsquo;s not difficult to find out that it was thrown by the function connection_pool::init in the file CGImysql/sql_connection_pool.cpp.\n mysql_init(): return an initialized MYSQL* handler (i.e. a MYSQL object suitable for mysql_real_connect()), or NULL in case of insufficient memory.","title":"Tiny Web Server: Problems Encountered"},{"content":" Before starting the TinyWebServer project, I took a quick look at what a web server is. This article is a general summary of it, based on my current basic understanding.\n 1. What is a web server? The term web server can refer to software or underlying hardware.\n On the hardware side, a web server is a computer that:  stores web server software and a website\u0026rsquo;s component files (e.g., HTML documents, images, CSS stylesheets and JavaScript files). connects to the Internet and supports physical data interchange with other devices connected to the web.   On the software side, a web server includes several parts that control how web users access hosted files.  At a minimum, this is an HTTP server. An HTTP server is a software that understands URLs (web address) and HTTP (the network protocal created to dsitribute web content). An HTTP server can be accessed through the domain names of the websites it stores. Besides HTTP, web servers can also support SMTP and FTP, used for email, file transfer and storage. It can deliver the content of hosted websites to the end usrer\u0026rsquo;s device, and also can accept and stores resources sent from the user agent if configured to do so.     Figure 1. A basic Client-Server model. (source: developer.mozilla.org)\n  Typically, web servers are classified as static and dynamic.\n A static web server, or stack, consists of a computer (hardware) with an HTTP server (software). We call it \u0026ldquo;static\u0026rdquo; because the server sends its hosted files as-is to your browser. A dynamic web server consists of a static web server plus extra software, most commonly an application server and a database. We call it \u0026ldquo;dynamic\u0026rdquo; because the application server updates the hosted files before sending content to your browser via the HTTP server.  Currently, the most used Web Servers in the world are Apache HTTP Server, Nginx, Microsoft-IIS, OpenResty, etc.\n2. How a client and server communicate? Normally, a client makes HTTP requests to a server.\n The server responds to the client\u0026rsquo;s HTTP requests. And the server and also populate data into a client cache, in advance of it being requested, through a mechanism called a server push. When requesting a file via HTTP, the client must provice the file\u0026rsquo;s URL. The web server must answer every HTTP request, at least with an error message.  On a web server, the HTTP server is responsible for processing and answering incoming requests.\n Upon receiving a request, an HTTP server first checks if the requested URL matches an existing file. If so, the web server sends the file content back to the browser. If not, an appicatoin server builds the necesary file. If neither process is possible, the web server returns an error message to the browser, most commonly 404 Not Found (indicates that the server cannot find the requested resource).  3. Performances To improve the user experience (on client / browser side), a web server should reply quickly (as soon as possible) to client requests; unless content response is throttled (by configuration) for some type of files (e.g. big or huge files), also returned data content should be sent as fast as possible (high transfer speed).\n3.1 Performance metrics For web server software, main key performance metrics usually are at least the following ones:\n number of requests per second (RPS); It\u0026rsquo;s similar to QPS (queries per second), depending on HTTP version and configuration, type of HTTP requests and other operating conditions; number of connections per second (CPS), is the number of connections per second accepted by web server; network latency + response time for each new client request; throughput of responses, in bytes per second.  3.2 Benchmarking Web server benchmarking is the process of estimating a web server performance in order to find if the server can serve sufficiently high workload. The measurements must be performed under a varying load of clients and requests per client.\nLoad testing (stress/performance testing) a web server can be performed using automation/analysis tools.\n Refrences:\n What is a web server? - Learn web development | MDN Web server - Wikipedia   ","permalink":"https://jifan.tech/posts/2022-04-02-web-server/","summary":"Before starting the TinyWebServer project, I took a quick look at what a web server is. This article is a general summary of it, based on my current basic understanding.\n 1. What is a web server? The term web server can refer to software or underlying hardware.\n On the hardware side, a web server is a computer that:  stores web server software and a website\u0026rsquo;s component files (e.","title":"A Primer on Web Server"},{"content":"Yes, indeed. This is not my first blog. You may find that there are some posts publised in quite a few years ago, followed by a long gap. Perhaps there will be an opportunity to tell you the story of that time â€¦â€¦\n1. My Previous Blogs 1.1 A taste of WordPress WordPress was, and probably still is, the most popular blog hosting platform in the world. It\u0026rsquo;s almost entirely code-free to start a blog with WordPress. Unfortunately, I wasn\u0026rsquo;t an enthusiastic blogger then, so this product of a whim was left unused as soon as it was built.\n Figure 1. My first but empty blog\n  1.2 Blogging with Jekyll on a NGINX Server By the time I rediscovered my passion for blogging, Jekyll, as a static site generator, has already caught on. Detailed documentation, rich themes, and an active community were my reasons for choosing it.\nAfter installing the prerequisites, the entire setup process can be divided into 3 poarts.\n Server setting:  Nginx installation, configuration and deployment. server { listen 80 ; server_name _ localhost my-thistledown.com www.my-thistledown.com ; location = /webhook { proxy_pass http://127.0.0.1:3001/webhook; } # return 301 https://www.my-thistledown.com$request_uri; } server { listen 443; server_name my-thistledown.com; return 301 https://www.my-thistledown.com$request_uri; } server { listen 443 default_server ssl; server_name www.my-thistledown.com; ssl on; ssl_certificate /etc/nginx/ssl/my-thistledown.com/1692217_my-thistledown.com.pem; ssl_certificate_key /etc/nginx/ssl/my-thistledown.com/1692217_my-thistledown.com.key; ssl_session_timeout 5m; ssl_protocols TLSv1 TLSv1.1 TLSv1.2; ssl_ciphers AESGCM:ALL:!DH:!EXPORT:!RC4:+HIGH:!MEDIUM:!LOW:!aNULL:!eNULL; ssl_prefer_server_ciphers on; root /usr/share/nginx/html; index index.html index.htm; location / { root /usr/share/nginx/html; index index.html; } error_page 404 /404.html; error_page 500 502 503 504 /50x.html; location = /50x.html { root /usr/share/nginx/html; } }  Open specified ports (80, 443) and resolve my domain name to the server IP address.   Jekyll site building:  Create a new Jekyll site and add some posts. Build the site and output a static site to the nginx server\u0026rsquo;s root directory (in may case, /usr/share/nginx/html), located by the nginx configuration file.   Automated deployment:  Webhooks allow me to subscribe to certain events on GitHub.com. Every time I write a post or modify the blog locally and synchronize with the remote repository via git push, a HTTP POST payload will be sent to the webhook\u0026rsquo;s configured URL. With the help of github-webhook-handler, I can receive and verifying webhook requests from GitHub and execute the local script to pull the remote repositry and rebuild the site.    2. This New Hugo-based Blog As it claims, Hugo makes building websites fun and fast. Similarly, the website building process is divided into the following stages:\n Hugo site building:  Install hugo, create a new site and add a theme, with a blistering speedğŸ’¨. Add my old posts. I was impressed by the built-in LiveReload, which saved me from repeatedly refreshing the page during development to see content changes, as I did with Jekyll.   GitHub Pages deployment:  Compared to my last site, I have to admit that GitHub Pages is a more time- and money-saving way to host a personal blog. Configuring a custom domain for my GitHub Pages site.   Add my own content:  Custom some CSS styles of the original theme. Add content and front matther to page templates. Updates:  Support $\\KaTeX$ (2022.03.29). Add a projects listing page and change the style of cover image (2022.04.02). Custom syntax highlighting style and make code block collapsible.      3. More The process of rebooting my blog not only helped me pick up some of the front-end knowledge I had forgotten, but also provided me with a new window of expression.\nToday, building such a site is no longer a complex project. From WordPress to Jekyll and now Hugo. I\u0026rsquo;m happy to embrace these new technologies that help us implement our ideas faster and more easily.\n","permalink":"https://jifan.tech/projects/blog/","summary":"Why and how to build this blog.","title":"Blog"},{"content":" æœ¬æ–‡åŠæ¥ä¸‹æ¥å‡ ç¯‡åŒç³»åˆ—æ–‡ç« æ˜¯å­¦ä¹  SIFT ç®—æ³•å’Œ OpenCV SIFT æºç æ—¶çš„å­¦ä¹ ç¬”è®°ï¼Œæ•´åˆè‡ªå‚è€ƒæ–‡çŒ®åŠåšå®¢ã€‚å¼ºçƒˆå»ºè®®é˜…è¯» è®ºæ–‡åŸæ–‡ã€GitHubä¸Šçš„æºç  ä»¥åŠ @èµµæ˜¥æ±Ÿ çš„ opencv 2.4.9 æºç åˆ†æã€‚\n 1. SIFT ç®—æ³•åŸç† Lowe åœ¨ 2004 å¹´æå‡ºäº†å°ºåº¦ä¸å˜ç‰¹å¾å˜æ¢ (Scale Invariant Feature Transform, SIFT) ç®—æ³•ã€‚ SIFT ä¸»è¦ç”±å…³é”®ç‚¹æ¢æµ‹å™¨ (detector) å’Œæè¿°ç¬¦ (descriptor) ç»„æˆï¼Œå®ƒçš„å®ç°åˆ†ä¸ºä»¥ä¸‹å››æ­¥:\n å°ºåº¦ç©ºé—´æå€¼æ¢æµ‹ (scale-space extrema detection)ï¼šé€šè¿‡é«˜æ–¯å·®åˆ†å‡½æ•°æœç´¢æ‰€æœ‰å°ºåº¦å’Œå›¾åƒä½ç½®ï¼Œä»¥è¯†åˆ«å¯¹äºå°ºåº¦å’Œæ–¹å‘ä¸å˜çš„æ½œåœ¨å…´è¶£ç‚¹ã€‚ å…³é”®ç‚¹ç²¾ç¡®å®šä½ (keypoint localization)ï¼šç²¾ç¡®ç¡®å®šæ¯ä¸ªå€™é€‰ç‚¹çš„å°ºåº¦ä¸äºšåƒç´ çº§ä½ç½®ï¼Œæ ¹æ®å…¶ç¨³å®šæ€§é˜ˆå€¼é€‰æ‹©å…³é”®ç‚¹ã€‚ æ–¹å‘åˆ†é… (orientation assignment)ï¼šåŸºäºå›¾åƒçš„å±€éƒ¨æ¢¯åº¦æ–¹å‘ï¼Œä¸ºæ¯ä¸ªç‰¹æ€§ç‚¹åˆ†é…ä¸€ä¸ªæˆ–å¤šä¸ªæ–¹å‘è§’åº¦ã€‚æ‰€æœ‰åç»­çš„æ“ä½œéƒ½æ˜¯ç›¸å¯¹äºæ‰€ç¡®å®šä¸‹æ¥çš„ç‰¹å¾ç‚¹çš„è§’åº¦ã€å°ºåº¦å’Œä½ç½®çš„åŸºç¡€ä¸Šè¿›è¡Œçš„ï¼Œå› æ­¤ç‰¹å¾ç‚¹å…·æœ‰è§’åº¦ã€å°ºåº¦å’Œä½ç½®çš„ä¸å˜æ€§ã€‚ å…³é”®ç‚¹æè¿°ç¬¦ (keypoint descriptor)ï¼šåœ¨æ‰€é€‰å®šçš„å°ºåº¦ç©ºé—´å†…ï¼Œæµ‹é‡ç‰¹å¾ç‚¹é‚»åŸŸåŒºåŸŸçš„å±€éƒ¨å›¾åƒæ¢¯åº¦ï¼Œå°†è¿™äº›æ¢¯åº¦è½¬æ¢æˆä¸€ç§å…è®¸å±€éƒ¨è¾ƒå¤§ç¨‹åº¦çš„å½¢çŠ¶å˜å½¢å’Œäº®åº¦å˜åŒ–çš„æè¿°ç¬¦å½¢å¼ã€‚  ä¸‹é¢å°†å¯¹å…¶è¿›è¡Œè¯¦ç»†é˜é‡Šï¼š\n1.1 å°ºåº¦ç©ºé—´æå€¼æ¢æµ‹ å…³é”®ç‚¹æ£€æµ‹çš„ç¬¬ä¸€é˜¶æ®µæ˜¯è¯†åˆ«å¯ä»¥åœ¨åŒä¸€å¯¹è±¡çš„ä¸åŒè§†å›¾ä¸‹é‡å¤åˆ†é…çš„ä½ç½®å’Œå°ºåº¦ã€‚é€šè¿‡åœ¨ç´ æœ‰å¯èƒ½çš„å°ºåº¦è¿›è¡Œæœç´¢ï¼Œå¯ä»¥æ£€æµ‹å‡ºå¯¹å›¾åƒå°ºåº¦ä¸å˜çš„ç¨³å®šç‰¹å¾ã€‚è¿™ä¸€è¿‡ç¨‹ä¸­ä½¿ç”¨åˆ°çš„æ˜¯è¢«ç§°ä¸ºå°ºåº¦ç©ºé—´ (scale space) çš„å°ºåº¦è¿ç»­å‡½æ•°^[1]ã€‚\nKoenderink (The structure of images, 1984) å’Œ Lindeberg (Detecting salient blob-like image structures and their scales with a scale-space primal sketch: A method for focus-of-attention, 1993) å·²ç»è¯æ˜ï¼Œå”¯ä¸€å¯èƒ½çš„å°ºåº¦ç©ºé—´æ ¸æ˜¯é«˜æ–¯å‡½æ•°ã€‚å› æ­¤ï¼Œå›¾åƒçš„å°ºåº¦ç©ºé—´è¢«å®šä¹‰ä¸ºå‡½æ•° $L(x, y, \\sigma)$ï¼Œå®ƒæ˜¯ç”±å¯å˜å°ºåº¦é«˜æ–¯å‡½æ•° $G(x, y, \\sigma)$ ä¸è¾“å…¥å›¾åƒ $I(x,y)$ å·ç§¯å¾—åˆ°çš„ï¼š\n$$ \\begin{equation*} L(x, y, \\sigma) = G(x, y, \\sigma) \\bigotimes I(x, y) % \\label{eq:scale-space} \\end{equation*} $$\nå…¶ä¸­ï¼Œ$\\bigotimes$ è¡¨ç¤ºåœ¨ $(x, y)$ å¤„çš„å·ç§¯è¿ç®—ã€‚ä¸”æœ‰ï¼š\n$$ \\begin{equation*} G(x, y, \\sigma) = \\frac{1}{2\\pi \\sigma^2}e^{-(x^2+y^2)/2\\sigma^2} % \\label{eq:gaussian} \\end{equation*} $$\nä¸ºäº†æœ‰æ•ˆåœ°æ£€æµ‹å°ºåº¦ç©ºé—´ä¸­ç¨³å®šå…³é”®ç‚¹çš„ä½ç½®ï¼ŒLowe (Object recognition from local scale-invariant features, 1999) æå‡ºåˆ©ç”¨é«˜æ–¯å·®åˆ†å‡½æ•°(difference-of-Gaussian) ä¸å›¾åƒçš„å·ç§¯æ¥æ±‚å¾—å°ºåº¦ç©ºé—´æå€¼ $D(x, y, \\sigma)$ã€‚å®ƒå¯ä»¥é€šè¿‡é—´éš”å¸¸æ•° $k$ çš„ç›¸é‚»å°ºåº¦çš„å·®åˆ†æ¥è®¡ç®—ï¼š\n$$ \\begin{align*} D(x,y,\\sigma) \u0026amp;= (G(x, y, k\\sigma) - G(x, y, \\sigma)) \\bigotimes I(x, y) \\cr \u0026amp;= L(x, y, k\\sigma) - L(x, y, \\sigma) \\tag{1} \\end{align*} $$\nè¿™æ ·åšçš„ç›®çš„æ˜¯ä¸ºäº†å‡å°‘è®¡ç®—é‡ï¼Œå› ä¸ºé«˜æ–¯å·®åˆ†å¯ä»¥é€šè¿‡å›¾åƒé—´ç®€å•çš„ç›¸å‡å¾—åˆ°ã€‚æ­¤å¤–ï¼ŒLindeberg çš„ç ”ç©¶è¡¨æ˜ï¼Œé«˜æ–¯å·®åˆ†å‡½æ•° $DoG$ ä¸å°ºåº¦å½’ä¸€åŒ–çš„é«˜æ–¯æ‹‰æ™®æ‹‰æ–¯ç®—å­ (Laplacian of Gaussian)ï¼Œ$\\sigma^2\\nabla^2G$ï¼Œæ˜¯è¿‘ä¼¼ç›¸ç­‰çš„ã€‚Lowe åœ¨è®ºæ–‡ä¸­å‘æˆ‘ä»¬è¯æ˜äº†å¦‚ä¸‹ç»“è®ºï¼š\n$$ \\begin{equation*} \\sigma\\nabla^2G = \\frac{\\partial G}{\\partial \\sigma} \\approx \\frac{G(x, y, k\\sigma) - G(x, y, \\sigma)}{k\\sigma - \\sigma} \\end{equation*} $$\nå› æ­¤, åˆ™æœ‰:\n$$ \\begin{equation*} G(x, y, k\\sigma) - G(x, y, \\sigma) \\approx (k - 1) \\sigma^2 \\nabla^2 G. \\end{equation*} $$\nå¼ä¸­å› å­ $(k-1)$ åœ¨ä»»ä½•å°ºåº¦ä¸Šéƒ½æ˜¯å¸¸æ•°ï¼Œå› æ­¤ä¸ä¼šå½±åƒæå€¼ä½ç½®ã€‚ä¸” Lowe å‘ç°è¿‘ä¼¼è¯¯å·®å¯¹äºæå€¼æ¢æµ‹å’Œå®šä½çš„ç¨³å®šæ€§å‡ ä¹æ²¡æœ‰å½±å“ã€‚\n å›¾ 1 SIFT ä¸­çš„å›¾åƒé‡‘å­—å¡”ã€‚å·¦ä¾§å°ºåº¦ç©ºé—´ä¸­çš„æ¯ä¸€ç»„å›¾åƒï¼Œéƒ½æ˜¯é€šè¿‡å¯¹åˆå§‹å›¾åƒé‡å¤è¿›è¡Œé«˜æ–¯å·ç§¯äº§ç”Ÿå¾—æ¥çš„ã€‚ç›¸é‚»é«˜æ–¯å›¾åƒç›¸å‡å¾—åˆ°äº†å³ä¾§çš„é«˜æ–¯å·®åˆ†å›¾åƒã€‚å°ºåº¦ç©ºé—´ä¸­æ¯ä¸€å±‚å›¾åƒéƒ½ç›¸å¯¹äºä¸Šä¸€å±‚è¿›è¡Œäº† 2 å€é™é‡‡æ ·ã€‚\n  é«˜æ–¯å·®åˆ†å›¾åƒ $D(x, y, \\sigma)$ é‡‘å­—å¡”çš„æ„é€ æ–¹æ³•å¦‚å›¾ 1 æ‰€ç¤ºã€‚é«˜æ–¯é‡‘å­—å¡”å…±åˆ† O ç»„ (Octave), æ¯ç»„åˆåˆ† S å±‚ (Layer)ã€‚ç»„å†…å„å±‚å›¾åƒçš„åˆ†è¾¨ç‡æ˜¯ç›¸åŒçš„ï¼Œå³é•¿å’Œå®½ç›¸åŒï¼Œä½†å°ºåº¦é€æ¸å¢åŠ ï¼Œå³è¶Šæ¥è¿‘é¡¶ç«¯å›¾åƒè¶Šæ¨¡ç³Šã€‚æ¯ä¸€å±‚çš„åˆå§‹å›¾åƒä¸é«˜æ–¯é€æ­¥å·ç§¯ï¼Œäº§ç”Ÿç”±å°ºåº¦ç©ºé—´ä¸­çš„å¸¸æ•°å› å­ $k$ åˆ†éš”çš„å›¾åƒï¼Œå¦‚å·¦åˆ—æ‰€ç¤ºã€‚æ¯ä¸€å±‚çš„é«˜æ–¯å›¾åƒé‡‘å­—å¡”å®Œæˆä¹‹åï¼Œæˆ‘ä»¬é€‰å–è¯¥å±‚çš„ç¬¬äºŒå¼ å›¾åƒè¿›è¡Œéš”ç‚¹é™é‡‡æ · (å›¾åƒé•¿å’Œå®½å‡å°ä¸ºåŸæ¥çš„ $1/2$)ï¼Œä½œä¸ºä¸‹ä¸€å±‚çš„åˆå§‹å½±åƒ (å› æ­¤å…¶å°ºåº¦å› å­ $\\sigma$ ä¸ºä¸Šå±‚å›¾åƒçš„ä¸¤å€)ã€‚SIFT å°†æ¯å±‚å°ºåº¦ç©ºé—´åˆ’åˆ†ä¸ºæ•´æ•° $s$ ä¸ªå­å±‚, å› æ­¤ $k=2^{1/s}$ã€‚æ‰€ä»¥ä¸ºäº†è¦†ç›–å…¨éƒ¨çš„ $s$ å°ºåº¦, é«˜æ–¯é‡‘å­—å¡”ä¸­æ¯å±‚è‡³å°‘è¦æœ‰ $s+3$ å¼ å›¾åƒã€‚é«˜æ–¯é‡‘å­—å¡”å±‚ä¸­ç›¸é‚»å›¾åƒä¹‹å·®æ„æˆäº†å³ä¾§çš„é«˜æ–¯å·®åˆ†å›¾åƒé‡‘å­—å¡”ã€‚\næå€¼ç‚¹çš„æœç´¢æ˜¯åœ¨é«˜æ–¯å·®åˆ†é‡‘å­—å¡”ä¸­è¿›è¡Œçš„, è¿™äº›æå€¼ç‚¹å°±æ˜¯å€™é€‰çš„ç‰¹å¾ç‚¹ã€‚ä¸ºäº†æ£€æµ‹ $D(x, y, \\sigma)$ ä¸­çš„å±€éƒ¨æœ€å¤§å€¼å’Œæœ€å°å€¼ï¼ŒSIFT å°†æ¯ä¸ªé‡‡æ ·ç‚¹ä¸å½“å‰å›¾åƒä¸­å…«ä¸ªç›¸é‚»åƒç´ çš„å€¼ä»¥åŠä¸Šä¸‹å±‚å°ºåº¦ä¸­çš„ä¹ä¸ªç›¸é‚»åƒç´ å€¼è¿›è¡Œå¯¹æ¯” (å¦‚å›¾ 2)ã€‚è¿™é¡¹æœç´¢å·¥ä½œçš„è®¡ç®—æˆæœ¬éå¸¸ä½, å› ä¸ºå¾ˆå¤šé‡‡æ ·ç‚¹åœ¨é‚»åŸŸåƒç´ å€¼æ¯”è¾ƒçš„è¿‡ç¨‹ä¸­è¢«æ’é™¤äº†ã€‚\n å›¾ 2 å°†é‡‡æ ·ç‚¹ (ç”¨ $\\times$ è¡¨ç¤º) åƒç´ å€¼ä¸å½“å‰åŠç›¸é‚»ä¸¤ä¸ªå°ºåº¦å±‚çš„ 3$\\times$3 é‚»åŸŸä¸­çš„ 26 ä¸ªç‚¹ (ç”¨åœ†åœˆè¡¨ç¤º) ä½œæ¯”è¾ƒï¼Œåˆ¤æ–­æ˜¯å¦ä¸ºæå¤§å€¼æˆ–æå°å€¼ã€‚\n  1.2 å…³é”®ç‚¹çš„ç²¾ç¡®å®šä½ ç”±äºæå€¼ç‚¹çš„æœç´¢æ˜¯åœ¨ç¦»æ•£ç©ºé—´ä¸­è¿›è¡Œçš„ï¼Œå¹¶ä¸”è¿™äº›ç¦»æ•£ç©ºé—´è¿˜æ˜¯ç»è¿‡ä¸æ–­é‡‡æ ·å¾—åˆ°çš„ã€‚é€šè¿‡å±€éƒ¨æå€¼æ¢æµ‹ç¡®å®šå€™é€‰ç‚¹çš„ä½ç½®å’Œå°ºåº¦ä¹‹å, æˆ‘ä»¬éœ€è¦é€šè¿‡ä¸‰ç»´äºŒæ¬¡å‡½æ•°æ‹Ÿåˆå¾—åˆ°å…³é”®ç‚¹çš„ç²¾ç¡®ä½ç½®ï¼Œä»¥è¾¾åˆ°äºšåƒç´ çº§çš„ç²¾åº¦ã€‚\næ ¹æ® Invariant Features from Interest Point Groups (2002) ï¼Œå°ºåº¦ç©ºé—´å‡½æ•° $D(x, y, \\sigma)$ æ³°å‹’å±•å¼€åˆ°äºŒæ¬¡é¡¹çš„å½¢å¼ä¸ºï¼š\n$$ \\begin{equation} D(\\mathbf{x})=D+\\frac{\\partial D}{\\partial \\mathbf{x}}^{T} \\mathbf{x}+\\frac{1}{2} \\mathbf{x}^{\\mathbf{T}} \\frac{\\partial^{2} D}{\\partial \\mathbf{x}^{2}} \\mathbf{x} % \\label{eq:dog-taylor} \\end{equation} \\tag{2} $$\nå…¶ä¸­ $D$ ä¸º $D(x, y, \\sigma)$ åœ¨å…³é”®ç‚¹å¤„çš„å€¼ï¼Œ$\\mathbf{x}=(x, y, \\sigma)^T$ æ˜¯å…³é”®ç‚¹çš„åç§»é‡ã€‚ä»¤\n$$ \\frac{\\partial D(\\mathbf{x})}{\\partial\\mathbf{x}} = 0 $$\nå³å¯å¾—åˆ° $\\mathbf{x}$ çš„æå€¼ $\\mathbf{\\hat{x}}$ï¼š\n$$ \\begin{equation} \\hat{\\mathbf{x}}=-\\frac{\\partial^{2} D^{-1}}{\\partial \\mathbf{x}^{2}} \\frac{\\partial D}{\\partial \\mathbf{x}} % \\label{eq:dog-3} \\end{equation} \\tag{3} $$\nå¦‚æœ $\\hat{\\mathbf{x}}$ åœ¨ä»»æ„æ–¹å‘ $(x, y, \\sigma)$ ä¸Šå¤§äº 0.5ï¼Œå°±æ„å‘³ç€è¯¥å…³é”®ç‚¹ä¸å¦ä¸€é‡‡æ ·éå¸¸æ¥è¿‘ï¼Œè¿™æ—¶å°±ç”¨æ’å€¼æ¥ä»£æ›¿å…³é”®ç‚¹çš„ä½ç½®ã€‚å…³é”®ç‚¹å‡è®¾åç§»é‡ $\\hat{\\mathbf{x}})$ å³ä¸ºå…³é”®ç‚¹çš„ç¡®ä½ç½®ã€‚ä¸ºäº†ä¿è¯ç»“æœçš„å‡†ç¡®æ€§ï¼Œæˆ‘ä»¬å¾€å¾€ä½¿ç”¨è¿­ä»£çš„æ–¹æ³•è¿›è¡Œè¿™ä¸€æ’å€¼è¿‡ç¨‹ã€‚\nå®šä½åˆ°å…³é”®ç‚¹çš„ç²¾ç¡®ä½ç½®åï¼Œä¸ºæé«˜åŒ¹é…çš„ç¨³å®šæ€§ï¼Œæˆ‘ä»¬éœ€è¦åˆ é™¤ä½å¯¹æ¯”åº¦çš„ç‚¹ã€‚å°†å¼ (3) ä»£å…¥ (2) å¾—ï¼š\n$$ D(\\hat{\\mathbf{x}})=D+\\frac{1}{2} \\frac{\\partial D}{\\partial \\mathbf{x}} \\hat{\\mathbf{x}} $$\nå¼ä¸­ $D(\\hat{\\mathbf{x}})$ å¯ä»¥ç”¨æ¥è¡¡é‡ç‰¹å¾ç‚¹çš„å¯¹æ¯”åº¦ï¼Œåœ¨ Lowe çš„è®ºæ–‡ä¸­ï¼Œå¯¹æ¯”åº¦ $|D(\\hat{\\mathbf{x}})|$ å°äº 0.03 çš„æå€¼ç‚¹ä¼šè¢«èˆå¼ƒã€‚\nè€Œä¸ºäº†ä¿è¯å…³é”®ç‚¹çš„ç¨³å®šæ€§ï¼Œä»…ä»…èˆå¼ƒä½å¯¹æ¯”åº¦çš„å€™é€‰ç‚¹æ˜¯ä¸å¤Ÿçš„ã€‚é«˜æ–¯å·®åˆ†å‡½æ•°åœ¨ä¼šäº§ç”Ÿå¾ˆå¼ºçš„è¾¹ç¼˜æ•ˆåº”ï¼Œå› æ­¤å¾ˆå®¹æ˜“å—åˆ°å™ªå£°çš„å¹²æ‰°ã€‚æ‰€ä»¥æˆ‘ä»¬ä¹Ÿéœ€è¦å‰”é™¤æ‰è¿™äº›ä¸ç¨³å®šçš„è¾¹ç¼˜ç‚¹ã€‚\né«˜æ–¯å·®åˆ†å‡½æ•°çš„ç›¸åº”å³°å€¼å¾€å¾€åœ¨æ¨ªè·¨è¾¹ç¼˜çš„åœ°æ–¹æœ‰è¾ƒå¤§çš„çš„ä¸»æ›²ç‡ï¼Œè€Œåœ¨å‚ç›´è¾¹ç¼˜çš„åœ°æ–¹æœ‰è¾ƒå°çš„ä¸»æ›²ç‡ã€‚ ä¸»æ›²ç‡å¯ä»¥é€šè¿‡ $2 \\times 2$ çš„ Hessian çŸ©é˜µ $\\mathbf{H}$ æ¥è®¡ç®—ï¼š\n$$ \\begin{equation} \\mathbf{H}=\\left[ \\begin{array}{cc}{D_{x x}} \u0026amp; {D_{x y}} \\ {D_{x y}} \u0026amp; {D_{y y}}\\end{array}\\right] % \\label{eq:sift-hessian} \\end{equation} \\tag{4} $$\nå…¶ä¸­ï¼Œå¯¼æ•°å¯ä»¥é€šè¿‡ç›¸é‚»æ ·æœ¬ç‚¹çš„å·®åˆ†æ¥è®¡ç®—ã€‚\n$\\mathbf{H}$ çš„ç‰¹å¾å€¼ä¸ $D$ çš„ä¸»æ›²ç‡æˆæ­£æ¯”ã€‚è®¾ $\\alpha$ æ˜¯æœ€å¤§çš„ç‰¹å¾å€¼ï¼Œ$\\beta$ æ˜¯æœ€å°çš„ç‰¹å¾å€¼ã€‚ç‰¹å¾å€¼çš„æ€»å’Œä¸ä¹˜ç§¯å¯ä»¥åˆ†åˆ«é€šè¿‡ $\\mathbf{H}$ çš„è¿¹ä¸è¡Œåˆ—å¼æ¥è®¡ç®—ï¼š\n$$ \\begin{align*} \\text{Tr}(\\mathbf{H}) \u0026amp;= D_{xx} + D_{yy} = \\alpha + \\beta \\ \\text{Det}(\\mathbf{H}) \u0026amp;= D_{xx}D_{yy} - (D_{xy})^2 = \\alpha\\beta \\end{align*} $$\nå¦‚æœè¡Œåˆ—å¼ä¸ºè´Ÿï¼Œåˆ™è¯¥å€™é€‰ç‚¹å°†è¢«èˆå¼ƒã€‚ä»¤ $r$ ä¸ºæœ€å¤§ç‰¹å¾å€¼ä¸æœ€å°ç‰¹å¾å€¼çš„æ¯”å€¼ï¼Œå³ $r = \\alpha / \\beta$ï¼Œåˆ™ï¼š\n$$ \\frac{\\operatorname{Tr}(\\mathbf{H})^{2}}{\\operatorname{Det}(\\mathbf{H})}=\\frac{(\\alpha+\\beta)^{2}}{\\alpha \\beta}=\\frac{(r \\beta+\\beta)^{2}}{r \\beta^{2}}=\\frac{(r+1)^{2}}{r} $$\n$\\frac{(r + 1)^2}{r}$ çš„å€¼åœ¨ä¸¤ä¸ªç‰¹å¾å€¼ç›¸ç­‰æ—¶æœ€å°ï¼Œå¹¶ä¸”éšç€ $r$ çš„å¢å¤§è€Œå¢å¤§ã€‚å› æ­¤ï¼Œä¸ºäº†æ£€æŸ¥ä¸»æ›²ç‡çš„æ¯”å€¼æ˜¯å¦ä½äºæŸä¸ªé˜ˆå€¼ $r$ï¼Œåªéœ€è¦åˆ¤æ–­ï¼š\n$$ \\frac{\\operatorname{Tr}(\\mathbf{H})^{2}}{\\operatorname{Det}(\\mathbf{H})}\u0026lt;\\frac{(r+1)^{2}}{r} $$\nè¿™æ ·èƒ½å¤Ÿæ˜¾è‘—æé«˜è®¡ç®—æ•ˆç‡ã€‚åŒæ—¶æˆ‘ä»¬å–ç»éªŒå€¼ $r = 10$ï¼Œå³æ’é™¤ä¸»æ›²ç‡ä¹‹æ¯”å¤§äº 10 çš„å€™é€‰ç‚¹ã€‚\n1.3 æ–¹å‘åˆ†é… ç»è¿‡ä¸Šè¿°ä¸¤ä¸ªæ­¥éª¤ï¼Œæˆ‘ä»¬å¯ä»¥å®Œå…¨æ‰¾å‡ºä¸€å¹…å›¾åƒä¸­çš„ç‰¹å¾ç‚¹ï¼Œä¸”å®ƒä»¬å¯¹äºå°ºåº¦å…·æœ‰ä¸å˜æ€§ã€‚è€Œæ ¹æ®å±€éƒ¨å›¾åƒå±æ€§ä¸ºæ¯ä¸ªå…³é”®ç‚¹æŒ‡å®šæŸä¸ªæ–¹å‘ï¼Œåˆ™å…³é”®ç‚¹æè¿°ç¬¦å¯ä»¥é€šè¿‡è¯¥æ–¹å‘æ¥è¡¨ç¤ºï¼Œä»è€Œå®ç°äº†æ—‹è½¬ä¸å˜æ€§ã€‚æˆ‘ä»¬æ ¹æ®å…³é”®ç‚¹çš„å°ºåº¦é€‰æ‹©ä¸ä¹‹æœ€æ¥è¿‘çš„é«˜æ–¯å¹³æ»‘å›¾åƒ $L$ï¼Œä»¥ä½¿å¾—æ‰€æœ‰è®¡ç®—æ»¡è¶³äº†å°ºåº¦ä¸å˜æ€§ã€‚å¯¹è¯¥å°ºåº¦ä¸‹çš„æ¯ä¸€ä¸ªå›¾åƒé‡‡æ ·ç‚¹ $L(x, y)$ï¼Œæˆ‘ä»¬æ ¹æ®åƒç´ å€¼å·®åˆ†æ¥è®¡ç®—å…¶æ¢¯åº¦å¹…å€¼ $m(x, y)$ å’Œæ–¹å‘ $\\theta(x, y)$ï¼š\n$$ \\begin{array}{c} {m(x, y) = \\sqrt{\\left[L(x+1, y)-L(x-1, y)\\right]^{2} + \\left[L(x, y+1)-L(x, y-1)\\right]^{2}}} \\cr\\cr {\\theta(x, y)=\\tan ^{-1}[L(x, y+1)-L(x, y-1)] /[L(x+1, y)-L(x-1, y)]} \\end{array} $$\nSIFT æ ¹æ®å…³é”®ç‚¹é‚»åŸŸå†…æ ·æœ¬ç‚¹çš„æ¢¯åº¦æ–¹å‘æ¥ç”Ÿæˆæ–¹å‘ç›´æ–¹å›¾ã€‚è¯¥ç›´æ–¹å›¾ä¸€å…±æœ‰ 36 æŸ± (bin)ï¼Œä¸€æŸ± $10^{\\circ}$ï¼Œè¦†ç›–æ•´ä¸ª $0^{\\circ} \\sim 360^{\\circ}$ çš„èŒƒå›´ã€‚æ·»åŠ åˆ°ç›´æ–¹å›¾ä¸­çš„æ¯ä¸ªæ ·æœ¬ç‚¹æ¢¯åº¦æ–¹å‘éƒ½ä¼šæ ¹æ®å…¶æ¢¯åº¦å¹…å€¼ä»¥åŠåœ†å½¢é«˜æ–¯åŠ æƒçª—å£ (å…¶ $\\sigma$ ä¸ºå…³é”®ç‚¹å°ºåº¦çš„ 1.5 å€) è¿›è¡ŒåŠ æƒã€‚\næ–¹å‘ç›´æ–¹å›¾çš„å³°å€¼å¯¹åº”äºå…³é”®ç‚¹å±€éƒ¨æ¢¯åº¦çš„ä¸»æ–¹å‘ã€‚åŒæ—¶ï¼Œå¦‚æœç›´æ–¹å›¾ä¸­çš„æŸä¸€æŸ±çš„å³°å€¼é«˜äºå…¶å‰åä¸¤æŸ±ï¼Œä¸”å¤§äºå¤§äºä¸»å³°å€¼çš„ 80%ï¼Œåˆ™æˆ‘ä»¬åœ¨è¯¥ä½ç½®å¤„ä¹Ÿåˆ›å»ºå…·æœ‰è¯¥æŸ±æ‰€ä»£è¡¨çš„æ–¹å‘ (å¯è§†ä¸ºè¾…æ–¹å‘) çš„å…³é”®ç‚¹ã€‚å› æ­¤ï¼Œå¦‚æœä¸€ä¸ªæ–¹å‘ç›´æ–¹å›¾æœ‰å¾ˆå¤šå¹…å€¼ç›¸è¿‘çš„å³°å€¼ï¼Œé‚£ä¹ˆåœ¨å…¶ç›¸åŒå°ºåº¦å’Œä½ç½®å¤„ä¼šæœ‰å¾ˆå¤šå…³é”®ç‚¹ï¼Œä½†å®ƒä»¬çš„æ–¹å‘æœ‰æ‰€ä¸åŒã€‚æ ¹æ® Lowe çš„ç»“è®ºï¼Œå¤§æ¦‚åªæœ‰ 15% çš„ç‚¹è¢«åˆ†é…äº†å¤šä¸ªæ–¹å‘ï¼Œä½†è¿™äº›æ–¹å‘èƒ½å¤Ÿæ˜¾è‘—æé«˜åŒ¹é…çš„ç¨³å®šæ€§ã€‚å€¼å¾—æ³¨æ„çš„æ˜¯ï¼Œæ¯ä¸ªç›´æ–¹å›¾å³°å€¼å¯¹åº”æ–¹å‘æ˜¯é€šè¿‡å¯¹å…¶æœ€æ¥è¿‘çš„ä¸‰ä¸ªæŸ±è¿›è¡ŒæŠ›ç‰©çº¿æ‹Ÿåˆã€ç„¶åå†æ’å€¼å¾—åˆ°çš„ã€‚\n1.4 å…³é”®ç‚¹æè¿°ç¬¦ ä¹‹å‰çš„æ­¥éª¤å·²ç»ä¸ºæ¯ä¸ªå…³é”®ç‚¹åˆ†é…äº†å›¾åƒä½ç½®ã€å°ºåº¦å’Œæ–¹å‘ã€‚åœ¨å›¾åƒå±€éƒ¨åŒºåŸŸå†…ï¼Œåœ¨å›¾åƒå±€éƒ¨åŒºåŸŸå†…ï¼Œè¿™äº›å‚æ•°å¯ä»¥é‡å¤åœ°ç”¨ä»¥æè¿°å±€éƒ¨äºŒç»´åæ ‡ç³»ç»Ÿï¼Œå› ä¸ºè¿™äº›å‚æ•°å…·æœ‰ä¸å˜æ€§ã€‚æœ€åä¸€æ­¥åˆ™æ˜¯è®¡ç®—å±€éƒ¨å›¾åƒåŒºåŸŸçš„æè¿°ç¬¦ (local descriptor)ï¼Œè¯¥æè¿°ç¬¦å…·æœ‰é«˜åº¦çš„ç‹¬ç‰¹æ€§ï¼ŒåŒæ—¶å¯¹äºå…‰ç…§æˆ– 3D è§†ç‚¹çš„å˜åŒ–å…·æœ‰å¾ˆé«˜çš„é²æ£’æ€§ã€‚\n å›¾ 3 é¦–å…ˆé€šè¿‡è®¡ç®—å…³é”®ç‚¹é‚»åŸŸä¸­æ¯ä¸ªé‡‡æ ·ç‚¹çš„æ¢¯åº¦å¤§å°å’Œæ–¹å‘æ¥åˆ›å»ºå…³é”®ç‚¹æè¿°ç¬¦ï¼Œå¦‚å·¦ä¾§æ‰€ç¤ºã€‚è®¡ç®—è¿‡ç¨‹ç”±å›¾åƒä¸­çš„åŸå‹é«˜æ–¯åŠ æƒçª—å£è¿›è¡ŒåŠ æƒã€‚ç„¶ååœ¨é‚»åŸŸèŒƒå›´å†…åˆ›å»ºæ–¹å‘ç›´æ–¹å›¾ã€‚\n  å›¾ 3 å±•ç°äº†æè¿°ç¬¦çš„è®¡ç®—æ–¹æ³•ã€‚é¦–å…ˆï¼Œæ ¹æ®å…³é”®ç‚¹çš„å°ºåº¦é€‰æ‹©ç›¸åŒæ¨¡ç³Šç¨‹åº¦çš„é«˜æ–¯é‡‘å­—å¡”å½±åƒï¼Œå¯¹å…³é”®ç‚¹é‚»åŸŸå†…åƒç´ è¿›è¡Œé‡‡æ ·ä»¥æ±‚å¾—å…¶å›¾åƒæ¢¯åº¦å’Œæ–¹å‘ã€‚ä¸ºäº†ä¿è¯ç‰¹å¾çŸ¢é‡å…·æœ‰æ—‹è½¬ä¸å˜æ€§ï¼Œä»¥å…³é”®ç‚¹ä¸ºä¸­å¿ƒï¼Œåœ¨å…¶é‚»åŸŸå†…å°†æè¿°ç¬¦çš„åæ ‡è½´å’Œæ¢¯åº¦æ–¹å‘æ—‹è½¬è‡³å…³é”®ç‚¹çš„ä¸»æ–¹å‘ã€‚å›¾ 3 å·¦ä¾§å›¾åƒä¸­çš„æ¯ä¸ªå°ç®­å¤´ä»£è¡¨è¯¥é‡‡æ ·ç‚¹çš„æ¢¯åº¦æ–¹å‘å’Œå¤§å°ã€‚ä½¿ç”¨é«˜æ–¯åŠ æƒå‡½æ•° ($\\sigma$ ç­‰äºæè¿°ç¬¦çª—å£å®½åº¦ 1/2) æ¥ä¸ºæ¯ä¸ªé‡‡æ ·ç‚¹çš„æ¢¯åº¦å¹…å€¼åˆ†é…æƒé‡ï¼Œå›¾ä¸­åœ†åœˆä»£è¡¨çª—å£èŒƒå›´ã€‚\nç„¶ååœ¨å…³é”®ç‚¹ $4\\times 4$ çš„é‚»åŸŸèŒƒå›´å†…åˆ›å»ºæ–¹å‘ç›´æ–¹å›¾ã€‚å…³é”®ç‚¹æè¿°ç¬¦å¦‚å›¾ 3 ä¸­å³ä¾§å›¾åƒæ‰€ç¤ºã€‚æ¯ä¸ªç›´æ–¹å›¾æœ‰å…«ä¸ªæ–¹å‘ï¼Œç®­å¤´é•¿åº¦å¯¹åº”ä¸è¯¥ç›´æ–¹å›¾å¹…å€¼çš„å¤§å°ã€‚è¯¥å›¾ä¸­æ˜¾ç¤ºçš„æ˜¯ $2 \\times 2$ çš„æ–¹å‘ç›´æ–¹å›¾é˜µåˆ—ï¼Œæ ¹æ® Lowe çš„è®ºæ–‡ç»“æœï¼Œä½¿ç”¨ $4 \\times 4$ çš„æ–¹å‘ç›´æ–¹å›¾é˜µåˆ—ï¼Œæ¯ä¸ªç›´æ–¹å›¾æœ‰å…«ä¸ªæ–¹å‘ï¼Œå¯ä»¥æé«˜åŒ¹é…çš„ç¨³å¥æ€§ã€‚è¿™æ ·å¯¹äºæ¯ä¸ªå…³é”®ç‚¹å°±å¯ä»¥äº§ç”Ÿ $4 \\times 4 \\times 8 = 128$ ç»´çš„ç‰¹å¾å‘é‡ã€‚\næ­¤æ—¶çš„ç‰¹å¾å‘é‡å·²ç»æ¶ˆå»äº†å°ºåº¦å˜åŒ–ã€æ—‹è½¬ç­‰å‡ ä½•å˜å½¢å› ç´ çš„å½±å“ã€‚æœ€åè¿˜éœ€å¯¹ç‰¹å¾å‘é‡è¿›è¡Œä¸€å®šçš„ä¿®æ­£ï¼Œä»¥è¿›ä¸€æ­¥é™ä½ç…§æ˜å˜åŒ–çš„å½±å“ã€‚å…ˆå°†ç‰¹å¾å‘é‡çš„å½’ä¸€åŒ–ä¸ºå•ä½é•¿åº¦ã€‚è¿™æ ·å¯ä»¥ä½¿å¾—æè¿°ç¬¦ä¸æ”¶å…‰ç…§ä»¿å°„å˜æ¢çš„å½±å“ã€‚è€Œå¯¹äºéçº¿æ€§å…‰ç…§æ¡ä»¶çš„å˜åŒ–ï¼ŒSIFT é€šè¿‡å¯¹å•ä½ç‰¹å¾å‘é‡ä¸­çš„å€¼è¿›è¡Œé˜ˆå€¼åŒ–å¤„ç†ï¼Œæ˜¯æ¯ä¸ªå€¼ä¸å¤§äº 0.2 (è¯¥å€¼é€šè¿‡å®éªŒéªŒè¯å¾—å‡º)ï¼Œç„¶åå†é‡æ–°å½’ä¸€åŒ–ä¸ºå•ä½å‘é‡ã€‚æœ€ç»ˆå¾—åˆ°çš„è¿™ä¸ª 128 ç»´çš„å‘é‡å³ä¸º SIFT ç‰¹å¾å‘é‡ã€‚\n1.5 SIFT åŒ¹é…æ–¹æ³• SIFT ä¸­çš„å±€éƒ¨ç‰¹å¾æè¿°ç®—å­å¯¹äºæ—‹è½¬ã€å°ºåº¦ç¼©æ”¾å’Œäº®åº¦å˜åŒ–ä¿æŒä¸å˜ï¼Œä¸”å¯¹äº 3D è§†è§’å˜åŒ–ã€ä»¿å°„å˜æ¢ã€ å™ªå£°ç­‰ä¹Ÿå…·æœ‰å¾ˆé«˜çš„é²æ£’æ€§ã€‚å¾—åˆ°ä¸¤å‰¯ç›®æ ‡å½±åƒçš„ SIFT ç‰¹å¾å‘é‡ä¹‹åï¼Œæˆ‘ä»¬é‡‡ç”¨å…³é”®ç‚¹ç‰¹å¾å‘é‡çš„æ¬§æ°è·ç¦»ä½œä¸ºä¸¤å¹…å½±åƒä¸­å…³é”®ç‚¹çš„ç›¸ä¼¼æ€§åˆ¤å®šåº¦é‡ã€‚åœ¨å·¦å›¾åƒä¸­å–å‡ºæŸä¸ªå…³é”®ç‚¹ï¼Œå¹¶é€šè¿‡éå†æ‰¾å‡ºå…¶ä¸å³å½±åƒä¸­æ¬§æ°è·ç¦»æœ€æ¥è¿‘çš„ä¸¤ä¸ªå…³é”®ç‚¹ã€‚å¦‚æœæœ€é‚»è¿‘å…³é”®ç‚¹ä¸ç¬¬äºŒé‚»è¿‘å…³é”®ç‚¹è·ç¦»è·ç¦»ä¹‹æ¯”ä½äºæŸä¸ªé˜ˆå€¼ (ç»éªŒå€¼ä¸º 0.8)ï¼Œåˆ™æ¥å—è¿™ä¸€å¯¹åŒ¹é…ç‚¹ã€‚\nå€¼å¾—æ³¨æ„çš„æ˜¯, é€šè¿‡è°ƒæ•´åŒ¹é…è¿‡ç¨‹ä¸­çš„é˜ˆå€¼ï¼Œæˆ‘ä»¬å¯ä»¥å½±å“åˆ°åŒ¹é…ç»“æœçš„æ­£ç¡®ç‡ä¸åŒ¹é…ç‚¹çš„æ•°é‡ã€‚æ­¤å¤–ï¼ŒSIFT ç®—å­å¯¹å¾ˆå°çš„å½±åƒæˆ–å°‘æ•°å‡ ä¸ªç‰©ä½“ä¹Ÿèƒ½äº§ç”Ÿå¤§é‡çš„ç‰¹å¾ç‚¹ï¼Œè€Œ SIFT åŒ¹é…è¿‡ç¨‹ä¸­é‡‡ç”¨äº†é€å…³é”®ç‚¹éå†çš„æ–¹æ³•, è¿™åœ¨å¯¹å¤§å°ºå¯¸å½±åƒå¤„ç†æ—¶æœ‰ç€éš¾ä»¥æƒ³è±¡çš„è®¡ç®—å¼€é”€ã€‚\n2. ç®—æ³•å®ç°-å¤´æ–‡ä»¶ #pragma once #include \u0026lt;cstdio\u0026gt;#include \u0026lt;opencv2/opencv.hpp\u0026gt; using namespace std; using namespace cv; /// ç±»å®šä¹‰ class SIFT { public: /// æ„é€ å‡½æ•°  SIFT(int nOctaves = 4, int nOctaveLayers = 3, double sigma = 1.6, int nfeatures = 0, double contrastThreshold = 0.04, double edgeThreshold = 10); /// SIFT ç±»çš„é‡è½½æ“ä½œç¬¦  void operator()(InputArray img, vector\u0026lt;KeyPoint\u0026gt;\u0026amp; keyPoints, OutputArray descriptors); /// å»ºç«‹é«˜æ–¯é‡‘å­—å¡”  void buildGaussianPyramid(const Mat\u0026amp; base, vector\u0026lt;Mat\u0026gt;\u0026amp; pyr); /// å»ºç«‹é«˜æ–¯å·®åˆ†é‡‘å­—å¡”  void buildGaussianDifferencePyramid(vector\u0026lt;Mat\u0026gt; gauss_pyr, vector\u0026lt;Mat\u0026gt;\u0026amp; dog_pry); /// å°ºåº¦ç©ºé—´æå€¼æ¢æµ‹  void findScaleSpaceExtrema(vector\u0026lt;Mat\u0026gt;\u0026amp; gauss_pyr, vector\u0026lt;Mat\u0026gt;\u0026amp; dog_pyr, vector\u0026lt;KeyPoint\u0026gt;\u0026amp; keyPoints); protected: int O;\t// å°ºåº¦ç©ºé—´æ•°  int S;\t// æ¯å±‚å°ºåº¦ç©ºé—´çš„å­å±‚æ•°  double sigma;\t// å°ºåº¦ç©ºé—´å› å­  int nfeatures;\t// éœ€è¦è¾“å‡ºçš„ç‰¹å¾ç‚¹æ•°é‡  double contrastThreshold;\t// å¯¹æ¯”åº¦é˜ˆå€¼  double edgeThreshold;\t// è¾¹ç¼˜é˜ˆå€¼ }; /// å®æŒ‡ä»¤ // åˆå§‹å›¾åƒçš„å°ºåº¦ï¼Œå‡è®¾ä¸º 0.5 ï¼ˆby D.G.Loweï¼‰ static const double SIFT_INIT_SIGMA = 0.5; // æè¿°ç¬¦æ•°ç»„ä¸­æ¯ä¸ªç›´æ–¹å›¾çš„æŸ±æ•° static const int SIFT_DESCR_HIST_BINS = 8; // åœ¨å…³é”®ç‚¹æå–ä¸­å¿½ç•¥çš„è¾¹ç¼˜å®½åº¦ static const int SIFT_IMG_BORDER = 5; // å…³é”®ç‚¹æ’å€¼çš„æœ€å¤§è¿­ä»£æ¬¡æ•° static const int SIFT_MAX_INTERP_STEPS = 5; // æ–¹å‘åˆ†é…ä¸­é«˜æ–¯å‡½æ•°çš„ Ïƒ static const double SIFT_ORI_SIG_FCTR = 1.5; // æ–¹å‘åˆ†é…ä¸­ç›®æ ‡åŒºåŸŸçš„åŠå¾„ static const double SIFT_ORI_RADIUS = 3 * SIFT_ORI_SIG_FCTR; // æ–¹å‘åˆ†é…çš„æ¢¯åº¦ç›´æ–¹å›¾æŸ±æ•°ï¼ˆèŒƒå›´ä¸º 0 ~ 360Â°ï¼Œæ¯ 10Â° ä¸€ä¸ªæŸ±ï¼Œå…± 36 æŸ±ï¼‰ static const int SIFT_ORI_HIST_BINS = 36; // æè¿°ç¬¦ç›´æ–¹å›¾æ•°ç»„çš„é»˜è®¤å®½åº¦ static const int SIFT_DESCR_WIDTH = 4; // ç¡®å®šå•ä¸ªæè¿°ç¬¦æ–¹å‘ç›´æ–¹å›¾çš„å¤§å° static const double SIFT_DESCR_SCL_FCTR = 3.0; // æè¿°ç¬¦å‘é‡å…ƒç´ å¤§å°çš„é˜ˆå€¼ static const double SIFT_DESCR_MAG_THR = 0.2; // ç”¨äºå°†æµ®ç‚¹æ•°æè¿°ç¬¦è½¬æ¢ä¸º uchar ç±»å‹ static const double SIFT_INT_DESCR_FCTR = 512; /// å‡½æ•°å£°æ˜ // åˆå§‹åŒ–åŸºå±‚å›¾åƒçŸ©é˜µ static Mat createInitialImage(const Mat\u0026amp; img, double _sigma); // æå€¼ç‚¹çš„ç²¾ç¡®å®šä½ static bool adjustLocalExtrema(const vector\u0026lt;Mat\u0026gt;\u0026amp; dog_pyr, KeyPoint\u0026amp; keyPoint, int octave, int\u0026amp; layer, int\u0026amp; r, int\u0026amp; c, int nOctaveLayers, double contrastThreshold, double edgeThreshold, double _sigma); // è®¡ç®—å…³é”®ç‚¹å±€éƒ¨å½±åƒçš„æ¢¯åº¦æ–¹å‘ç›´æ–¹å›¾ static double calcOrientationHist(const Mat\u0026amp; img, Point pt, int radius, double _sigma, double* hist, int n); // å…³é”®ç‚¹ç‰¹å¾æè¿° static void calcSIFTDescriptor(const Mat\u0026amp; img, Point2d kpt, double ori, double scl, int d, int n, double* dst); // è®¡ç®—ç‰¹å¾ç‚¹æè¿°ç¬¦ static void calcDescriptors(const vector\u0026lt;Mat\u0026gt;\u0026amp; pyr, const vector\u0026lt;KeyPoint\u0026gt;\u0026amp; keyPoints, Mat\u0026amp; descriptors, int nOctaveLayers); æœªå®Œå¾…ç»­â€¦  å‚è€ƒï¼š\n opencv/opencv_contrib/sift.cpp - github D. G. Lowe, Distinctive Image Features from Scale-Invariant Keypoints, International Journal of Computer Vision, vol. 60, no. 2, pp. 91â€“110, 2004. opencv 2.4.9 æºç åˆ†æ ã€OpenCVã€‘SIFTåŸç†ä¸æºç åˆ†æ - å°é­çš„ä¿®è¡Œè·¯ - CSDNåšå®¢ SIFTç®—æ³•è¯¦è§£ - zddhubçš„ä¸“æ  - CSDNåšå®¢ SIFT: Theory and Practice - AI Shack å¼ å‰‘æ¸…ï¼Œæ½˜åŠ±ï¼Œç‹æ ‘æ ¹ï¼Œã€Šæ‘„å½±æµ‹é‡å­¦(ç¬¬äºŒç‰ˆ)ã€‹   ","permalink":"https://jifan.tech/posts/2019-05-10-opencv-4/","summary":"æœ¬æ–‡åŠæ¥ä¸‹æ¥å‡ ç¯‡åŒç³»åˆ—æ–‡ç« æ˜¯å­¦ä¹  SIFT ç®—æ³•å’Œ OpenCV SIFT æºç æ—¶çš„å­¦ä¹ ç¬”è®°ï¼Œæ•´åˆè‡ªå‚è€ƒæ–‡çŒ®åŠåšå®¢ã€‚å¼ºçƒˆå»ºè®®é˜…è¯» è®ºæ–‡åŸæ–‡ã€GitHubä¸Šçš„æºç  ä»¥åŠ @èµµæ˜¥æ±Ÿ çš„","title":"OpenCV æºç åˆ†æï¼šSIFT ç®—æ³•åŸç†ä¸å®ç°"},{"content":" æœ¬æ–‡ä¸»è¦å‚è€ƒè‡ª OpenCV å®˜æ–¹æ•™ç¨‹ OpenCV: Camera calibration With OpenCVï¼Œå¤§éƒ¨åˆ†å†…å®¹æ˜¯å¯¹åŸæ–‡çš„ç›´æ¥ç¿»è¯‘ã€‚\n 1. å‰è¨€ åˆ©ç”¨æ‰‹æœºç›¸æœºå¯¹æ£‹ç›˜å›¾æ‹æ‘„å¾—åˆ°çš„å›¾åƒå¦‚ä¸‹æ‰€ç¤ºï¼š\n å›¾ 1 æ‰‹æœºç›¸æœºæ‹æ‘„å›¾åƒï¼ˆå·¦ï¼‰åŠå…¶äºŒå€¼åŒ–å¤„ç†åçš„ç»“æœï¼ˆå³ï¼‰\n  å°†å…¶ä¸åŸå§‹æ£‹ç›˜å›¾å¯¹æ¯”ï¼Œå¯ä»¥æ˜æ˜¾åœ°çœ‹å‡ºï¼Œæ‰‹æœºæ‹æ‘„å›¾åƒå‡ºç°äº†ä¸€å®šç¨‹åº¦çš„ç•¸å˜ã€‚\n å›¾ 2 åŸå§‹å›¾åƒï¼ˆå·¦ï¼‰ä¸äºŒå€¼åŒ–å¤„ç†åçš„æ‰‹æœºæ‹æ‘„å›¾åƒï¼ˆå³ï¼‰å¯¹æ¯”\n  2. ç›¸æœºæ£€æ ¡åŸç† ç›®å‰å¸¸ç”¨çš„ç›¸æœºæ£€æ ¡æ–¹æ³•æ˜¯é™„åŠ å‚æ•°æ³•ï¼Œå…¶å…³é”®åœ¨äºé€šè¿‡ä¸€ç»„é¢å¤–å‚æ•°æ‹Ÿåˆé•œå¤´ç•¸å˜ï¼Œä¸»è¦æ˜¯å¾„å‘ç•¸å˜å’Œåˆ‡å‘ç•¸å˜ï¼š\n$$ \\begin{align*} dx \u0026amp; = \\overbrace{x(k_1r^2+k_2r^4+k_3r^6)}^{\\text{radial distortion}} + p_1(r^2+2x^2) + p_2xy \\cr dy \u0026amp; = y(k_1r^2+k_2r^4+k_3r^6) + \\underbrace{p_2(r^2+2y^2) + p_1 xy}_{\\text{tangential distortion}} \\end{align*} $$\nå¼ä¸­ï¼Œ\n$$ x=x\u0026rsquo;-x_0, \\newline y=y\u0026rsquo;-y_0, \\newline r^2 = x^2 + y^2 $$\nå…¶ä¸­ $(x\u0026rsquo;,y\u0026rsquo;)$ ä¸ºåƒç‰‡åæ ‡çš„åŸå§‹é‡æµ‹å€¼ï¼Œ$k_i,(i=1,2,3)$ ä¸ºå¾„å‘ç•¸å˜å‚æ•°ï¼Œ$p_j, (j=1,2)$ ä¸ºåˆ‡å‘ç•¸å˜å‚æ•°ã€‚æ‰€ä»¥ 5 ä¸ªç•¸å˜å‚æ•°æ„æˆçš„çŸ©é˜µä¸ºï¼š\n$$ \\text{distortion coeffients} = (\\begin{matrix}k_1\u0026amp;k_2\u0026amp;p_1\u0026amp;p_2\u0026amp;k_3\\end{matrix}) $$\nå¯¹äºå½±åƒåæ ‡å’Œç‰©ç©ºé—´åæ ‡çš„è½¬æ¢å…³ç³»ä¸ºï¼š\n$$ \\begin{bmatrix}x \\cr y \\cr f \\end{bmatrix}= K \\begin{bmatrix}X \\cr Y \\cr Z \\end{bmatrix}= \\begin{bmatrix}f_x \u0026amp; 0 \u0026amp; c_x \\cr 0 \u0026amp; f_y \u0026amp; c_y \\cr 0 \u0026amp; 0 \u0026amp; 1 \\end{bmatrix} \\begin{bmatrix}X \\cr Y \\cr Z \\end{bmatrix} $$\nå…¶ä¸­ï¼Œ$(x, y, w)$ æ˜¯åƒç‚¹åæ ‡åœ¨é½æ¬¡åæ ‡ç³»ä¸‹çš„è¡¨ç¤ºï¼ˆ$w=Z$ï¼‰ï¼Œ$(X,Y,Z)$ ä¸ºè¯¥ç‚¹å¯¹åº”çš„ç‰©æ–¹åæ ‡ã€‚è¯¥å¼æœ‰ 4 ä¸ªæœªçŸ¥æ•°ï¼Œ$f_x$ï¼Œ$f_y$ ä¸ºç›¸æœºç„¦è·ã€‚$c_x$ï¼Œ$c_y$ ä¸ºåƒä¸»ç‚¹åæ ‡ã€‚åŒ…å«è¿™ 4 ä¸ªå‚æ•°çš„çŸ©é˜µ $K$ è¢«ç§°ä¸ºç›¸æœºçŸ©é˜µã€‚\nç›¸æœºæ£€æ ¡çš„è¿‡ç¨‹å³æ˜¯æ±‚è§£ç›¸æœºçŸ©é˜µå’Œç•¸å˜çŸ©é˜µçš„è¿‡ç¨‹ã€‚è¿™äº›å‚æ•°å¯ä»¥é€šè¿‡ä¸€äº›åŸºæœ¬çš„å‡ ä½•æ–¹ç¨‹è¿›è¡Œè§£ç®—ï¼Œå…¶ä¸­ä½¿ç”¨çš„å…¬å¼å–å†³äºé€‰æ‹©çš„æ ¡å‡†å¯¹è±¡ï¼Œæœ¬æ–‡æ‰€å‚è€ƒçš„ OpenCV ç›¸æœºæ£€æ ¡æ–¹æ³•æ”¯æŒä¸‰ç§ç±»å‹çš„æ ¡å‡†å¯¹è±¡ï¼š\n ç»å…¸çš„é»‘ç™½æ£‹ç›˜å›¾æ¡ˆ å¯¹ç§°çš„åœ†åœˆå›¾æ¡ˆ ä¸å¯¹ç§°çš„åœ†åœˆå›¾æ¡ˆ  ä¸ºäº†æé«˜ç²¾åº¦ã€å¿½ç•¥å™ªå£°çš„å½±åƒï¼Œæˆ‘ä»¬å¾€å¾€éœ€è¦æ‹æ‘„å¤šå¼ ç…§ç‰‡ä»¥ä¾¿è¿›è¡Œæ•´ä½“è§£ç®—ã€‚è€Œæœ¬å›ä½¿ç”¨çš„é»‘ç™½æ£‹ç›˜å›¾æ¡ˆç†è®ºä¸Šæ‰€éœ€çš„ç›¸ç‰‡æ•°é‡æœ€å¤šï¼Œä¸ºæ­¤ï¼Œæˆ‘ä¸€å…±åœ¨ä¸åŒä½ç½®æ‹æ‘„äº† 10 å¼ ç›¸ç‰‡ï¼ˆè§ä¸‹å›¾ï¼‰ã€‚\n å›¾ 3 æ‰‹æœºç›¸æœºåœ¨ä¸åŒè§’åº¦ã€ä½ç½®æ‘„å½±å¾—åˆ° 10 å¼ å›¾åƒ\n  3. æ£€æ ¡è¿‡ç¨‹ é€šè¿‡å†å®ç° OpenCV çš„ç›¸æœºæ£€æ ¡æ ·ä¾‹ï¼Œæˆ‘ä»¬ä¸»è¦å®Œæˆäº†ä»¥ä¸‹è¿‡ç¨‹ï¼š\n ç¡®å®šç•¸å˜çŸ©é˜µ ç¡®å®šç›¸æœºçŸ©é˜µ æ‰¹é‡è·å–å½±åƒæ•°æ® ä» .XML/YAML æ–‡ä»¶ä¸­è¯»å–é…ç½® ä¿å­˜ç»“æœåˆ° .XML/YAML ä¸­ è®¡ç®—æŠ•å½±è¯¯å·®  å…¶ä¸­ï¼Œè¾“å…¥çš„é…ç½®æ–‡ä»¶ input.XML éƒ¨åˆ†å†…å®¹å¦‚ä¸‹ï¼š\n\u0026lt;?xml version=\u0026#34;1.0\u0026#34;?\u0026gt; \u0026lt;opencv_storage\u0026gt; \u0026lt;Settings\u0026gt; \u0026lt;!-- æ¯å¼ æ£€æµ‹çš„æ£‹ç›˜ç‚¹ä¸º 9Ã—6 ä¸ª --\u0026gt; \u0026lt;BoardSize_Width\u0026gt; 9\u0026lt;/BoardSize_Width\u0026gt; \u0026lt;BoardSize_Height\u0026gt;6\u0026lt;/BoardSize_Height\u0026gt; \u0026lt;!-- è¾“å…¥å›¾åƒçš„ç±»å‹ï¼Œè¿™é‡Œæˆ‘ä»¬é€‰æ‹©â€œæ£‹ç›˜å›¾â€ --\u0026gt; \u0026lt;Calibrate_Pattern\u0026gt;\u0026#34;CHESSBOARD\u0026#34;\u0026lt;/Calibrate_Pattern\u0026gt; \u0026lt;!-- è¾“å…¥å›¾åƒï¼Œç”¨äºç›¸æœºæ£€æ ¡ --\u0026gt; \u0026lt;Input\u0026gt;\u0026#34;inputImages.xml\u0026#34;\u0026lt;/Input\u0026gt; \u0026lt;!-- è¾“å‡ºçš„æ—¥å¿—æ–‡ä»¶ --\u0026gt; \u0026lt;Write_outputFileName\u0026gt;\u0026#34;out_camera_data.xml\u0026#34;\u0026lt;/Write_outputFileName\u0026gt; \u0026lt;/Settings\u0026gt; \u0026lt;/opencv_storage\u0026gt; ç”¨äºæ£€æ ¡çš„è¾“å…¥å›¾åƒï¼ˆå³ä¸Šæ–‡ä¸­çš„åå¼ ç›¸ç‰‡ï¼‰é€šè¿‡ inputImages.xml ç¡®å®šï¼š\n\u0026lt;?xml version=\u0026#34;1.0\u0026#34;?\u0026gt; \u0026lt;opencv_storage\u0026gt; \u0026lt;images\u0026gt; imgs/IMG_01.jpg imgs/IMG_02.jpg imgs/IMG_03.jpg imgs/IMG_04.jpg imgs/IMG_05.jpg imgs/IMG_06.jpg imgs/IMG_07.jpg imgs/IMG_08.jpg imgs/IMG_09.jpg imgs/IMG_10.jpg \u0026lt;/images\u0026gt; \u0026lt;/opencv_storage\u0026gt; è¿è¡Œä»£ç ï¼ŒOpenCV é€šè¿‡ findChessboardCorners() å‡½æ•°æ‰¾åˆ°æ¯å¼ ç›¸ç‰‡ä¸­æŒ‡å®šæ•°ç›®çš„æ£‹ç›˜ç‚¹ $(9\\times6)$ï¼Œæ¯”å¦‚ï¼š\n å›¾ 4 findChessboardCorners() å‡½æ•°åœ¨å•å¼ ç›¸ç‰‡ä¸Šçš„è®¡ç®—ç»“æœ\n  ä¸è¿‡å¯èƒ½æ˜¯ç”±äºå…‰ç…§ç­‰å› ç´ å½±å“ï¼Œç¬¬å…«å¼ ç›¸ç‰‡ä¸­çš„ç‚¹å¹¶æœªæˆåŠŸè¯†åˆ«å‡ºã€‚ç¨‹åºå°†å°è¯•åœ¨æ‰€æœ‰è¾“å…¥å›¾åƒä¸­æ‰¾åˆ°å¹¶ç»˜å‡ºè¿™äº›æ£‹ç›˜ç‚¹ï¼š\n å›¾ 5 å…¨éƒ¨æ£‹ç›˜ç‚¹è¯†åˆ«ç»“æœ\n  æœ€ç»ˆæˆ‘ä»¬é€šè¿‡ imwrite() å‡½æ•°ï¼Œè¾“å‡ºæ ¡æ­£å˜å½¢åçš„å›¾åƒï¼š\n å›¾ 6 å¯¹ç›¸æœºç•¸å˜è¿›è¡Œæ ¡æ­£åçš„ç»“æœ\n  åœ¨è¾“å‡ºçš„ out_camera_data.xml æ–‡ä»¶ä¸­ï¼Œæˆ‘ä»¬å¯ä»¥å¾—åˆ°ç›¸æœºæ£€æ ¡è¿‡ç¨‹ä¸­çš„æ‰€æœ‰å‚æ•°ï¼ŒåŒ…æ‹¬ç›¸æœºçŸ©é˜µã€ç•¸å˜å‚æ•°çŸ©é˜µå’Œæ£€æµ‹ç‚¹çš„åæ ‡ç­‰ã€‚\n\u0026lt;?xml version=\u0026#34;1.0\u0026#34;?\u0026gt; \u0026lt;opencv_storage\u0026gt; \u0026lt;calibration_time\u0026gt;\u0026#34;Fri Apr 19 14:12:13 2019\u0026#34;\u0026lt;/calibration_time\u0026gt; \u0026lt;nr_of_frames\u0026gt;9\u0026lt;/nr_of_frames\u0026gt; \u0026lt;image_width\u0026gt;900\u0026lt;/image_width\u0026gt;\t\u0026lt;!-- è¾“å…¥å›¾åƒå®½åº¦ --\u0026gt; \u0026lt;image_height\u0026gt;1200\u0026lt;/image_height\u0026gt;\t\u0026lt;!-- è¾“å…¥å›¾åƒé«˜åº¦ --\u0026gt; \u0026lt;board_width\u0026gt;9\u0026lt;/board_width\u0026gt; \u0026lt;board_height\u0026gt;6\u0026lt;/board_height\u0026gt; \u0026lt;square_size\u0026gt;50.\u0026lt;/square_size\u0026gt; \u0026lt;fix_aspect_ratio\u0026gt;1.\u0026lt;/fix_aspect_ratio\u0026gt; \u0026lt;flags\u0026gt;6158\u0026lt;/flags\u0026gt; \u0026lt;fisheye_model\u0026gt;0\u0026lt;/fisheye_model\u0026gt; \u0026lt;camera_matrix type_id=\u0026#34;opencv-matrix\u0026#34;\u0026gt;\t\u0026lt;!-- ç›¸æœºçŸ©é˜µ --\u0026gt; \u0026lt;rows\u0026gt;3\u0026lt;/rows\u0026gt; \u0026lt;cols\u0026gt;3\u0026lt;/cols\u0026gt; \u0026lt;dt\u0026gt;d\u0026lt;/dt\u0026gt; \u0026lt;data\u0026gt; 1.1462822465241961e+03 0. 450. 0. 1.1462822465241961e+03 600. 0. 0.1. \u0026lt;/data\u0026gt; \u0026lt;/camera_matrix\u0026gt; \u0026lt;distortion_coefficients type_id=\u0026#34;opencv-matrix\u0026#34;\u0026gt;\t\u0026lt;!-- ç•¸å˜çŸ©é˜µ --\u0026gt; \u0026lt;rows\u0026gt;5\u0026lt;/rows\u0026gt; \u0026lt;cols\u0026gt;1\u0026lt;/cols\u0026gt; \u0026lt;dt\u0026gt;d\u0026lt;/dt\u0026gt; \u0026lt;data\u0026gt; 5.2379099530930096e-01 -4.0406900157339871e+00 0. 0.8.8954798029406810e+00 \u0026lt;/data\u0026gt; \u0026lt;/distortion_coefficients\u0026gt; \u0026lt;avg_reprojection_error\u0026gt;6.1070913167798235e-01\u0026lt;/avg_reprojection_error\u0026gt; \u0026lt;per_view_reprojection_errors type_id=\u0026#34;opencv-matrix\u0026#34;\u0026gt; \u0026lt;rows\u0026gt;9\u0026lt;/rows\u0026gt; \u0026lt;cols\u0026gt;1\u0026lt;/cols\u0026gt; \u0026lt;dt\u0026gt;f\u0026lt;/dt\u0026gt; \u0026lt;data\u0026gt; 7.01961458e-01 6.66437447e-01 5.47557890e-01 5.58410525e-01 4.83857125e-01 5.62040746e-01 6.58297598e-01 6.49597406e-01 6.34681106e-01 \u0026lt;/data\u0026gt; \u0026lt;/per_view_reprojection_errors\u0026gt; \u0026lt;extrinsic_parameters type_id=\u0026#34;opencv-matrix\u0026#34;\u0026gt; \u0026lt;rows\u0026gt;9\u0026lt;/rows\u0026gt; \u0026lt;cols\u0026gt;6\u0026lt;/cols\u0026gt; \u0026lt;dt\u0026gt;d\u0026lt;/dt\u0026gt; \u0026lt;data\u0026gt;\u0026lt;!-- ç•¥ --\u0026gt;\u0026lt;/data\u0026gt; \u0026lt;/extrinsic_parameters\u0026gt; \u0026lt;image_points type_id=\u0026#34;opencv-matrix\u0026#34;\u0026gt; \u0026lt;rows\u0026gt;9\u0026lt;/rows\u0026gt; \u0026lt;cols\u0026gt;54\u0026lt;/cols\u0026gt; \u0026lt;dt\u0026gt;\u0026#34;2f\u0026#34;\u0026lt;/dt\u0026gt; \u0026lt;data\u0026gt;\u0026lt;!-- ç•¥ --\u0026gt;\u0026lt;/data\u0026gt; \u0026lt;/image_points\u0026gt; \u0026lt;grid_points\u0026gt;\u0026lt;!-- ç•¥ --\u0026gt;\u0026lt;/grid_points\u0026gt; \u0026lt;/opencv_storage\u0026gt; ç›¸æœºçŸ©é˜µï¼š\n$$ \\begin{align*} \\text{Camera Matrix} \u0026amp;= \\begin{bmatrix} f_x \u0026amp; 0 \u0026amp; c_x \\cr 0 \u0026amp; f_y \u0026amp; c_y \\cr 0 \u0026amp; 0 \u0026amp; 1 \\end{bmatrix} \\cr \u0026amp;= \\begin{bmatrix} 1146.282 \u0026amp; 0 \u0026amp; 450 \\cr 0 \u0026amp; 1146.282 \u0026amp; 600 \\cr 0 \u0026amp; 0 \u0026amp; 1 \\end{bmatrix} \\end{align*} $$\nå…¶ä¸­ï¼Œç›¸æœºç„¦è·çš„ç²¾ç¡®å€¼ä¸º $f_x=f_y=1.1462822465241961e+03$ï¼Œä¸” $c_x=450$ï¼Œ$c_y=600$ï¼Œé‰´äºè¾“å…¥å›¾åƒçš„å°ºå¯¸ä¸º $900\\times1200$ï¼Œå¯ä»¥æ¨æ–­å‡ºç¨‹åºç›´æ¥å°†å›¾åƒä¸­å¿ƒä½œä¸ºåƒä¸»ç‚¹ã€‚\nç•¸å˜çŸ©é˜µï¼š\n$$ \\begin{align*} \\text{distortion coeffients} \u0026amp;= \\begin{bmatrix}k_1\u0026amp;k_2\u0026amp;p_1\u0026amp;p_2\u0026amp;k_3\\end{bmatrix} \\cr \u0026amp;= \\begin{bmatrix}0.52379 \u0026amp; -4.04069 \u0026amp; 0 \u0026amp; 0 \u0026amp; 8.89548\\end{bmatrix} \\end{align*} $$\n å¾„å‘ç•¸å˜å‚æ•°çš„ç²¾ç¡®å€¼ä¸ºï¼š  $k_1 = 5.2379099530930096e-01$ $k_2 = -4.0406900157339871e+00$ $k_3 = 8.8954798029406810e+00$   åˆ‡å‘ç•¸å˜å‚æ•°ï¼š $p_1 = p _ 2 = 0$  ","permalink":"https://jifan.tech/posts/2019-04-18-opencv-3/","summary":"æœ¬æ–‡ä¸»è¦å‚è€ƒè‡ª OpenCV å®˜æ–¹æ•™ç¨‹ OpenCV: Camera calibration With OpenCVï¼Œå¤§éƒ¨åˆ†å†…å®¹æ˜¯å¯¹åŸæ–‡çš„ç›´æ¥ç¿»è¯‘ã€‚ 1. å‰è¨€ åˆ©ç”¨æ‰‹æœºç›¸æœºå¯¹æ£‹ç›˜å›¾æ‹æ‘„å¾—åˆ°çš„å›¾åƒå¦‚ä¸‹æ‰€ç¤ºï¼š å›¾ 1 æ‰‹æœºç›¸æœºæ‹","title":"OpenCV ç›¸æœºæ£€æ ¡ï¼šåŸç†åŠç®€å•å®ç°"},{"content":"ç‰¹å¾å€¼åˆ†è§£ 1. ç‰¹å¾å€¼ä¸ç‰¹å¾å‘é‡ åœ¨çº¿æ€§ä»£æ•°ä¸­ï¼Œå¯¹äº $n$ é˜¶æ–¹é˜µ $A$ï¼Œå¦‚æœå­˜åœ¨æŸä¸ªæ•° $\\lambda$ åŠæŸä¸ª $n$ ç»´éé›¶åˆ—å‘é‡ $v$ï¼Œä½¿å¾—\n$$ Av = \\lambda v $$\nåˆ™ç§° $\\lambda$ æ˜¯æ–¹é˜µ $A$ çš„ä¸€ä¸ªç‰¹å¾å€¼ï¼Œ$v$ æ˜¯æ–¹é˜µ $A$ çš„å±äºç‰¹å¾å€¼ $\\lambda$ çš„ä¸€ä¸ªç‰¹å¾å‘é‡ã€‚\nå¯¹ä¸Šå¼è¿›è¡Œå˜æ¢ï¼š\n$$ \\begin{align*} Av-\\lambda v \u0026amp;= \\overrightarrow{0} \\cr Av-\\lambda I v \u0026amp;= \\overrightarrow{0} \\cr (A - \\lambda I)v \u0026amp;= \\overrightarrow{0} \\cr (\\lambda I - A)v \u0026amp;= \\overrightarrow{0} \\end{align*} $$\nåˆ™ç§°\n $\\lambda E - A$ ä¸º $A$ çš„ç‰¹å¾çŸ©é˜µ è¡Œåˆ—å¼ $f(\\lambda) = |\\lambda E- A|$ ä¸º $A$ çš„ç‰¹å¾å¤šé¡¹å¼ $|\\lambda E - A| = 0$ æ˜¯ $A$ çš„ç‰¹å¾æ–¹ç¨‹ $(\\lambda E - A)v = \\overrightarrow{0}$ æ˜¯ $A$ å…³äºè¯¥ç‰¹å¾å€¼ $\\lambda$ çš„é½æ¬¡çº¿æ€§æ–¹ç¨‹ç»„  $A$ çš„ä¸»å¯¹è§’çº¿ä¸Šå…ƒç´ ä¹‹å’Œç§°ä¸ºçŸ©é˜µçš„è¿¹ï¼ˆtraceï¼‰ï¼Œè®°ä¸º $\\text{tr}(A)$ï¼Œå³\n$$ \\text{tr}(A) = a_{11} + a_{22} + \\cdots + a_{nn} $$\nè¿¹å’Œç‰¹å¾å€¼æœ‰ç€å¾ˆé‡è¦çš„è”ç³»ï¼š\n$$ \\text{tr}(A) = \\lambda_1 + \\lambda_2 + \\cdots + \\lambda_n $$\nè¡Œåˆ—å¼ä¹Ÿä¸ç‰¹å¾å€¼æœ‰å…³è”ï¼š\n$$ |A| = \\lambda_1\\lambda_2\\cdots\\lambda_n $$\n2. ç‰¹å¾å€¼åˆ†è§£ å¦‚æœæˆ‘ä»¬æ±‚å‡ºäº†æ–¹é˜µ $A$ çš„ $n$ ä¸ªç‰¹å¾å€¼ $\\lambda_1 \\leq \\lambda_2 \\leq \u0026hellip; \\leq \\lambda_n$ ä»¥åŠè¿™ $n$ ä¸ªç‰¹å¾å€¼æ‰€å¯¹åº”çš„ç‰¹å¾å‘é‡ ${v_1, v_2, \u0026hellip;, v_n}$ï¼Œä¸”è¿™ $n$ ä¸ªç‰¹å¾å‘é‡çº¿æ€§æ— å…³ã€‚é‚£ä¹ˆç‰¹å¾å€¼åˆ†è§£ï¼ŒEVDï¼ˆEigen Value Decompositionï¼‰å°±æ˜¯å°†æ–¹é˜µ $A$ ç”¨ä¸‹é¢çš„å½¢å¼è¡¨ç¤ºï¼š\n$$ A = Q \\Sigma Q^{-1} $$\nå…¶ä¸­ï¼Œ$Q$ æ˜¯è¿™ $n$ ä¸ªç‰¹å¾å‘é‡ç»„æˆçš„ $n \\times n$ ç»´çŸ©é˜µï¼Œ$\\Sigma$ æ˜¯ä»¥è¿™ $n$ ä¸ªç‰¹å¾å€¼ä¸ºä¸»å¯¹è§’çº¿çš„ $n \\times n$ ç»´çŸ©é˜µã€‚\nè‹¥å°†çŸ©é˜µ $Q$ ä¸­çš„ $n$ ä¸ªç‰¹å¾å‘é‡æ ‡å‡†åŒ–ï¼Œå³æ»¡è¶³ $\\lVert v_i \\rVert_2 = 1$ï¼Œæˆ–è€…è¯´ $v_i^Tv_i = 1$ï¼Œæ­¤æ—¶ $Q$ ä¸­çš„ $n$ ä¸ªç‰¹å¾å‘é‡ä¸ºæ ‡å‡†æ­£äº¤åŸºï¼Œæ»¡è¶³ $Q^TQ = I$ï¼Œå³ $Q^T = Q^{-1}$ï¼Œæ­¤æ—¶ $Q$ æ˜¯ä¸€ä¸ªé…‰çŸ©é˜µã€‚è¿™æ ·æˆ‘ä»¬å¯ä»¥æŠŠç‰¹å¾åˆ†è§£è¡¨è¾¾å¼å†™ä½œ\n$$ A = Q \\Sigma Q^T $$\n3. ç‰¹å¾å€¼ä¸ç‰¹å¾å‘é‡çš„å‡ ä½•æ„ä¹‰ ä»æŸç§æ„ä¹‰ä¸Šå°†ï¼Œä¸€ä¸ªçŸ©é˜µå°±æ˜¯ä¸€ä¸ªçº¿æ€§å˜æ¢ï¼Œå› ä¸ºä¸€ä¸ªçŸ©é˜µä¸ä¸€ä¸ªå‘é‡ç›¸ä¹˜çš„ç»“æœï¼Œç›¸å½“äºå¯¹è¿™ä¸ªå‘é‡è¿›è¡Œäº†çº¿æ€§å˜æ¢ã€‚æ¯”å¦‚ï¼Œå¯¹äºçŸ©é˜µ\n$$ M = \\begin{bmatrix}3 \u0026amp; 0 \\cr 0 \u0026amp; 1\\end{bmatrix} $$\nå®ƒå¯¹åº”çš„çº¿æ€§å˜æ¢å¦‚ä¸‹å›¾æ‰€ç¤ºï¼š\n å›¾ 1\n  è¿™æ˜¯å› ä¸ºï¼ŒçŸ©é˜µ $M$ ä¸ä¸€ä¸ªå‘é‡ $\\begin{bmatrix} x \u0026amp; y \\end{bmatrix}^T$ ç›¸ä¹˜çš„ç»“æœä¸º\n$$ \\begin{bmatrix}3 \u0026amp; 0 \\cr 0 \u0026amp; 1\\end{bmatrix} \\begin{bmatrix}x \\cr y\\end{bmatrix} = \\begin{bmatrix}3x \\cr y\\end{bmatrix} $$\nç”±äºçŸ©é˜µ $M$ æ˜¯å¯¹ç§°çš„ï¼Œæ‰€ä»¥è¿™ä¸ªå˜æ¢æ˜¯ä¸€ä¸ªå¯¹ $x$ã€$y$ è½´æ–¹å‘çš„æ‹‰ä¼¸å˜æ¢ï¼šæ¯ä¸€ä¸ªå¯¹è§’çº¿ä¸Šçš„å…ƒç´ å°†ä¼šå¯¹ä¸€ä¸ªç»´åº¦è¿›è¡Œæ‹‰ä¼¸å˜æ¢ï¼Œå½“å€¼ $\u0026gt; 1$ æ—¶ä¸ºæ‹‰é•¿ï¼Œå€¼ $\u0026lt; 1$ æ—¶ç¼©çŸ­ã€‚è€Œå½“çŸ©é˜µ $M$ ä¸å¯¹ç§°æ—¶\n$$ M = \\begin{bmatrix}1 \u0026amp; 1 \\cr 0 \u0026amp; 1\\end{bmatrix} $$\nå®ƒæ‰€æè¿°çš„å˜æ¢è§ä¸‹å›¾ï¼š\n å›¾ 2\n  å¦‚è“è‰²ç®­å¤´æ‰€ç¤ºï¼Œè¿™å…¶å®æ˜¯åœ¨å¹³é¢ä¸Šå¯¹ä¸€ä¸ªè½´è¿›è¡Œçš„æ‹‰ä¼¸å˜æ¢ã€‚å›¾ä¸­ï¼Œè“è‰²çš„å‰ªå¤´æ˜¯ä¸€ä¸ªæœ€ä¸»è¦çš„å˜åŒ–æ–¹å‘ï¼ˆæ³¨æ„ï¼Œå˜åŒ–æ–¹å‘å¹¶ä¸å”¯ä¸€ï¼‰ã€‚åœ¨æè¿°ä¸€ä¸ªå˜æ¢æ—¶ï¼Œæœ€é‡è¦çš„å°±æ˜¯æè¿°è¿™ä¸ªå˜æ¢ä¸»è¦çš„å˜åŒ–æ–¹å‘ã€‚\nå¥‡å¼‚å€¼åˆ†è§£ å¥‡å¼‚å€¼åˆ†è§£ï¼ŒSVD (Singular Value Decomposition) æ˜¯çº¿æ€§ä»£æ•°ä¸­ä¸€ç§é‡è¦çš„çŸ©é˜µåˆ†è§£ï¼Œåœ¨ä¿¡å·å¤„ç†ã€ç»Ÿè®¡å­¦ç­‰é¢†åŸŸæœ‰é‡è¦åº”ç”¨ã€‚\n1. å¥‡å¼‚å€¼åˆ†è§£ ç‰¹å¾å€¼åˆ†è§£èƒ½å¤Ÿå¾—åˆ°æ–¹é˜µçš„ç‰¹å¾ã€‚å¯¹äºæ™®é€šçš„çŸ©é˜µï¼Œå¯ä»¥é‡‡ç”¨å¥‡å¼‚å€¼åˆ†è§£çš„æ–¹æ³•æè¿°å…¶ç‰¹å¾ï¼š\n$$ A = U \\Sigma V^T $$\nå…¶ä¸­ï¼Œ\n $A$ æ˜¯ä¸€ä¸ª $M \\times N$ çš„çŸ©é˜µ $U$ æ˜¯ä¸€ä¸ª $M \\times M$ çš„æ–¹é˜µï¼ˆ$U$ ä¸­çš„å‘é‡ç§°ä¸ºå·¦å¥‡å¼‚å‘é‡ï¼Œéƒ½æ˜¯æ­£äº¤çš„ï¼‰ $\\Sigma$ æ˜¯ä¸€ä¸ª $M \\times N$ çš„çŸ©é˜µï¼ˆé™¤äº†å¯¹è§’çº¿ï¼Œå…¶ä»–å…ƒç´ éƒ½ä¸º 0ï¼Œå¯¹è§’çº¿ä¸Šçš„å…ƒç´ ç§°ä¸ºå¥‡å¼‚å€¼ï¼‰ $V$ æ˜¯ä¸€ä¸ª $N \\times N$ çš„æ–¹é˜µï¼ˆ$V$ ä¸­çš„å‘é‡ç§°ä¸ºå³å¥‡å¼‚å‘é‡ï¼Œéƒ½æ˜¯æ­£äº¤çš„ï¼‰  2. å¥‡å¼‚å€¼çš„è®¡ç®— å°† $A$ çš„è½¬ç½®ä¸ $A$ ç›¸ä¹˜ï¼Œé‚£ä¹ˆå¯¹äº $N \\times N$ çš„æ–¹é˜µ $A^TA$ï¼Œå…¶ç‰¹å¾å€¼åŠç‰¹å¾å‘é‡æ»¡è¶³\n$$ (A^TA)v_i = \\lambda_iv_i $$\nå…¶ä¸­çš„ $v_i$ å³å³å¥‡å¼‚å‘é‡ï¼Œ$n$ ä¸ªç‰¹å¾å‘é‡ $v$ ç»„æˆäº†çŸ©é˜µ $V$ã€‚\nåŒç†ï¼Œå¯¹äº $M \\times M$ çš„çŸ©é˜µ $AA^T$ï¼Œå…¶ç‰¹å¾å€¼å’Œç‰¹å¾å‘é‡æ»¡è¶³\n$$ (AA^T)u_i = \\lambda_i u_i $$\nå…¶ä¸­çš„ $u_i$ å³å·¦å¥‡å¼‚å‘é‡ï¼Œ$m$ ä¸ªç‰¹å¾å‘é‡ $u$ ç»„æˆäº†çŸ©é˜µ $U$ã€‚\næ¨å¯¼å¯å¾—ï¼š\n$$ \\begin{align*} A \u0026amp;= U \\Sigma V^T \\cr AV \u0026amp;= U \\Sigma V^T V \\cr AV \u0026amp;= U \\Sigma \\end{align*} $$\nå³\n$$ \\begin{align*} A v_i \u0026amp;= \\sigma_i u_i \\cr \\sigma_i \u0026amp;= Av_i / u_i \\end{align*} $$\nè¿™æ ·å¯ä»¥æ±‚å¾—æ‰€æœ‰çš„å¥‡å¼‚å€¼ $\\sigma$ï¼Œè¿›è€Œæ±‚å‡ºå¥‡å¼‚å€¼çŸ©é˜µ $\\Sigma$ ã€‚æ­¤å¤–è¿˜æœ‰\n$$ \\sigma_i = \\sqrt{\\lambda_i} $$\nå¥‡å¼‚å€¼ $\\sigma_i$ ä¹Ÿå¯ä»¥é€šè¿‡æ±‚å‡º $A^TA$ çš„ç‰¹å¾å€¼å–å¹³æ–¹æ ¹å¾—åˆ°ã€‚\n3. SVD çš„æ€§è´¨ å¥‡å¼‚å€¼ $\\sigma$ ä¸ç‰¹å¾å€¼ç±»ä¼¼ï¼Œåœ¨çŸ©é˜µ $\\Sigma$ ä¸­ä¹Ÿæ˜¯ä»å¤§åˆ°å°é™åºæ’åˆ—ï¼Œè€Œä¸” $\\sigma$ å‡å°‘å¾—ç‰¹åˆ«å¿«ï¼Œåœ¨å¾ˆå¤šæƒ…å†µä¸‹ï¼Œå‰ 10% ç”šè‡³ 1% çš„å¥‡å¼‚å€¼çš„å’Œå°±å å…¨éƒ¨å¥‡å¼‚å€¼ä¹‹å’Œçš„ 99% ä»¥ä¸Šäº†ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œæˆ‘ä»¬ä¹Ÿå¯ä»¥ç”¨å‰ $r$ ä¸ªå¥‡å¼‚å€¼æ¥è¿‘ä¼¼æè¿°çŸ©é˜µï¼Œå³éƒ¨åˆ†å¥‡å¼‚å€¼åˆ†è§£ï¼š\n$$ A_{m\\times n} \\approx U_{m\\times r}\\Sigma_{r \\times r} V^T_{r \\times n} $$\nç”±äº $r$ æ¯” $n$ å°å¾ˆå¤šï¼Œå­˜å‚¨çŸ©é˜µå’ŒçŸ©é˜µè®¡ç®—çš„èŠ±è´¹ä¹Ÿå¤§å¤§å‡å°‘ã€‚å½“ç„¶ï¼Œ$r$ è¶Šæ¥è¿‘äº $n$ï¼Œç›¸ä¹˜çš„ç»“æœä¹Ÿè¶Šæ¥è¿‘äº $A$ ã€‚\næ ¹æ®è¿™ä¸ªæ€§è´¨ï¼ŒSVD å¯ä»¥ç”¨äº PCAï¼ˆPrincipal Component Analysisï¼Œä¸»æˆåˆ†åˆ†æï¼‰é™ç»´ï¼Œæ¥åšæ•°æ®å‹ç¼©å’Œå»å™ªã€‚ä¹Ÿå¯ä»¥ç”¨äºæ¨èç®—æ³•ï¼Œå°†ç”¨æˆ·å’Œç”¨æˆ·å–œå¥½å¯¹åº”çš„çŸ©é˜µåšç‰¹å¾åˆ†è§£ï¼Œè¿›è€Œå¾—åˆ°éšå«çš„ç”¨æˆ·éœ€æ±‚æ¥åšæ¨èï¼Œäº‹å®ä¸Š Netflix ç­‰å…¬å¸çš„æ¨èç®—æ³•éƒ½é‡‡ç”¨äº† SVDã€‚åŒæ—¶å¥‡å¼‚å€¼åˆ†è§£ä¹Ÿå¯ä»¥ç”¨äº NLPï¼ˆNatural Language Processingï¼Œè‡ªç„¶è¯­è¨€å¤„ç†ï¼‰ï¼Œæ¯”å¦‚ LSIï¼ˆLatent Semantic Indexingï¼Œæ½œåœ¨è¯­ä¹‰ç´¢å¼•ï¼‰ç­‰ã€‚\nRQ åˆ†è§£ 1. QR åˆ†è§£ äº†è§£ RQ åˆ†è§£ä¹‹å‰ï¼Œå…ˆè¦æŒæ¡ QR åˆ†è§£ã€‚QR åˆ†è§£å°†çŸ©é˜µ $A$ åˆ†è§£ä¸ºä¸€ä¸ªæ­£äº¤çŸ©é˜µ $Q$ ä¸ä¸Šä¸‰è§’çŸ©é˜µ $R$ çš„ç§¯ï¼Œå³\n$$ A = QR $$\nä½¿ç”¨ Householder å˜æ¢å¯ä»¥å¯¹å…¶è¿›è¡Œæ±‚è§£ï¼Œæ­¤å¤„ä¸å†èµ˜è¿°ï¼Œå¯å‚è€ƒæ–‡æœ«é“¾æ¥ã€‚\n2. RQ åˆ†è§£ å¯¹çŸ©é˜µ $A$ è¿›è¡Œ RQ åˆ†è§£å³å°†å…¶åˆ†è§£ä¸ºä¸€ä¸ªä¸Šä¸‰è§’é˜µ $R$ ä¸ä¸€ä¸ªæ­£äº¤çŸ©é˜µï¼ˆOrthogonal Matrixï¼‰$Q$ çš„ä¹˜ç§¯ï¼Œè¦æ±‚çŸ©é˜µ $A$ æ»¡ç§©ã€‚\nå¯¹äº $n \\times n$ çš„çŸ©é˜µ $A$ï¼Œè‹¥ç»™å®šçŸ©é˜µ $P$ï¼Œæ»¡è¶³\n$$ P = \\begin{bmatrix} \u0026amp; \u0026amp; 1 \\cr \u0026amp; \\cdots \u0026amp; \\cr 1 \u0026amp; \u0026amp; \\end{bmatrix} $$\nåˆ™ $AP$ ä¼šå€’ç½® $A$ ä¸­åˆ—çš„é¡ºåºï¼Œ$PA$ ä¼šå€’ç½® $A$ ä¸­è¡Œçš„é¡ºåºã€‚ä¸” $P^T = P$ï¼Œ$PP = I$ï¼Œäºæ˜¯ $P^{-1} = P = P^T$ï¼Œ$P$ ä¸ºæ­£äº¤çŸ©é˜µã€‚è¿›è¡Œä»¥ä¸‹æ­¥éª¤çš„è®¡ç®—ï¼š\n è®¡ç®— $\\tilde{A} = PA$ï¼Œå³å€’ç½® $A$ ä¸­è¡Œçš„é¡ºåº è®¡ç®— QR åˆ†è§£ï¼š$\\tilde{A}^T = \\tilde{Q}\\tilde{R}$ ä»¤ $Q = P \\tilde{Q}^T$ï¼Œå³å€’ç½® $\\tilde{Q}^T$ ä¸­è¡Œçš„é¡ºåºï¼ˆ$Q$ æ˜¯æ­£äº¤çŸ©é˜µï¼‰ ä»¤ $R = P\\tilde{R}^TP$  åœ¨æœ€åä¸€æ­¥ä¸­ï¼Œä¸Šä¸‰è§’çŸ©é˜µ $\\tilde{R}$ é€šè¿‡ä¸¤æ¬¡çŸ©é˜µ $P$ ç›¸ä¹˜å˜æˆä¸€ä¸ªä¸‹ä¸‰è§’çŸ©é˜µ\n$$ \\begin{bmatrix} * \u0026amp; * \u0026amp; * \\cr \u0026amp; * \u0026amp; * \\cr \u0026amp; \u0026amp; * \\end{bmatrix} \\rightarrow \\begin{bmatrix} \u0026amp; \u0026amp; * \\cr \u0026amp; * \u0026amp; * \\cr * \u0026amp; * \u0026amp; * \\end{bmatrix} \\rightarrow \\begin{bmatrix} * \u0026amp; \u0026amp; \\cr * \u0026amp; * \u0026amp; \\cr * \u0026amp; * \u0026amp; * \\end{bmatrix} $$\nç”±ä¸Šé¢çš„ $R$ å’Œ $Q$ å¯ä»¥å¾—åˆ°\n$$ \\begin{align*} RQ \u0026amp;= (P\\tilde{R}^TR)(P\\tilde{Q}^T) = P\\tilde{R}^T\\tilde{Q}^T = P(\\tilde{Q}\\tilde{R})^T \\cr \u0026amp;= P(\\tilde{A}^T)^T=P\\tilde{A}=PPA=A \\end{align*} $$\n  å‚è€ƒï¼š\n$1$. å¥‡å¼‚å€¼åˆ†è§£ - ç»´åŸºç™¾ç§‘ï¼Œè‡ªç”±çš„ç™¾ç§‘å…¨ä¹¦\n$2$. æœºå™¨å­¦ä¹ ä¸­çš„æ•°å­¦(5)-å¼ºå¤§çš„çŸ©é˜µå¥‡å¼‚å€¼åˆ†è§£(SVD)åŠå…¶åº”ç”¨ - LeftNotEasy - åšå®¢å›­\n$3$. AMS :: Feature Column from the AMS\n$4$. å¥‡å¼‚å€¼åˆ†è§£(SVD)åŸç†ä¸åœ¨é™ç»´ä¸­çš„åº”ç”¨ - åˆ˜å»ºå¹³Pinard - åšå®¢å›­\n$5$. å¥‡å¼‚å€¼åˆ†è§£ï¼ˆSVDï¼‰åŸç† - JackGaoçš„åšå®¢ - CSDNåšå®¢\n$6$. QRåˆ†è§£ - ç»´åŸºç™¾ç§‘ï¼Œè‡ªç”±çš„ç™¾ç§‘å…¨ä¹¦\n$7$. G. H. Golub, C. Reinsch, Singular Value Decomposition and Least Squares Solutions.\n$8$. D. Kalman, A Singularly Valuable Decomposition: The SVD of a Matrix.\n ","permalink":"https://jifan.tech/posts/2019-04-12-linear-algebra-1/","summary":"ç‰¹å¾å€¼åˆ†è§£ 1. ç‰¹å¾å€¼ä¸ç‰¹å¾å‘é‡ åœ¨çº¿æ€§ä»£æ•°ä¸­ï¼Œå¯¹äº $n$ é˜¶æ–¹é˜µ $A$ï¼Œå¦‚æœå­˜åœ¨æŸä¸ªæ•° $\\lambda$ åŠæŸä¸ª $n$ ç»´éé›¶åˆ—å‘é‡ $v$ï¼Œä½¿å¾— $$ Av = \\lambda v $$ åˆ™ç§° $\\lambda$ æ˜¯æ–¹é˜µ $A$ çš„ä¸€","title":"çº¿æ€§ä»£æ•°ï¼šç‰¹å¾å€¼åˆ†è§£ã€å¥‡å¼‚å€¼åˆ†è§£ä¸ RQ åˆ†è§£"},{"content":"åœ¨è®¡ç®—æœºè§†è§‰ï¼ˆComputer Visionï¼‰ä¸æ‘„å½±æµ‹é‡ï¼ˆPhotogrammetryï¼‰ä¸­ï¼Œæˆ‘ä»¬åœ¨ä¸åŒå½±åƒä¹‹é—´æ‰¾åˆ°ç›¸åŒ¹é…çš„ç‰¹å¾ï¼Œå·²å»ºç«‹ä¸¤å¹…å½±åƒä¹‹é—´çš„è”ç³»ï¼Œæå–å‡ºæˆ‘ä»¬æ‰€éœ€è¦çš„ä¿¡æ¯ã€‚è¿™äº›ç‰¹å¾ä¸»è¦åˆ†ä¸ºï¼š\n è¾¹ç¼˜ï¼ˆEdgesï¼‰ è§’ç‚¹ï¼ˆCornersï¼‰ å…´è¶£åŒºåŸŸ ROIï¼ˆRegions of Interestï¼‰  å…¶ä¸­ï¼Œæå–ç‚¹ç‰¹å¾çš„ç®—å­ç§°ä¸ºå…´è¶£ç®—å­æˆ–æœ‰åˆ©ç®—å­ï¼ˆInterest Operatorï¼‰ï¼Œå³è¿ç”¨æŸç§ç®—æ³•ä»å½±åƒç§æå–æˆ‘ä»¬æ„Ÿå…´è¶£çš„ã€æœ‰åˆ©äºæŸç§ç›®çš„çš„ç‚¹ã€‚\näººçœ¼å¯¹è§’ç‚¹çš„è¯†åˆ«é€šå¸¸æ˜¯åœ¨ä¸€ä¸ªå±€éƒ¨çš„å°åŒºåŸŸæˆ–å°çª—å£å†…å®Œæˆçš„ã€‚å¦‚æœåœ¨å„ä¸ªæ–¹å‘ä¸Šç§»åŠ¨è¿™ä¸ªç‰¹å¾çš„å°çª—å£ï¼Œçª—å£å†…åŒºåŸŸçš„ç°åº¦å‘ç”Ÿäº†è¾ƒå¤§çš„å˜åŒ–ï¼Œé‚£ä¹ˆå°±è®¤ä¸ºåœ¨çª—å£å†…é‡åˆ°äº†è§’ç‚¹ã€‚å¦‚æœè¿™ä¸ªç‰¹å®šçš„çª—å£åœ¨å›¾åƒå„ä¸ªæ–¹é¢ç§»åŠ¨æ—¶ï¼Œçª—å£å†…å›¾åƒçš„ç°åº¦æ²¡æœ‰å‘ç”Ÿå˜åŒ–ï¼Œé‚£ä¹ˆçª—å£å†…å°±ä¸å­˜åœ¨è§’ç‚¹ï¼›å¦‚æœçª—å£åœ¨æŸä¸€ä¸ªæ–¹å‘ç§»åŠ¨æ—¶ï¼Œçª—å£å†…å›¾åƒçš„ç°åº¦å‘ç”Ÿäº†è¾ƒå¤§çš„å˜åŒ–ï¼Œè€Œåœ¨å¦ä¸€äº›æ–¹å‘ä¸Šæ²¡æœ‰å‘ç”Ÿå˜åŒ–ï¼Œé‚£ä¹ˆçª—å£å†…çš„å›¾åƒå¯èƒ½åªæ˜¯ä¸€æ¡ç›´çº¿çš„çº¿æ®µã€‚\n å›¾ 1 è§’ç‚¹\n  è§’ç‚¹çš„ç‰¹æ®Šä¹‹å¤„åœ¨äºï¼Œå®ƒæ˜¯ä¸¤æ¡è¾¹çš„äº¤ç‚¹ï¼Œæ‰€ä»¥å®ƒä»£è¡¨è¿™ä¸¤æ¡è¾¹çš„æ–¹å‘å‘ç”Ÿå˜åŒ–çš„ç‚¹ã€‚å› æ­¤ï¼Œå›¾åƒåœ¨è¯¥ç‚¹çš„æ¢¯åº¦ï¼ˆåœ¨å„ä¸ªæ–¹å‘ä¸Šï¼‰å…·æœ‰æ˜æ˜¾çš„å˜åŒ–ã€‚åˆ©ç”¨è¿™ä¸€ç‚¹ï¼Œå‰äººæå‡ºäº†ä¸€ç³»åˆ—ç®—æ³•ï¼Œå…¶ä¸­æ¯”è¾ƒç»å…¸çš„æœ‰ Moravec ç®—å­ã€Forstner ç®—å­ä»¥åŠ Harris ç®—å­ç­‰ã€‚\nMoravec ç®—å­ åŸºæœ¬åŸç† Moravec äº 1977 å¹´æå‡ºåˆ©ç”¨ç°åº¦æ–¹å·®æå–ç‚¹ç‰¹å¾çš„ç®—å­ï¼Œå…¶æ­¥éª¤ä¸ºï¼š\n1. è®¡ç®—å„åƒå…ƒçš„å…´è¶£å€¼ $IV$ï¼ˆInterest Valueï¼‰ã€‚ åœ¨ä»¥åƒç´  $(c, r)$ ä¸ºä¸­å¿ƒçš„ $w \\times w$ çš„çª—å£ä¸­ï¼ˆå¦‚ $5 \\times 5$ çš„çª—å£ï¼‰ï¼Œè®¡ç®—å››ä¸ªæ–¹å‘ç›¸é‚»åƒç´ ç°åº¦å·®çš„å¹³æ–¹å’Œï¼š\n$$ \\begin{cases} V_1 = \\sum_{i = -k}^{k-1}(g_{c+i,r}-g_{c+i+1, r})^2 \\cr V_2 = \\sum_{i = -k}^{k-1}(g_{c+i,r+i}-g_{c+i+1, r+i+1})^2 \\cr V_3 = \\sum_{i = -k}^{k-1}(g_{c,r+i}-g_{c+i+1, r+i+1})^2 \\cr V_4 = \\sum_{i = -k}^{k-1}(g_{c+i,r-i}-g_{c+i+1, r-i-1})^2 \\end{cases} $$\nå…¶ä¸­ $k = \\text{int}(w/2)$ã€‚å–å…¶ä¸­æœ€å°è€…ä½œä¸ºè¯¥åƒç´  $(c,r)$ çš„å…´è¶£å€¼ï¼š\n$$ IV_{c,r} = \\min (V_1,\\ V_2,\\ V_3,\\ V_4) $$\n2. ç»™å®šä¸€ç»éªŒé˜ˆå€¼ï¼Œå°†å…´è¶£å€¼å¤§äºè¯¥é˜ˆå€¼çš„ç‚¹ï¼ˆå³å…´è¶£å€¼è®¡ç®—çª—å£çš„ä¸­å¿ƒç‚¹ï¼‰ä½œä¸ºå€™é€‰ç‚¹ã€‚ é˜ˆå€¼çš„é€‰æ‹©åº”ä»¥å€™é€‰ç‚¹ä¸­åŒ…æ‹¬æ‰€éœ€è¦çš„ç‰¹å¾ç‚¹è€Œåˆä¸å«è¿‡å¤šçš„éç‰¹å¾ç‚¹ä¸ºåŸåˆ™ã€‚\n3. é€‰å–å€™é€‰ç‚¹ä¸­çš„æå€¼ç‚¹ä½œä¸ºç‰¹å¾ç‚¹ã€‚ åœ¨ä¸€å®šå¤§å°çš„çª—å£å†…ï¼ˆå¯ä¸åŒäºå…´è¶£å€¼è®¡ç®—çª—å£ï¼Œä¾‹å¦‚ $5 \\times 5$ åƒå…ƒï¼Œ$7 \\times 7$ åƒå…ƒæˆ– $9 \\times 9$ åƒå…ƒï¼‰ï¼Œå°†å€™é€‰ç‚¹ä¸­å…´è¶£å€¼ä¸æ˜¯æœ€å¤§è€…å‡å»æ‰ï¼Œä»…ç•™ä¸‹ä¸€ä¸ªå…´è¶£å€¼æœ€å¤§è€…ï¼Œè¯¥åƒç´ å³ä¸ºä¸€ä¸ªç‰¹å¾ç‚¹ï¼ˆæœ‰çš„æ–‡çŒ®ä¸­ç§°æ­¤æ­¥éª¤ä¸ºæŠ‘åˆ¶å±€éƒ¨éæœ€å¤§ï¼‰ã€‚\nä»£ç å®ç° /// Moravec ç‚¹ç‰¹å¾æå–ç®—æ³• void Moravec(InputArray image, vector\u0026lt;KeyPoint\u0026gt;\u0026amp; keyPoints, int kSize, int threshold) { Mat img; cvtColor(image, img, COLOR_BGR2GRAY); unsigned char* pImg = img.data; int height = img.rows; int width = img.cols; int size = height * width; double* candidatePoints = new double[size]; for (int i = 0; i \u0026lt; size; i++) candidatePoints[i] = 0; int k = kSize / 2; /// I. è®¡ç®—å„åƒå…ƒçš„å…´è¶£å€¼  for (int i = k; i \u0026lt; height - k; i++) { for (int j = k; j \u0026lt; width - k; j++) { int V1, V2, V3, V4; V1 = V2 = V3 = V4 = 0; // åœ¨ä»¥åƒç´  (i, j) ä¸ºä¸­å¿ƒçš„ k * k çš„å½±åƒçª—å£ä¸­  // è®¡ç®—æ°´å¹³ã€45Â°ã€ç«–ç›´ã€135Â°å››ä¸ªæ–¹å‘ä¸Šç›¸é‚»åƒç´ ç°åº¦å·®çš„å¹³æ–¹å’Œ  for (int r = -k; r \u0026lt; k; r++) { V1 += (pImg[(i + r) * width + j] - pImg[(i + r + 1) * width + j]) * (pImg[(i + r) * width + j] - pImg[(i + r + 1) * width + j]); V2 += (pImg[(i + r) * width + j + r] - pImg[(i + r + 1) * width + j + r + 1]) * (pImg[(i + r) * width + j + r] - pImg[(i + r + 1) * width + j + r + 1]); V3 += (pImg[i * width + j + r] - pImg[i * width + j + r + 1]) * (pImg[i * width + j + r] - pImg[i * width + j + r + 1]); V4 += (pImg[(i + r) * width + j - r] - pImg[(i + r + 1) * width + j - r - 1]) * (pImg[(i + r) * width + j - r] - pImg[(i + r + 1) * width + j - r - 1]); } // å–å…¶ä¸­çš„æœ€å°å€¼ä½œä¸ºè¯¥åƒç´  (i, j) çš„å…´è¶£å€¼  int value = min(min(V1, V2), min(V3, V4)); // II. å°†å…´è¶£å€¼å¤§äºé˜ˆå€¼çš„ç‚¹ä½œä¸ºå€™é€‰ç‚¹  if (value \u0026gt; threshold) candidatePoints[i * width + j] = value; } } /// III. é€‰å–å€™é€‰ç‚¹ä¸­çš„æå€¼ç‚¹ä½œä¸ºç‰¹å¾ç‚¹ï¼ˆéæå¤§å€¼æŠ‘åˆ¶ï¼‰  int max_i, max_j, flag; double max_val; for (int i = k; i \u0026lt; height - k; i += kSize) { for (int j = k; j \u0026lt; width - k; j += kSize) { max_i = 0; max_j = 0; max_val = 0; flag = 0; for (int m = -k; m \u0026lt; k; m++) { for (int n = -k; n \u0026lt; k; n++) { double val = candidatePoints[(i + m) * width + j + n]; if (val \u0026gt; max_val) { max_i = i + m; max_j = j + n; max_val = val; flag = 1; } } } if (flag) keyPoints.push_back(KeyPoint((float)max_j, (float)max_i, 2)); } } } æå–ç»“æœ  å›¾ 2 Moravec ç®—å­ è¾“å‡ºç»“æœ\n  Forstner ç®—å­ åŸºæœ¬åŸç† è¯¥ç®—å­é€šè¿‡è®¡ç®—å„åƒç´ çš„ Robert æ¢¯åº¦å’Œåƒç´  $(c, r)$ ä¸ºä¸­å¿ƒçš„ä¸€ä¸ªçª—å£ï¼ˆå¦‚ $5 \\times 5)$ çš„ç°åº¦åæ–¹å·®çŸ©é˜µï¼Œåœ¨å½±åƒä¸­å¯»æ‰¾å…·æœ‰å°½å¯èƒ½å°è€Œæ¥è¿‘åœ†çš„è¯¯å·®æ¤­åœ†çš„ç‚¹ä½œä¸ºç‰¹å¾ç‚¹ï¼Œå…¶æ­¥éª¤ä¸ºï¼š\n1. è®¡ç®—å„åƒç´ çš„ Robert æ¢¯åº¦ã€‚\n$$ \\left.\\begin{matrix} g_u = \\frac{\\partial g}{\\partial u} = g_{i + 1, j + 1} - g_{i, j} \\cr\\cr g_v = \\frac{\\partial g}{\\partial v} = g_{i, j + 1} - g_{i + 1, j} \\end{matrix}\\right\\rbrace $$\n2. è®¡ç®— $l \\times l$ï¼ˆå¦‚ $5 \\times 5$ æˆ–æ›´å¤§ï¼‰çª—å£ä¸­ç°åº¦çš„åæ–¹å·®çŸ©é˜µã€‚\n$$ Q = N^{-1} = \\begin{bmatrix} \\sum g^2_u \u0026amp; \\sum g_ug_v \\cr \\sum g_vg_u \u0026amp; \\sum g^2_v \\end{bmatrix}^{-1} $$\nå…¶ä¸­ï¼š\n$$ \\begin{align*} \u0026amp;\\sum g_u^2 = \\sum_{i = c - k}^{c+k-1} \\sum_{j=r-k}^{r+k+1}(g_{i+1, j+1} - g_{i,j})^2 \\cr \u0026amp;\\sum g_v^2 = \\sum_{i = c - k}^{c+k-1} \\sum_{j=r-k}^{r+k+1}(g_{i, j+1} - g_{i+1,j})^2 \\cr \u0026amp;\\sum g_ug_v = \\sum_{i = c - k}^{c+k-1} \\sum_{j=r-k}^{r+k+1}(g_{i+1, j+1} - g_{i,j})(g_{i, j+1} - g_{i+1,j}) \\end{align*} $$\n3. è®¡ç®—å…´è¶£å€¼ $q$ å’Œ $w$\n$$ \\begin{align*} w \u0026amp;= \\frac{1}{\\text{tr}(Q)} = \\frac{\\det(N)}{\\text{tr}(N)} \\cr q \u0026amp;= \\frac{4\\det(N)}{\\text{tr}(N)^2} \\end{align*} $$\nå…¶ä¸­ï¼Œ$\\det(N)$ ä»£è¡¨çŸ©é˜µ $N$ çš„è¡Œåˆ—å¼ï¼›$\\text{tr}(N)$ ä»£è¡¨çŸ©é˜µ $N$ çš„è¿¹ã€‚\nå¯ä»¥è¯æ˜ï¼Œ$q$ å³åƒç´  $(c, r)$ å¯¹åº”è¯¯å·®æ¤­åœ†çš„åœ†åº¦ï¼š\n$$ q = 1 - \\frac{(a^2-b^2)^2}{(a^2+b^2)^2} $$\n4. ç¡®å®šå¾…é€‰ç‚¹ã€‚ å¦‚æœå…´è¶£å€¼å¤§äºç»™å®šçš„é˜ˆå€¼ï¼Œåˆ™è¯¥åƒå…ƒä¸ºå¾…é€‰ç‚¹ã€‚é˜ˆå€¼ä¸ºç»éªŒå€¼ï¼Œå¯å‚è€ƒä¸‹åˆ—å€¼ï¼š\n$$ \\begin{align*} T_q \u0026amp;= 0.5 \\sim 0.75 \\cr T_w \u0026amp;= \\begin{cases} f\\overline{w}\u0026amp;(f=0.5 \\sim 1.5) \\cr cw_c\u0026amp;(c = 5) \\end{cases} \\end{align*} $$\nå…¶ä¸­ $\\overline{w}$ ä¸ºæƒå¹³å‡å€¼ï¼›$w_c$ ä¸ºæƒçš„ä¸­å€¼ã€‚å½“ $q \u0026gt; T_q$ï¼Œä¸” $w \u0026gt; T_w$ æ—¶ï¼Œè¯¥åƒå…ƒä¸ºå¾…é€‰ç‚¹ã€‚\n5. é€‰å–æå€¼ç‚¹ã€‚ ä»¥æƒå€¼ $w$ ä¸ºä¾æ®é€‰æ‹©æå€¼ç‚¹ï¼Œå³åœ¨ä¸€ä¸ªé€‚å½“çª—å£ä¸­é€‰æ‹©æœ€å¤§çš„å¾…é€‰ç‚¹ï¼Œè€Œå»æ‰å…¶ä½™çš„ç‚¹ã€‚\nä»£ç å®ç° void Forstner(InputArray image, vector\u0026lt;KeyPoint\u0026gt; \u0026amp; keyPoints, int kSize) { Mat img; cvtColor(image, img, COLOR_BGR2GRAY); unsigned char* pImg = img.data; int height = img.rows; int width = img.cols; int size = height * width; int k = kSize / 2; double grad_u = 0, grad_v = 0;\t// Robert æ¢¯åº¦  double DetN = 0.0, trN = 0.0;\t// DetN: çŸ©é˜µ N çš„è¡Œåˆ—å¼ï¼ŒtrN: çŸ©é˜µ N çš„è¿¹  double weight_total = 0, weight_mean = 0;\t// æƒçš„æ€»å€¼ä¸å‡å€¼  double q = 0, w = 0;\t// å…´è¶£å€¼ qã€w  double* wPoints = new double[size];\t// å£°æ˜å­˜å‚¨å…´è¶£å€¼çš„æ•°ç»„  double* qPoints = new double[size]; for (int i = 0; i \u0026lt; size; i++) {\t// ç»™æ•°ç»„èµ‹åˆå€¼  wPoints[i] = 0; qPoints[i] = 0; } for (int i = k; i \u0026lt; height - k; i++) { for (int j = k; j \u0026lt; width - k; j++) { double N[4] = { 0 }; for (int m = -k; m \u0026lt; k; m++) { for (int n = -k; n \u0026lt; k; n++) { grad_u = pImg[(i + m + 1) * width + j + n + 1] - pImg[(i + m) * width + j + n]; grad_v = pImg[(i + m + 1) * width + j + n] - pImg[(i + m) * width + j + n + 1]; N[0] += grad_u * grad_u; N[1] += grad_u * grad_v; N[2] = N[1]; N[3] += grad_v * grad_v; } } DetN = N[0] * N[3] - N[1] * N[2];\t// DetN = determinant(N);  trN = N[0] + N[3];\t// trN = trace(N);  if (trN != 0) { w = DetN / trN;\t// æƒ  q = 4 * DetN / (trN * trN);\t// åœ†åº¦  weight_total += w; wPoints[i * width + j] = w; qPoints[i * width + j] = q; } } } weight_mean = weight_total / size;\t// æƒå¹³å‡å€¼  double Tq = 0.75;\t// å‚è€ƒé˜ˆå€¼  double Tw = 0.5 * weight_mean; for (int i = k; i \u0026lt; height - k; i += kSize) { for (int j = k; j \u0026lt; width - k; j += kSize) { int max_i = 0, max_j = 0, flag = 0; double max_weight = 0; for (int m = -k; m \u0026lt; k; m++) { for (int n = -k; n \u0026lt; k; n++) { double val_q = qPoints[(i + m) * width + j + n]; double val_w = wPoints[(i + m) * width + j + n]; // å¤§äºé˜ˆå€¼æ—¶ï¼Œè¯¥ç‚¹ä¸ºå¾…é€‰ç‚¹  if ((val_q \u0026gt; Tq) \u0026amp;\u0026amp; (val_w \u0026gt; Tw)) { // ä»å€™é€‰ç‚¹ä¸­é€‰å‡ºæå€¼ç‚¹  if (val_w \u0026gt; max_weight) { max_i = i + m; max_j = j + n; max_weight = val_w; flag = 1; } } } } if (flag)\t// è‹¥æœ‰æå€¼ç‚¹ï¼Œåˆ™å­˜å‚¨åœ¨ keyPoints ä¸­  keyPoints.push_back(KeyPoint((float)max_j, (float)max_i, 2)); } } } æå–ç»“æœ å¯†å¯†éº»éº»ï¼ˆè¾£çœ¼ç›ï¼‰ï¼Œæ„Ÿè§‰æ•ˆæœä¸€èˆ¬\n å›¾ 3 Forstner ç®—å­è¾“å‡ºç»“æœ\n  Harris ç®—å­ åŸºæœ¬åŸç† Harris è§’ç‚¹æå–ç®—æ³•æ˜¯ Chris Harris å’Œ Mike Stephens åœ¨ H.Moravec ç®—æ³•çš„åŸºç¡€ä¸Šå‘å±•å‡ºçš„é€šè¿‡è‡ªç›¸å…³çŸ©é˜µçš„è§’ç‚¹æå–ç®—æ³•ï¼Œåˆç§° Plessey ç®—æ³•ã€‚è¿™ç§ç®—å­å—ä¿¡å·å¤„ç†ä¸­è‡ªç›¸å…³å‡½æ•°çš„å¯å‘ï¼Œç»™å‡ºä¸è‡ªç›¸å…³å‡½æ•°ç›¸è”ç³»çš„çŸ©é˜µ $M$ã€‚$M$ é˜µçš„ç‰¹å¾å€¼æ˜¯è‡ªç›¸å…³å‡½æ•°çš„ä¸€é˜¶æ›²ç‡ï¼Œå¦‚æœä¸¤ä¸ªæ›²ç‡å€¼éƒ½é«˜ï¼Œé‚£ä¹ˆå°±è®¤ä¸ºè¯¥ç‚¹æ˜¯ç‰¹å¾è§’ç‚¹ã€‚\nå¯¹äºå›¾åƒ $I(x, y)$ï¼Œå…¶åœ¨æ‰€æœ‰æ–¹å‘ä¸Šä½ç§» $(u, v)$ åçš„è‡ªç›¸ä¼¼æ€§å¯è¡¨ç¤ºä¸ºï¼š\n$$ E(u,v) = \\sum_{x,y} \\underbrace{w(x,y)}_{\\text{window function}}\\left[{\\underbrace{I(x+u,y+v)}_{\\text{shifted intensity}}}-\\underbrace{I(x,y)}_\\text{intensity}\\right]^2 $$\nå…¶ä¸­çª—å£å‡½æ•° $w(x, y)$ æ—¢å¯ä»¥æ˜¯å¸¸æ•°ï¼Œä¹Ÿå¯ä»¥æ˜¯é«˜æ–¯å‡½æ•°ã€‚\næ ¹æ®æ³°å‹’å±•å¼€ï¼Œå¯¹å›¾åƒ $I(x, y)$ åœ¨å¹³ç§» $(u, v)$ åè¿›è¡Œä¸€é˜¶è¿‘ä¼¼ï¼š\n$$ \\begin{align*} I(x+u,y+v) \u0026amp;= I(x, y) + I_x(x, y)u + I_y(x, y)v + O(u^2, v^2) \\cr \u0026amp;\\approx I(x, y) + I_x(x, y)u + I_y(x, y)v \\end{align*} $$\nå…¶ä¸­ï¼Œ$I_x$ï¼Œ$I_y$ æ˜¯å›¾åƒ $I(x, y)$ çš„åå¯¼æ•°ã€‚å› æ­¤å¯ä»¥æ¨å¾—ï¼š\n$$ E(u, v) \\approx \\sum_w[I_x(x, y)u + I_y(x, y)v]^2 = \\begin{bmatrix}u \u0026amp; v\\end{bmatrix} M \\begin{bmatrix} u \\cr v \\end{bmatrix} $$\nå…¶ä¸­\n$$ M = \\sum_{x, y} w(x, y) \\begin{bmatrix} I_xI_x \u0026amp; I_xI_y \\cr I_xI_y \u0026amp; I_yI_y\\end{bmatrix} = \\begin{bmatrix}\\sum_{w} I_x^2 \u0026amp; \\sum_{w} I_x I_y \\cr \\sum_{w} I_x I_y \u0026amp; \\sum_{w} I_y^2 \\end{bmatrix} = \\begin{bmatrix}A \u0026amp; C \\cr C \u0026amp; B\\end{bmatrix} $$\nå³å›¾åƒ $I(x, y)$ åœ¨ç‚¹ $(x, y)$ å¤„å¹³ç§» $(u, v)$ åçš„è‡ªç›¸å…³å‡½æ•°å¯ä»¥è¿‘ä¼¼ä¸ºäºŒæ¬¡é¡¹å‡½æ•°ï¼š\n$$ E(x, y; u, v) \\approx Au^2 + 2Cuv + Bv^2 $$\nå…¶ä¸­\n$$ A = \\sum_{w} I_x^2, \\quad B = \\sum_{w} I_y^2, \\quad C = \\sum_{w} I_xI_y $$\näºŒæ¬¡é¡¹å‡½æ•°æœ¬è´¨ä¸Šå°±æ˜¯ä¸€ä¸ªæ¤­åœ†å‡½æ•°ã€‚æ¤­åœ†çš„æ‰ç‡ä¸å°ºå¯¸æ˜¯ç”± $M(x, y)$ çš„ç‰¹å¾å€¼ $\\lambda_1$ï¼Œ$\\lambda_2$ å†³å®šçš„ï¼Œæ¤­åœ†çš„æ–¹å‘æ˜¯ç”± $M(x, y)$ çš„ç‰¹å¾çŸ¢é‡å†³å®šçš„ï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºï¼Œæ¤­åœ†æ–¹ç¨‹ä¸ºï¼š\n$$ \\begin{bmatrix}u \u0026amp; v\\end{bmatrix} M(x, y) \\begin{bmatrix}u \\cr v\\end{bmatrix} = 1 $$\n å›¾ 4 æ¤­åœ†å‡½æ•°\n  æ¤­åœ†å‡½æ•°ç‰¹å¾å€¼ä¸å›¾åƒä¸­çš„è§’ç‚¹ã€ç›´çº¿ï¼ˆè¾¹ç¼˜ï¼‰å’Œå¹³é¢ä¹‹é—´çš„å…³ç³»å¦‚ä¸‹å›¾æ‰€ç¤ºã€‚å…±å¯åˆ†ä¸ºä¸‰ç§æƒ…å†µï¼š\n å›¾åƒä¸­çš„ç›´çº¿ã€‚ä¸€ä¸ªç‰¹å¾å€¼å¤§ï¼Œå¦ä¸€ä¸ªç‰¹å¾å€¼å°ï¼Œ$\\lambda_1 \\gg \\lambda_1$ æˆ– $\\lambda_2 \\gg \\lambda_1$ã€‚è‡ªç›¸å…³å‡½æ•°åœ¨æŸä¸€æ–¹å‘ä¸Šå¤§ï¼Œåœ¨å…¶ä»–æ–¹å‘ä¸Šå°ã€‚ å›¾åƒä¸­çš„å¹³é¢ã€‚ä¸¤ä¸ªç‰¹å¾å€¼éƒ½å°ï¼Œä¸”è¿‘ä¼¼ç›¸ç­‰ã€‚è‡ªç›¸å…³å‡½æ•°æ•°å€¼åœ¨å„ä¸ªæ–¹å‘ä¸Šéƒ½å°ã€‚ å›¾åƒä¸­çš„è§’ç‚¹ã€‚ä¸¤ä¸ªç‰¹å¾å€¼éƒ½å¤§ï¼Œä¸”è¿‘ä¼¼ç›¸ç­‰ã€‚è‡ªç›¸å…³å‡½æ•°æ•°å€¼åœ¨æ‰€æœ‰æ–¹å‘ä¸Šéƒ½å¤§ã€‚   å›¾ 5 æ¤­åœ†å‡½æ•°ç‰¹å¾å€¼ä¸å›¾åƒä¸­çš„è§’ç‚¹ã€ç›´çº¿ï¼ˆè¾¹ç¼˜ï¼‰å’Œå¹³é¢ä¹‹é—´çš„å…³ç³»\n  Harris ç®—æ³•é€šè¿‡è®¡ç®—è§’ç‚¹å“åº”å€¼ $R$ æ¥åˆ¤æ–­è§’ç‚¹ï¼Œå…¶è®¡ç®—å…¬å¼ä¸ºï¼š\n$$ R = \\det(M)-k(\\text{tr}(M))^2 $$\nå¼ä¸­ï¼Œ$\\det(M)$ ä¸ºçŸ©é˜µ $M = \\begin{bmatrix}A\u0026amp;C \\cr C\u0026amp;B\\end{bmatrix}$ çš„è¡Œåˆ—å¼ï¼›$\\text{tr}(M)$ ä¸ºçŸ©é˜µ $M$ çš„ç›´è¿¹ï¼›$k$ ä¸ºé»˜è®¤å¸¸æ•°ï¼Œå–å€¼èŒƒå›´ä¸º $0.04 \\sim 0.06$ã€‚äº‹å®ä¸Šï¼Œç‰¹å¾æ˜¯éšå«åœ¨ $\\det(M)$ å’Œ $\\text{tr}(M)$ ä¸­çš„ï¼Œå› ä¸ºï¼š\n$$ \\begin{align*} \\det(M) = \\lambda_1\\lambda_2 = AB - C^2 \\cr \\text{tr}(M) = \\lambda_1 + \\lambda_2 = A + B \\end{align*} $$\næ ¹ç»ä¸Šè¿°è®¨è®ºï¼ŒHarris è§’ç‚¹æ£€æµ‹ç®—æ³•çš„æ­¥éª¤å¯ä»¥æ€»ç»“ä¸ºï¼š\n1. è®¡ç®—å›¾åƒ $I(x, y)$ åœ¨ $x$ å’Œ $y$ æ–¹å‘ä¸Šçš„æ¢¯åº¦ $I_x$ã€$I_y$ï¼š\n$$ \\begin{align*} I_x = \\frac{\\partial I}{\\partial x} = I \\bigotimes (-1 \\ 0 \\ 1), \\cr I_y = \\frac{\\partial I}{\\partial y} = I \\bigotimes (-1 \\ 0 \\ 1)^T \\end{align*} $$\n2. è®¡ç®—å›¾åƒä¸¤ä¸ªæ–¹å‘æ¢¯åº¦çš„ä¹˜ç§¯ã€‚\n$$ I_x^2=I_x \\cdot I_x, \\quad I_y^2 = I_y \\cdot I_y, \\quad I_xI_y = I_x \\cdot I_y $$\n3. ä½¿ç”¨é«˜æ–¯å‡½æ•°å¯¹ $I_x^2$ã€$I_y^2$ å’Œ $I_xI_y$ è¿›è¡Œé«˜æ–¯æ»¤æ³¢ï¼Œç”ŸæˆçŸ©é˜µ $M$ çš„å…ƒç´  $A$ã€$B$ å’Œ $C$ã€‚ è¿™é‡Œï¼Œé«˜æ–¯å·ç§¯æ¨¡æ¿çš„ $\\sigma$ å– $0.3 \\sim 0.9$ã€‚\n$$ A = G(\\tilde{s}) \\bigotimes I_x^2, \\quad B = G(\\tilde{s}) \\bigotimes I_y^2, \\quad C = G(\\tilde{s}) \\bigotimes I_xI_y $$\n4. è®¡ç®—æ¯ä¸ªåƒç´ çš„ Harris å“åº”å€¼ $R$ã€‚\n$$ R = \\det(M)-k(\\text{tr}(M))^2 $$\n5. åœ¨ $3 \\times 3$ æˆ– $5 \\times 5$ çš„é¢†åŸŸå†…è¿›è¡Œéæå¤§å€¼æŠ‘åˆ¶ï¼Œå±€éƒ¨æå€¼ç‚¹å³ä¸ºå›¾åƒä¸­çš„è§’ç‚¹ã€‚\nä»£ç å®ç° void Harris(InputArray image, vector\u0026lt;KeyPoint\u0026gt; \u0026amp; keyPoints) { Mat img = image.getMat(); if (img.channels() == 3) cvtColor(img, img, COLOR_BGR2GRAY); img.convertTo(img, CV_64F); Mat xKernel = (Mat_\u0026lt;double\u0026gt;(1, 3) \u0026lt;\u0026lt; -1, 0, 1); Mat yKernel = xKernel.t(); Mat gX, gY; // filter2D: Convolves an image with the kernel.  filter2D(img, gX, CV_64F, xKernel);\t// x æ–¹å‘æ¢¯åº¦  filter2D(img, gY, CV_64F, yKernel);\t// y æ–¹å‘æ¢¯åº¦  Mat gX2, gY2, gXY; gX2 = gX.mul(gX);\t// gX2 = gX * gX  gY2 = gY.mul(gY);\t// gY2 = gY * gY  gXY = gX.mul(gY);\t// gXY = gX * gY  // getGaussianKernel: Returns Gaussian filter coefficients.  // Aperture size: 7; Ïƒ: 0.9  Mat gaussKernel = getGaussianKernel(5, 0.9); // å¯¹æ¢¯åº¦å€¼è¿›è¡Œé«˜æ–¯æ»¤æ³¢  filter2D(gX2, gX2, CV_64F, gaussKernel); filter2D(gY2, gY2, CV_64F, gaussKernel); filter2D(gXY, gXY, CV_64F, gaussKernel); Mat R(img.size(), img.type()); // R: æ¯ä¸ªåƒç´ çš„ Harris å“åº”å€¼  double k = 0.04;\t// k: é»˜è®¤å¸¸æ•°  double detM, trM;\t// det(M): è¡Œåˆ—å¼ï¼Œtr(M): è¿¹  for (int i = 0; i \u0026lt; img.rows; i++) { for (int j = 0; j \u0026lt; img.cols; j++) { // åˆ†åˆ«è®¡ç®—æ¯ä¸ªåƒç´ çš„ Harris å“åº”å€¼  detM = gX2.at\u0026lt;double\u0026gt;(i, j) * gX2.at\u0026lt;double\u0026gt;(i, j) - gXY.at\u0026lt;double\u0026gt;(i, j) * gXY.at\u0026lt;double\u0026gt;(i, j); trM = gX2.at\u0026lt;double\u0026gt;(i, j) + gY2.at\u0026lt;double\u0026gt;(i, j); R.at\u0026lt;double\u0026gt;(i, j) = detM - k * trM * trM; } } double maxStrength;\t// å›¾åƒä¸­çš„æœ€å¤§å€¼  // minMaxLoc: Finds the global minimum and maximum in an array.  minMaxLoc(R, NULL, \u0026amp;maxStrength); Mat dilated, localMax; // dilate: Dilates an image by using a specific structuring element.  // é»˜è®¤ 3 Ã— 3 å†…æ ¸è†¨èƒ€ï¼Œè†¨èƒ€ä¹‹åé™¤å±€éƒ¨æœ€å¤§å€¼ä¸åŸæ¥ç›¸åŒï¼Œå…¶ä»–éå±€éƒ¨æœ€å¤§å€¼å‡è¢«è¯¥é‚»åŸŸå†…çš„æœ€å¤§å€¼ç‚¹å–ä»£  dilate(R, dilated, Mat()); // compare: Performs the per-element comparison of two arrays or an array and scalar value.  // ä¸åŸå›¾ç›¸æ¯”ï¼Œæ‰¾å‡ºå€¼ç›¸åŒçš„ï¼ˆCMP_EQï¼‰ç‚¹ï¼Œè¿™äº›ç‚¹éƒ½æ˜¯å±€éƒ¨æœ€å¤§å€¼ç‚¹ï¼Œä¿å­˜åˆ° localMax ä¸­  compare(R, dilated, localMax, CMP_EQ); Mat cornerMap; double qualityLevel = 0.01; double threshold = qualityLevel * maxStrength; cornerMap = R \u0026gt; threshold; bitwise_and(cornerMap, localMax, cornerMap); // éå†æ‰¾å‡ºä¿ç•™çš„æå€¼ç‚¹  Mat_\u0026lt;uchar\u0026gt;::const_iterator it = cornerMap.begin\u0026lt;uchar\u0026gt;(); Mat_\u0026lt;uchar\u0026gt;::const_iterator itd = cornerMap.end\u0026lt;uchar\u0026gt;(); for (int i = 0; it != itd; it++, i++) { if (*it) keyPoints.push_back(KeyPoint((float)(i % img.cols), (float)(i / img.cols), 2)); } }  æ³¨ï¼šåœ¨ OpenCV ä¹Ÿæœ‰ç°æˆçš„ cornerHarris() å‡½æ•°è®¡ç®—è§’ç‚¹ï¼Œå¯ä»¥ç›´æ¥è°ƒç”¨ã€‚\n æå–ç»“æœ æ•ˆæœä¸é”™ï¼Œä¸ Moravec ç®—å­æ¯”è¾ƒæ¥è¿‘\n å›¾ 6 Harris ç®—å­è¾“å‡ºç»“æœ\n   å‚è€ƒï¼š\n$1$. å¼ å‰‘æ¸…ï¼Œæ½˜åŠ±ï¼Œç‹æ ‘æ ¹ï¼Œã€Šæ‘„å½±æµ‹é‡å­¦ï¼ˆç¬¬äºŒç‰ˆï¼‰ã€‹\n$2$. H. P. Moravec, Obstacle Avoidance and Navigation in the Real World by a Seeing Robot Rover, PhD Thesis, Stanford University, Stanford, CA, USA, 1980.\n$3$. OpenCV: Harris Corner Detection\n$4$. Harrisè§’ç‚¹ - â˜†Ronnyä¸¶ - åšå®¢å›­\n ","permalink":"https://jifan.tech/posts/2019-04-02-opencv-2/","summary":"åœ¨è®¡ç®—æœºè§†è§‰ï¼ˆComputer Visionï¼‰ä¸æ‘„å½±æµ‹é‡ï¼ˆPhotogrammetryï¼‰ä¸­ï¼Œæˆ‘ä»¬åœ¨ä¸åŒå½±åƒä¹‹é—´æ‰¾åˆ°ç›¸åŒ¹é…çš„ç‰¹å¾ï¼Œå·²å»ºç«‹ä¸¤å¹…å½±åƒ","title":"OpenCV ç‚¹ç‰¹å¾æå–ç®—å­ï¼šMoravecï¼ŒForstner ä¸ Harris"},{"content":"è¾¹ç¼˜æ£€æµ‹ï¼ˆEdge Detectionï¼‰æ˜¯å›¾åƒå¤„ç†çš„åŸºç¡€å†…å®¹ã€‚æœ¬æ–‡ä¸­ï¼Œæˆ‘ä»OpenCVå®˜ç½‘ä¸Šä¸‹è½½äº†æœ€æ–°ç‰ˆæœ¬çš„ OpenCV 4.0.1ï¼ˆ2018-12-22ï¼‰ï¼Œå€ŸåŠ©å®˜æ–¹æ–‡æ¡£å’Œç½‘ç»œæ•™ç¨‹å®Œæˆäº†ç¯å¢ƒé…ç½®ä¸æµ‹è¯•ï¼Œå…·ä½“æ­¥éª¤ä¸å†èµ˜è¿°ã€‚\nåœ¨ OpenCV ä¸­å¯ç”¨äºè¾¹ç¼˜æ£€æµ‹çš„ç®—å­ä¸»è¦æœ‰ï¼š\n Canny ç®—å­ Sobel ç®—å­ Laplace ç®—å­  Canny ç®—å­ ç†è®º Canny ç®—æ³•æ˜¯ç”± John F. Canny äº 1987 å¹´åœ¨ A computational approach to edge detection ä¸€æ–‡æå‡ºæ¥çš„ï¼Œå®ƒæ—¨åœ¨æ»¡è¶³ä¸‰ä¸ªä¸»è¦æ ‡å‡†ï¼š\n ä½é”™è¯¯ç‡ (Low error rate)ï¼šæ„å‘³ç€åªæ£€æµ‹å®é™…å­˜åœ¨çš„è¾¹ç¼˜ã€‚ é«˜å®šä½æ€§ (Good localization)ï¼šå°†æ£€æµ‹åˆ°çš„è¾¹ç¼˜åƒç´ ä¸å®é™…è¾¹ç¼˜åƒç´ ä¹‹é—´çš„è·ç¦»æœ€å°åŒ–ã€‚ æœ€å°å“åº” (Minimal response)ï¼šæ¯ä¸ªè¾¹ç¼˜åªæœ‰ä¸€ä¸ªæ£€æµ‹å™¨å“åº”ã€‚  Canny ç®—å­çš„æ­¥éª¤å¦‚ä¸‹ï¼š\n æ»¤æ‰ä»»ä½•å™ªå£°ã€‚è¿™ä¸€è¿‡ç¨‹å°†ä½¿ç”¨é«˜æ–¯æ»¤æ³¢å™¨ã€‚ä¾‹å¦‚ï¼Œä¸€ä¸ª 5Ã—5 çš„é«˜æ–¯å†…æ ¸å¦‚ä¸‹æ‰€ç¤ºï¼š  $$ K = \\dfrac{1}{159} \\begin{bmatrix} 2 \u0026amp; 4 \u0026amp; 5 \u0026amp; 4 \u0026amp; 2 \\cr 4 \u0026amp; 9 \u0026amp; 12 \u0026amp; 9 \u0026amp; 4 \\cr 5 \u0026amp; 12 \u0026amp; 15 \u0026amp; 12 \u0026amp; 5 \\cr 4 \u0026amp; 9 \u0026amp; 12 \u0026amp; 9 \u0026amp; 4 \\cr 2 \u0026amp; 4 \u0026amp; 5 \u0026amp; 4 \u0026amp; 2 \\end{bmatrix} $$\n è®¡ç®—å›¾åƒçš„å¼ºåº¦æ¢¯åº¦ã€‚ä¸ºæ­¤ï¼Œæˆ‘ä»¬éµå¾ªç±»ä¼¼äº Sobel ç®—å­çš„æ–¹æ³•ï¼š\n  åœ¨ $x$ å’Œ $y$ æ–¹å‘åº”ç”¨ä¸€ç»´å·ç§¯æ©æ¨¡ï¼š\n$$ G_{x} = \\begin{bmatrix} -1 \u0026amp; 0 \u0026amp; +1 \\cr -2 \u0026amp; 0 \u0026amp; +2 \\cr -1 \u0026amp; 0 \u0026amp; +1 \\end{bmatrix} $$\n$$ G_{y} = \\begin{bmatrix} -1 \u0026amp; -2 \u0026amp; -1 \\cr 0 \u0026amp; 0 \u0026amp; 0 \\cr +1 \u0026amp; +2 \u0026amp; +1 \\end{bmatrix} $$\n  æ‰¾åˆ°æ¢¯åº¦å¼ºåº¦å’Œæ–¹å‘ï¼š\n$$ \\begin{array}{l} G = \\sqrt{ G_{x}^{2} + G_{y}^{2} } \\cr \\theta = \\arctan\\left(\\dfrac{ G_{y} }{ G_{x} }\\right) \\end{array} $$\nå°†æ¢¯åº¦æ–¹å‘å››èˆäº”å…¥ä¸ºå››ä¸ªå¯èƒ½çš„è§’åº¦ä¹‹ä¸€ï¼ˆå³ 0Â°ï¼Œ45Â°ï¼Œ90Â° æˆ– 135Â°ï¼‰ã€‚\n    éæå¤§å€¼æŠ‘åˆ¶ã€‚åˆ é™¤éè¾¹ç¼˜éƒ¨åˆ†çš„åƒç´ ï¼Œä»…ä¿ç•™ä½œä¸ºå€™é€‰è¾¹ç¼˜çš„ç»†çº¿ã€‚\n  æ»åé˜ˆå€¼ï¼ˆHysteresisï¼‰ã€‚åº”ç”¨ä¸¤ä¸ªé˜ˆå€¼ï¼ˆä¸Šé™ upper å’Œä¸‹é™ lower ï¼‰ï¼š\n å¦‚æœåƒç´ æ¢¯åº¦é«˜äºä¸Šé™ï¼Œåˆ™å°†å…¶è§†ä¸ºè¾¹ç¼˜ å¦‚æœåƒç´ æ¢¯åº¦ä½äºä¸‹é™ï¼Œåˆ™èˆå¼ƒ å¦‚æœåƒç´ æ¢¯åº¦åœ¨ä¸¤ä¸ªé˜ˆå€¼ä¹‹é—´ï¼Œåˆ™ä»…å½“å®ƒè¿æ¥åˆ°é«˜äºä¸Šé˜ˆå€¼çš„åƒç´ æ—¶æ‰å°†å…¶ä½œä¸ºè¾¹ç¼˜   å»ºè®®çš„é˜ˆå€¼ï¼š$2:1 \\leq upper : lower \\leq 3:1â€‹$\n   åº”ç”¨ OpenCV ä¸­ Canny å‡½æ•°çš„ç”¨æ³•ä¸ºï¼š\nvoid cv::Canny(\tinputArray\timage, OutputArray\tedges, double\tthreshold1, double\tthreshold2, int\tapertureSize = 3, bool\tL2gradient = false )  imageï¼šè¾“å…¥å›¾åƒï¼Œå³æºå›¾åƒï¼ŒMat ç±»å•é€šé“8ä½å›¾åƒã€‚ edgesï¼šè¾“å‡ºçš„è¾¹ç¼˜å›¾ï¼Œéœ€è¦å’Œæºå›¾ç‰‡æœ‰ä¸€æ ·çš„å°ºå¯¸å’Œç±»å‹ã€‚ threshold1ï¼šç¬¬ä¸€ä¸ªæ»åæ€§é˜ˆå€¼ã€‚ threshold2ï¼šç¬¬äºŒä¸ªæ»åæ€§é˜ˆå€¼ã€‚ apertureSizeï¼šè¡¨ç¤ºåº”ç”¨ Sobel ç®—å­çš„å­”å¾„å¤§å°ï¼Œå…¶æœ‰é»˜è®¤å€¼ 3ã€‚ L2gradientï¼šä¸€ä¸ªè®¡ç®—å›¾åƒæ¢¯åº¦å¹…å€¼çš„æ ‡è¯†ï¼Œæœ‰é»˜è®¤å€¼ falseã€‚  å…·ä½“å®ç°ï¼š\n#include \u0026lt;iostream\u0026gt;#include \u0026lt;opencv2/core.hpp\u0026gt;#include \u0026lt;opencv2/opencv.hpp\u0026gt; using namespace cv; int main() { Mat src, src_gray; src = imread(\u0026#34;lenna.tif\u0026#34;); // è¯»å–å›¾åƒ \tif( src.empty() ) { printf(\u0026#34;Error: can not open the image.\\n\u0026#34;); return 1; } cvtColor(src, src_gray, COLOR_BGR2GRAY); // Canny ç®—å­ \tMat dst_canny = src.clone(); // åˆ›å»ºå›¾åƒå‰¯æœ¬ \tCanny(src, dst_canny, 150, 100); Mat dst_canny_2, edges_canny; dst_canny_2.create(src.size(), src.type()); blur(src_gray, edges_canny, Size(3, 3)); // ç”¨ 3Ã—3 å†…æ ¸é™å™ª \tCanny(edges_canny, edges_canny, 3, 3 * 3, 3); // è¿è¡Œ Canny ç®—å­ \tdst_canny_2 = Scalar::all(0); // ä½¿ç”¨ Canny ç®—å­è¾“å‡ºçš„è¾¹ç¼˜å›¾ edges_canny ä½œä¸ºæ©ç ï¼Œ \t// æ¥å°†åŸå›¾ src æ‹·è´åˆ°è¾“å‡ºå›¾åƒ dst_canny_2 ä¸­ \tsrc.copyTo(dst_canny_2, edges_canny); imshow(\u0026#34;è¾¹ç¼˜æå–-åŸå›¾\u0026#34;, src); waitKey(2); imshow(\u0026#34;è¾¹ç¼˜æå–-Cannyç®—å­\u0026#34;, dst_canny); waitKey(1); imshow(\u0026#34;è¾¹ç¼˜æå–-Cannyç®—å­ã€é«˜çº§å®ç°ã€‘\u0026#34;, dst_canny_2); waitKey(0); return 0; } ç»“æœå¦‚ä¸‹ï¼š  å›¾ 1 Canny ç®—å­è¾“å‡ºç»“æœ\n  Sobel ç®—å­ ç†è®º  Sobel ç®—å­æ˜¯ä¸€ä¸ªç¦»æ•£å¾®åˆ†ç®—å­ã€‚å®ƒè®¡ç®—å›¾åƒå¼ºåº¦å‡½æ•°çš„æ¢¯åº¦çš„è¿‘ä¼¼å€¼ã€‚ Sobel ç®—å­ç»“åˆäº†é«˜æ–¯å¹³æ»‘å’Œå·®åˆ†ã€‚  å‡è®¾è¦æ“ä½œçš„å›¾åƒä¸º $I$ï¼š\n  åˆ†åˆ«è®¡ç®—ä¸¤ä¸ªæ–¹å‘çš„å¯¼æ•°ï¼š\n  æ°´å¹³å˜åŒ–ï¼šå°† $I$ ä¸ä¸€ä¸ªå¥‡æ•°å¤§å°ï¼ˆsizeï¼‰çš„å†…æ ¸ $G_x$ è¿›è¡Œå·ç§¯ã€‚æ¯”å¦‚ï¼Œå½“å†…æ ¸å¤§å°ä¸º 3 æ—¶ï¼Œ$G_x$ ä¸ºï¼š\n$$ G_{x} = \\begin{bmatrix} -1 \u0026amp; 0 \u0026amp; 1 \\cr -2 \u0026amp; 0 \u0026amp; 2 \\cr -1 \u0026amp; 0 \u0026amp; 1 \\end{bmatrix} * I $$\n  å‚ç›´å˜åŒ–ï¼šå°† $I$ ä¸ä¸€ä¸ªå¥‡æ•°å¤§å°ï¼ˆsizeï¼‰çš„å†…æ ¸ $G_y$ è¿›è¡Œå·ç§¯ã€‚æ¯”å¦‚ï¼Œå½“å†…æ ¸å¤§å°ä¸º 3 æ—¶ï¼Œ$G_y$ ä¸ºï¼š\n$$ G_{y} = \\begin{bmatrix} -1 \u0026amp; -2 \u0026amp; -1 \\cr 0 \u0026amp; 0 \u0026amp; 0 \\cr 1 \u0026amp; 2 \u0026amp; 1 \\end{bmatrix} * I $$\n    åœ¨å›¾åƒçš„æ¯ä¸ªç‚¹ï¼Œæˆ‘ä»¬é€šè¿‡ç»„åˆä¸Šé¢çš„ä¸¤ä¸ªç»“æœæ¥è®¡ç®—è¯¥ç‚¹æ¢¯åº¦çš„è¿‘ä¼¼å€¼ï¼š\n$$ G = \\sqrt{ G_{x}^{2} + G_{y}^{2} } $$\nè™½ç„¶æœ‰æ—¶ä¼šä½¿ç”¨ä»¥ä¸‹æ›´ç®€å•çš„å…¬å¼ï¼š\n$$ G = \\left|G_{x}\\right| + \\left|G_{y}\\right| $$\n   æ³¨æ„ï¼š\nå½“å†…æ ¸çš„å¤§å°ï¼ˆsizeï¼‰ä¸º 3 æ—¶ï¼Œä¸Šè¿° Sobel å†…æ ¸å¯èƒ½ä¼šæœ‰å¾ˆæ˜æ˜¾çš„è¯¯å·®ï¼ˆæ¯•ç«Ÿ Sobel ç®—å­åªæ˜¯è®¡ç®—å¯¼æ•°çš„è¿‘ä¼¼å€¼ï¼‰ã€‚OpenCV é€šè¿‡ä½¿ç”¨ Scharr() å‡½æ•°è§£å†³äº†å¤§å°ä¸º 3 çš„å†…æ ¸å­˜åœ¨çš„è¿™ç§è¯¯å·®ã€‚è¿™æ¯”æ ‡å‡† Sobel å‡½æ•°æ›´å¿«ä¸”æ›´å‡†ç¡®ã€‚å…·ä½“å†…æ ¸å¦‚ä¸‹ï¼š\n$$ G_{x} = \\begin{bmatrix} -3 \u0026amp; 0 \u0026amp; +3 \\cr -10 \u0026amp; 0 \u0026amp; +10 \\cr -3 \u0026amp; 0 \u0026amp; +3 \\end{bmatrix} $$\n$$ G_{y} = \\begin{bmatrix} -3 \u0026amp; -10 \u0026amp; -3 \\cr 0 \u0026amp; 0 \u0026amp; 0 \\cr +3 \u0026amp; +10 \u0026amp; +3 \\end{bmatrix} $$\n åº”ç”¨ OpenCV ä¸­ Sobel å‡½æ•°çš„ç”¨æ³•ä¸ºï¼š\nvoid cv::Sobel( InputArray src, OutputArray dst, int ddepth, int dx, int dy, int ksize = 3, double scale = 1, double delta = 0, int borderType = BORDER_DEFAULT )\t  srcï¼šè¾“å…¥å›¾åƒ\n  dstï¼šä¸ src å…·æœ‰ç›¸åŒå¤§å°å’Œç›¸åŒé€šé“æ•°çš„è¾“å‡ºå›¾åƒ\n  ddepthï¼šè¾“å‡ºå›¾åƒçš„æ·±åº¦ï¼Œæ”¯æŒå¦‚ä¸‹ src.depth() å’Œ ddepth çš„ç»„åˆï¼š\n   Input depth (src.depth()) Output depth (ddepth)     CV_8U -1 / CV_16S / CV_32F / CV_64F   CV_16U / CV_16S -1 / CV_32F / CV_64F   CV_32F -1 / CV_32F / CV_64F   CV_64F -1 / CV_64F      dxï¼šx æ–¹å‘ä¸Šçš„å·®åˆ†é˜¶æ•°ã€‚\n  dyï¼šy æ–¹å‘ä¸Šçš„å·®åˆ†é˜¶æ•°ã€‚\n  ksizeï¼šSobel å†…æ ¸çš„å¤§å°ï¼›å¿…é¡»å– 1ï¼Œ3ï¼Œ5 æˆ– 7ã€‚\n  scaleï¼šè®¡ç®—å¯¼æ•°å€¼æ—¶å¯é€‰çš„ç¼©æ”¾å› å­ï¼Œé»˜è®¤å€¼æ˜¯1ï¼Œè¡¨ç¤ºé»˜è®¤æƒ…å†µä¸‹æ˜¯æ²¡æœ‰åº”ç”¨ç¼©æ”¾çš„ã€‚\n  deltaï¼šè¡¨ç¤ºåœ¨ç»“æœå­˜å…¥ dst ä¹‹å‰å¯é€‰çš„ delta å€¼ã€‚\n  borderTypeï¼šè¾¹ç•Œæ¨¡å¼ï¼Œé»˜è®¤å€¼ä¸ºBORDER_DEFAULTã€‚è¯¦è§ BorderTypesã€‚\n  å› ä¸º Sobel ç®—å­ç»“åˆäº†é«˜æ–¯å¹³æ»‘å’Œå·®åˆ†ï¼Œå› æ­¤ä¼šå…·æœ‰æ›´å¤šçš„æŠ—å™ªæ€§ã€‚\nå…·ä½“å®ç°ï¼š\n#include \u0026lt;iostream\u0026gt;#include \u0026lt;opencv2/core.hpp\u0026gt;#include \u0026lt;opencv2/opencv.hpp\u0026gt; using namespace cv; int main() { Mat src = imread(\u0026#34;lenna.tif\u0026#34;);\t// è¯»å–å›¾åƒ \tif( src.empty() ) { printf(\u0026#34;Error: can not open the image.\\n\u0026#34;); return 1; } Mat src_blur, src_blur_gray, dst_sobel; // é«˜æ–¯æ»¤æ³¢å™¨å»å™ªï¼ˆkernel size = 3ï¼‰ \tGaussianBlur(src, src_blur, Size(3, 3), 0, 0, BORDER_DEFAULT); // å°†å›¾åƒè½¬æ¢ä¸ºç°åº¦å›¾åƒ \tcvtColor(src_blur, src_blur_gray, COLOR_BGR2GRAY); Mat grad_x, grad_y; Mat abs_grad_x, abs_grad_y; // åˆ†åˆ«æ±‚ Xã€Y æ–¹å‘æ¢¯åº¦ \tSobel(src_blur_gray, grad_x, CV_16S, 1, 0, 3, 1, 1, BORDER_DEFAULT);\tSobel(src_blur_gray, grad_y, CV_16S, 0, 1, 3, 1, 1, BORDER_DEFAULT); // è½¬æ¢å› CV_8U \tconvertScaleAbs(grad_x, abs_grad_x); convertScaleAbs(grad_y, abs_grad_y); // åˆå¹¶æ¢¯åº¦ \taddWeighted(abs_grad_x, 0.5, abs_grad_y, 0.5, 0, dst_sobel); imshow(\u0026#34;è¾¹ç¼˜æå–-åŸå›¾\u0026#34;, src); waitKey(3); imshow(\u0026#34;è¾¹ç¼˜æå–-Sobelç®—å­-Xæ–¹å‘\u0026#34;, abs_grad_x); waitKey(2); imshow(\u0026#34;è¾¹ç¼˜æå–-Sobelç®—å­-Yæ–¹å‘\u0026#34;, abs_grad_y); waitKey(1); imshow(\u0026#34;è¾¹ç¼˜æå–-Sobelç®—å­-æ•´ä½“æ–¹å‘\u0026#34;, dst_sobel); waitKey(0); return 0; }  å›¾ 2 Sobel ç®—å­è¾“å‡ºç»“æœ\n  Laplace ç®—å­ ç†è®º   æ ¹æ®æ•°å­—å›¾åƒå¤„ç†ç›¸å…³çŸ¥è¯†ï¼Œæˆ‘ä»¬çŸ¥é“äºŒé˜¶å¯¼æ•°å¯ç”¨äºæ£€æµ‹è¾¹ç¼˜ã€‚ç”±äºå›¾åƒæ˜¯äºŒç»´ï¼ˆ2Dï¼‰çš„ï¼Œæˆ‘ä»¬éœ€è¦åœ¨ä¸¤ä¸ªæ–¹å‘ä¸Šè¿›è¡Œæ±‚å¯¼ã€‚\n  Laplace ç®—å­å®šä¹‰ä¸ºï¼š\n$$ Laplace(f) = \\dfrac{\\partial^{2} f}{\\partial x^{2}} + \\dfrac{\\partial^{2} f}{\\partial y^{2}} $$\n  åœ¨ OpenCV ä¸­ï¼ŒLaplace ç®—å­é€šè¿‡å‡½æ•° Laplacian() å®ç°ã€‚å®é™…ä¸Šï¼Œç”±äºæ‹‰æ™®æ‹‰æ–¯ç®—å­åˆ©ç”¨äº†å›¾åƒçš„æ¢¯åº¦ï¼Œå› æ­¤å®ƒåœ¨å†…éƒ¨è°ƒç”¨ Sobel ç®—å­æ¥æ‰§è¡Œå…¶è¿ç®—ï¼Œ\n  åº”ç”¨ OpenCV ä¸­ Laplacian() å‡½æ•°çš„ç”¨æ³•ä¸ºï¼š\nvoid cv::Laplacian( InputArray src, OutputArray dst, int ddepth, int ksize = 1, double scale = 1, double delta = 0, int borderType = BORDER_DEFAULT )\t srcï¼šè¾“å…¥å›¾åƒ dstï¼šä¸ src å…·æœ‰ç›¸åŒå¤§å°å’Œç›¸åŒé€šé“æ•°çš„è¾“å‡ºå›¾åƒ ddepthï¼šè¾“å‡ºå›¾åƒçš„æ·±åº¦ã€‚ ksizeï¼šç”¨äºè®¡ç®—äºŒé˜¶å¯¼æ•°çš„æ»¤æ³¢å™¨çš„å­”å¾„å°ºå¯¸ï¼›å®ƒå¯ä»¥æ˜¯ FILTER_SCHARRã€1ã€3ã€5 æˆ– 7ã€‚ scaleï¼šè®¡ç®—æ‹‰æ™®æ‹‰æ–¯å€¼æ—¶å¯é€‰çš„æ¯”ä¾‹å› å­ï¼Œé»˜è®¤å€¼æ˜¯1ï¼Œè¡¨ç¤ºé»˜è®¤æƒ…å†µä¸‹æ˜¯æ²¡æœ‰åº”ç”¨ç¼©æ”¾çš„ã€‚ deltaï¼šè¡¨ç¤ºåœ¨ç»“æœå­˜å…¥ dst ä¹‹å‰å¯é€‰çš„ delta å€¼ã€‚ borderTypeï¼šè¾¹ç•Œæ¨¡å¼ï¼Œé»˜è®¤å€¼ä¸ºBORDER_DEFAULTã€‚è¯¦è§ BorderTypesã€‚  Laplacian() å‡½æ•°ä¸»è¦åˆ©ç”¨ Sobel ç®—å­è¿›è¡Œè¿ç®—ã€‚å®ƒé€šè¿‡åŠ ä¸Š Sobel ç®—å­è¿ç®—å‡ºçš„å›¾åƒ $x$ æ–¹å‘å’Œ $y$ æ–¹å‘ä¸Šçš„å¯¼æ•°ï¼Œæ¥å¾—åˆ°è¾“å…¥å›¾åƒçš„æ‹‰æ™®æ‹‰æ–¯å˜æ¢ç»“æœã€‚å½“ ksize == 1 æ—¶ï¼Œæ‹‰æ™®æ‹‰æ–¯å‡½æ•°çš„æ»¤æ³¢çª—å£ä¸ºï¼š\n$$ \\begin{bmatrix} 0 \u0026amp; 1 \u0026amp; 0 \\cr 1 \u0026amp; -4 \u0026amp; 1 \\cr 0 \u0026amp; 1 \u0026amp; 0 \\end{bmatrix} $$\nå…·ä½“å®ç°ï¼š\n#include \u0026lt;iostream\u0026gt;#include \u0026lt;opencv2/core.hpp\u0026gt;#include \u0026lt;opencv2/opencv.hpp\u0026gt; using namespace cv; int main() { // è¯»å–å›¾åƒ \tMat src = imread(\u0026#34;lenna.tif\u0026#34;);\tif( src.empty() ) { printf(\u0026#34;Error: can not open the image.\\n\u0026#34;); return 1; } // Laplace ç®—å­ \tMat src_blur, src_blur_gray; Mat dst_laplace, abs_dst_laplace; // é«˜æ–¯æ»¤æ³¢å™¨å»å™ªï¼ˆkernel size = 3ï¼‰ \tGaussianBlur(src, src_blur, Size(3, 3), 0, 0, BORDER_DEFAULT); // å°†å›¾åƒè½¬æ¢ä¸ºç°åº¦å›¾åƒ \tcvtColor(src_blur, src_blur_gray, COLOR_BGR2GRAY); // åº”ç”¨ Laplace ç®—å­ \tLaplacian(src_blur_gray, dst_laplace, CV_16S, 3, 1, 0, BORDER_DEFAULT); // è®¡ç®—ç»å¯¹å€¼ï¼Œå°†ç»“æœè½¬æ¢ä¸º 8 ä½ \tconvertScaleAbs(dst_laplace, abs_dst_laplace); imshow(\u0026#34;è¾¹ç¼˜æå–-åŸå›¾\u0026#34;, src); waitKey(1); imshow(\u0026#34;è¾¹ç¼˜æ£€æµ‹-Laplaceç®—å­\u0026#34;, abs_dst_laplace); waitKey(0); return 0; }  å›¾ 3 Laplace ç®—å­è¾“å‡ºç»“æœ\n   å‚è€ƒï¼š\n ã€OpenCVå…¥é—¨æ•™ç¨‹ä¹‹åäºŒã€‘OpenCVè¾¹ç¼˜æ£€æµ‹ - æ¯›æ˜Ÿäº‘ï¼ˆæµ…å¢¨ï¼‰çš„ä¸“æ  - CSDNåšå®¢ OpenCV: Image Filtering OpenCV: Image Processing (imgproc module) OpenCV: Canny Edge Detector OpenCV: Sobel Derivatives OpenCV: Laplace Operator   ","permalink":"https://jifan.tech/posts/2019-03-19-opencv-1/","summary":"è¾¹ç¼˜æ£€æµ‹ï¼ˆEdge Detectionï¼‰æ˜¯å›¾åƒå¤„ç†çš„åŸºç¡€å†…å®¹ã€‚æœ¬æ–‡ä¸­ï¼Œæˆ‘ä»OpenCVå®˜ç½‘ä¸Šä¸‹è½½äº†æœ€æ–°ç‰ˆæœ¬çš„ OpenCV 4.0.1ï¼ˆ2018-12-22","title":"OpenCV å†…ç½®è¾¹ç¼˜æ£€æµ‹ç®—å­ï¼šCannyï¼ŒSobel ä¸ Laplace"},{"content":"æ–æ³¢é‚£å¥‘æ•°åˆ— æ–æ³¢é‚£å¥‘æ•°åˆ—ï¼ˆFibonacci Sequenceï¼‰æ˜¯ä¸€ä¸²æ•°å­—ï¼š\n\\[ (0,)\\ 1,\\ 1,\\ 2,\\ 3,\\ 5,\\ 8,\\ 13,\\ 21,\\ 34,\\ 55,\\ 89,\\ 144,\\ \u0026hellip; \\] å¾ˆå®¹æ˜“çœ‹å‡ºï¼Œæ¯ä¸€ä¸ªæ•°ï¼ˆé™¤ç¬¬ 1ã€2 ä¸ªï¼‰éƒ½ç­‰äºå®ƒä¹‹å‰çš„ä¸¤ä¸ªæ•°ä¹‹å’Œã€‚å› æ­¤ï¼Œç”¨å…¬å¼å¯å½’çº³ä¸ºï¼š \\[ F_n = \\begin{cases} 0, \u0026amp; n=0 \\\\ 1, \u0026amp; n=1 \\\\ F_{n-1} + F_{n-2}, \u0026amp; n\u0026gt;1 \\end{cases} \\]\nè®¡ç®—å¤æ‚æ€§ç†è®º åœ¨å°†æ–æ³¢é‚£å¥‘æ•°åˆ—ç”¨ C++ ä»£ç å®ç°å¹¶è®¡ç®—æ—¶é—´ã€ç©ºé—´å¤æ‚åº¦ä¹‹å‰ï¼Œå…ˆè¦äº†è§£ä¸€ä¸‹ä»€ä¹ˆæ˜¯æ‰€è°“çš„â€œå¤æ‚åº¦â€\næ—¶é—´å¤æ‚åº¦  åœ¨è®¡ç®—æœºç§‘å­¦ä¸­ï¼Œ ç®—æ³•çš„æ—¶é—´å¤æ‚åº¦ï¼ˆTime Complexityï¼‰æ˜¯ä¸€ä¸ªå‡½æ•°ï¼Œå®ƒå®šæ€§æè¿°ç®—æ³•çš„è¿è¡Œæ—¶é—´ã€‚è¿™æ˜¯ä¸€ä¸ªä»£è¡¨ç®—æ³•è¾“å…¥å€¼çš„å­—ç¬¦ä¸²çš„é•¿åº¦çš„å‡½æ•°ã€‚\nå¼•è‡ªï¼šWikipediaï¼Œæ—¶é—´å¤æ‚åº¦\n ä¸€ä¸ªè¯­å¥çš„é¢‘åº¦æ˜¯æŒ‡è¯¥è¯­å¥åœ¨ç®—æ³•ä¸­è¢«é‡å¤æ‰§è¡Œçš„æ¬¡æ•°ã€‚ç®—æ³•ä¸­æ‰€æœ‰è¯­å¥çš„é¢‘åº¦ä¹‹å’Œå³ä¸º $T(n)$ï¼Œå®ƒæ˜¯è¯¥ç®—æ³•é—®é¢˜è§„æ¨¡ $n$ çš„å‡½æ•°ï¼Œæ—¶é—´å¤æ‚åº¦ä¸»è¦åˆ†æ $T(n)$ çš„æ•°é‡çº§ã€‚ ç®—æ³•çš„åŸºæœ¬è¿ç®—ï¼ˆæœ€æ·±å±‚å¾ªç¯å†…çš„è¯­å¥ï¼‰çš„é¢‘åº¦ä¸ $T(n)$ åŒæ•°é‡çº§ã€‚å› æ­¤é€šå¸¸é‡‡ç”¨ç®—æ³•ä¸­åŸºæœ¬è¿ç®—çš„é¢‘åº¦ $f(n)$ æ¥åˆ†æç®—æ³•çš„æ—¶é—´å¤æ‚åº¦ã€‚å› æ­¤ï¼Œç®—æ³•çš„æ—¶é—´å¤æ‚åº¦è®°ä¸ºï¼š\n\\[ T(n) = O(f(n)) \\]\nå¼ä¸­ï¼Œ$O$ çš„å«ä¹‰æ˜¯ $T(n)$ çš„æ•°é‡çº§ï¼Œå…¶ä¸¥æ ¼çš„æ•°å­¦å®šä¹‰æ˜¯ï¼šè‹¥ $T(n)$ å’Œ $f(n)$ æ˜¯å®šä¹‰åœ¨æ­£æ•´æ•°é›†åˆä¸Šçš„ä¸¤ä¸ªå‡½æ•°ï¼Œåˆ™å­˜åœ¨æ­£å¸¸æ•° $C$ å’Œ $n_0$ï¼Œä½¿å¾—å½“ $n \\geq n_0$ æ—¶ï¼Œéƒ½æ»¡è¶³ $0 \\leq T(n) \\leq Cf(n)$ã€‚\nç®—æ³•çš„æ—¶é—´å¤æ‚åº¦ä¸ä»…ä¾èµ–äºé—®é¢˜çš„è§„æ¨¡ $n$ï¼Œä¹Ÿå»å†³å®šäºå¾…è¾“å…¥æ•°æ®çš„æ€§è´¨ï¼ˆå¦‚è¾“å…¥æ•°æ®å…ƒç´ çš„åˆå§‹çŠ¶æ€ï¼‰ã€‚\n æœ€åæ—¶é—´å¤æ‚åº¦ï¼šåœ¨æœ€åæƒ…å†µä¸‹ï¼Œç®—æ³•çš„æ—¶é—´å¤æ‚åº¦ã€‚ å¹³å‡æ—¶é—´å¤æ‚åº¦ï¼šæ‰€æœ‰å¯èƒ½è¾“å…¥ç¤ºä¾‹åœ¨ç­‰æ¦‚ç‡å‡ºç°çš„æƒ…å†µä¸‹ï¼Œç®—æ³•çš„æœŸæœ›è¿è¡Œæ—¶é—´ã€‚ æœ€å¥½æ—¶é—´å¤æ‚åº¦ï¼šåœ¨æœ€å¥½æƒ…å†µä¸‹ï¼Œç®—æ³•çš„æ—¶é—´å¤æ‚åº¦ã€‚  ä¸€èˆ¬æ€»æ˜¯è€ƒè™‘åœ¨æœ€åæƒ…å†µä¸‹çš„æ—¶é—´å¤æ‚åº¦ï¼Œä»¥ä¿è¯ç®—æ³•çš„è¿è¡Œæ—¶å¸¸ä¸ä¼šæ¯”å®ƒæ›´é•¿ã€‚\nåœ¨åˆ†æä¸€ä¸ªç¨‹åºçš„æ—¶é—´å¤æ‚æ€§æ—¶ï¼Œæœ‰ä»¥ä¸‹ä¸¤æ¡è§„åˆ™ï¼š\n(a) åŠ æ³•è§„åˆ™ï¼š \\[ \\begin{align*} T(n) \u0026amp;= T_1\\left(n\\right) + T_2\\left(n\\right) \\cr \u0026amp;= O\\left(f\\left(n\\right)\\right) + O(g(n)) \\cr \u0026amp;= O\\left(\\max(f(n), g(n))\\right) \\end{align*} \\] (b) ä¹˜æ³•è§„åˆ™ï¼š \\[ \\begin{align*} T(n) \u0026amp;= T_1(n) \\times T_2(n) \\cr \u0026amp;= O(f(n)) \\times O(g(n)) \\cr \u0026amp;= O(f(n) \\times g(n)) \\end{align*} \\] æ—¶é—´å¤æ‚åº¦å¯è¢«æˆä¸ºæ˜¯æ¸è¿›çš„ï¼Œäº¦å³è€ƒå¯Ÿè¾“å…¥å€¼å¤§å°è¶‹è¿‘äºæ— ç©·æ—¶ï¼ˆ$n\\rightarrow\\infty$ï¼‰çš„æƒ…å†µã€‚ å¸¸è§çš„æ¸è¿›æ—¶é—´å¤æ‚åº¦ä¸ºï¼š \\[ O(1) \u0026lt; O(\\log_2 n) \u0026lt; O(n) \u0026lt; O(n\\log_2 n) \u0026lt; O(n^2) \\newline \u0026lt; O(n^3) \u0026lt; O(2^n) \u0026lt; O(n!) \u0026lt; O(n^n) \\]\nç©ºé—´å¤æ‚åº¦  ç®—æ³•çš„ç©ºé—´å¤æ‚åº¦ $S(n)$ è¢«å®šä¹‰ä¸ºè¯¥ç®—æ³•æ‰€è€—è´¹çš„å­˜å‚¨ç©ºé—´ï¼Œå®ƒæ˜¯é—®é¢˜è§„æ¨¡ $n$ çš„å‡½æ•°ã€‚æ¸è¿›ç©ºé—´å¤æ‚åº¦ä¹Ÿå¸¸ç®€ç§°ä¸ºç©ºé—´å¤æ‚åº¦ï¼Œè®°ä¸º $S(n) = O(g(n))$ã€‚\n ä¸€ä¸ªç¨‹åºé™¤éœ€è¦å­˜å‚¨ç©ºé—´æ¥å­˜æ”¾æœ¬èº«æ‰€ç”¨çš„æŒ‡ä»¤ã€å¸¸æ•°ã€å˜é‡å’Œè¾“å…¥æ•°æ®å¤–ï¼Œè¿˜éœ€è¦ä¸€äº›å¯¹æ•°æ®è¿›è¡Œæ“ä½œçš„å·¥ä½œå•å…ƒå’Œå­˜å‚¨ä¸ºå®ç°è®¡ç®—æœºæ‰€éœ€çš„ä¸€äº›ä¿¡æ¯çš„è¾…åŠ©ç©ºé—´ï¼Œè‹¥è¾“å…¥æ•°æ®æ‰€å ç©ºé—´åªå–å†³äºé—®é¢˜æœ¬èº«è€Œä¸ç®—æ³•æ— å…³ï¼Œåˆ™åªéœ€åˆ†æé™¤è¾“å…¥å’Œç¨‹åºå¤–çš„é¢å¤–ç©ºé—´ã€‚\nç®—æ³•åŸåœ°å·¥ä½œæ˜¯æŒ‡ç®—æ³•æ‰€éœ€çš„è¾…åŠ©ç©ºé—´ä¸ºå¸¸é‡ï¼Œå³ $O(1)$ã€‚\né€’å½’ç®—æ³• æœ€ç®€å•çš„ç®—æ³•å³æ˜¯æ ¹æ®å®šä¹‰å†™å‡ºçš„é€’å½’ç®—æ³•ï¼ŒC++ ä»£ç å¦‚ä¸‹ï¼š\nint fibonacci(int n) { if (n \u0026lt; 2) { return n; } return fibonacci(n - 1) + fibonacci(n - 2); } æ—¶é—´å¤æ‚åº¦ï¼š\næˆ‘ä»¬çŸ¥é“æ–æ³¢é‚£å¥‘æ•°åˆ—æ•°åˆ—çš„é€’å½’æ–¹ç¨‹æ˜¯ $T(n) = T(n-1) + T(n-2) + O(1)$ã€‚è¿™å°±æ„å‘³ç€ï¼Œè®¡ç®— fibonacci(n) çš„æ—¶é—´ç­‰äºè®¡ç®— fibonacci(n-1) ä¸ fibonacci(n-2) çš„æ—¶é—´ã€‚å› æ­¤æˆ‘ä»¬å¾ˆå®¹æ˜“å¾—çŸ¥ï¼Œåœ¨é€’å½’æ±‚è§£æ–æ³¢é‚£å¥‘æ•°æ—¶ï¼Œæ—¶é—´å¤æ‚åº¦çš„ä¸Šç•Œ (upper bound) æ˜¯ $O(2^n)$ã€‚ä½†é€šè¿‡åœ¨æ•°å­¦ä¸Šç”¨çº¿æ€§é€’å½’å‡½æ•°æ¥è¡¨ç¤ºï¼Œæˆ‘ä»¬å¯ä»¥æ‰¾åˆ° Fibonacci çš„ä¸Šç¡®ç•Œ (tight upper bound or supremum)ã€‚\nç°æ ¹æ®æ–æ³¢é‚£å¥‘æ•°åˆ—çš„å®šä¹‰ï¼š \\[ F(n) = F(n-1) + F(n-2) \\] å¾—åˆ°å…¶ç‰¹å¾æ–¹ç¨‹ä¸ºï¼š \\[ x^2 = x + 1 \\newline x^2 - x - 1 = 0 \\] è§£å¾—è¯¥äºŒæ¬¡æ–¹ç¨‹çš„æ ¹ä¸º $\\alpha_1 = \\frac{1 + \\sqrt{5}}{2},\\ \\alpha_2 = \\frac{1 - \\sqrt{5}}{2}$ã€‚ç°åœ¨æˆ‘ä»¬å¾—åˆ°çš„çº¿æ€§é€’å½’å‡½æ•°ä¸ºï¼š \\[ F(n) = (\\alpha_1)^n + (\\alpha_2)^n \\] æ‰€ä»¥æ–æ³¢é‚£å¥‘å‡½æ•° $F(n) = F(n-1) + F(n-2)$ çš„è§£ä¸ºï¼š \\[ F(n) = (\\frac{1 + \\sqrt{5}}{2})^n + (\\frac{1 - \\sqrt{5}}{2})^n \\] æ˜¾ç„¶ï¼Œåœ¨è¿›è¡Œæ— ç©·å¤§ï¼ˆ$n \\rightarrow \\infty$ï¼‰æ¸è¿›åˆ†æ æ—¶ï¼Œ$T(n)$ ä¸ $F(n)$ è¡¨ç¤ºå«ä¹‰æ˜¯ç›¸åŒçš„ï¼Œå¯è¢«è¿‘ä¼¼åœ°çœ‹åšç›¸ç­‰ï¼Œäºæ˜¯å¯ä»¥å¾—å‡ºï¼š \\[ T(n) = O\\left(\\left(\\frac{1 + \\sqrt{5}}{2}\\right)^n + \\left(\\frac{1 - \\sqrt{5}}{2}\\right)^n\\right) \\] æˆ–è€…å¯ä»¥å†™ä½œå¦‚ä¸‹å½¢å¼ ï¼ˆæ ¹æ®æ¸è¿›ç¬¦å· $O$ (Big O notation)ï¼Œå¯ä»¥å¿½ç•¥æ‰ä½é˜¶é¡¹ï¼‰ï¼š \\[ T(n) = O((\\frac{1 + \\sqrt{5}}{2})^n) \\\\\\\\ T(n) = O(1.618^n) \\] è¿™å³æ˜¯æ–æ³¢é‚£å¥‘é€’å½’å‡½æ•°çš„ä¸Šç¡®ç•Œï¼ˆtight upper boundï¼‰ï¼ŒåŒæ—¶æˆ‘ä»¬ä¹Ÿå¯ä»¥çŸ¥é“ï¼Œé€’å½’ç®—æ³•ç¡®åˆ‡çš„æ—¶é—´å¤æ‚åº¦ä¸º $O(1.618^n)$ã€‚\nç©ºé—´å¤æ‚åº¦ï¼šå‡½æ•°æ¯æ¬¡æ‰§è¡Œéƒ½ä¼šè°ƒç”¨ä¸€æ¬¡å †æ ˆï¼Œæ•…ç©ºé—´å¤æ‚åº¦ä¸º $O(n)$ã€‚\nå¾ªç¯ç®—æ³• å¾ªç¯ç®—æ³•çš„æ€è·¯ä¸ºï¼š\n å½“ $n = 0$ æ—¶ï¼Œè¿”å› $F_0$ çš„å€¼ $0$ï¼ˆæ­¤æ—¶ï¼Œ$F_{n+1}=F_1=1$ï¼Œ$F_n=F_0=0$ çš„å€¼å·²ç»™å‡º å½“ $n \u0026gt; 0\\ (1,\\ 2,\\ \u0026hellip;,\\ \\infty)$ æ—¶  ç”¨ä¸€ä¸ªæ•° b å­˜æ”¾ $F_n$ çš„å€¼ï¼Œå¦ä¸€ä¸ªæ•° a å­˜æ”¾ $F_{n+1}$ çš„å€¼ æ‰§è¡Œä¸€æ¬¡å¾ªç¯ï¼Œa + b ä¸ºæ–°çš„ $F_{n+1}$ çš„å€¼ï¼ŒåŸæœ‰çš„ a çš„å€¼å³ä¸ºæ–°çš„ $F_n$ï¼Œå†å°†è¿™ä¸¤ä¸ªå€¼åˆ†åˆ«èµ‹ç»™ä¸¤ä¸ªå¯¹åº”çš„å˜é‡ï¼ˆtemp å……å½“åª’ä»‹ï¼‰ æŒ‰æ­¤å¾€å¤ï¼Œç›´åˆ°å¾ªç¯ç»“æŸ    int fibonacci(int n) { int a = 1, b = 0, temp; while (n \u0026gt; 0) { temp = a; a = a + b; b = temp; n--; } return b; } æ—¶é—´å¤æ‚åº¦ï¼šæ€è·¯å¾ˆæ¸…æ™°ï¼Œå¾ªç¯æ¬¡æ•°ä¸ $n$ çº¿æ€§æ­£ç›¸å…³ï¼Œæ—¶é—´å¤æ‚åº¦ä¸º $O(n)$ï¼Œè¾ƒä¹‹é€’å½’ç®—æ³•å¥½å¾ˆå¤šã€‚\nç©ºé—´å¤æ‚åº¦ï¼šç®—æ³•æ‰€éœ€è¦çš„è¾…åŠ©ç©ºé—´ä¸ºå¸¸é‡ï¼Œæ•…ç©ºé—´å¤æ‚åº¦ä¸º $O(1)$ã€‚\nå°¾é€’å½’ç®—æ³• å°¾é€’å½’ç®—æ³•çš„æ€è·¯ä¸å¾ªç¯ç®—æ³•ç›¸ä¼¼ï¼Œè°ƒç”¨æ ¼å¼ä¸º fibonacci(0, 1, n) ï¼š\nint fibonacci(int first, int second, int n) { if (n \u0026lt; 2) { return n; } else if (n == 2) { return first + second; } return fibonacci(second, first + second, n - 1); } æ—¶é—´å¤æ‚åº¦ï¼šé€’å½’æ¬¡æ•°ä¸º $n$ï¼Œæ•…ä¸º $O(n)$ã€‚\nç©ºé—´å¤æ‚åº¦ï¼šå‡½æ•°æ¯ä¸€æ¬¡æ‰§è¡Œéƒ½ä¼šè°ƒç”¨ä¸€æ¬¡å †æ ˆï¼Œæ•…ä¸º $O(n)$ã€‚\nçŸ©é˜µç®—æ³• æ¯”è¾ƒä¸Šè¿°å‡ ç§ç®—æ³•ï¼Œå¯ä»¥çœ‹å‡ºï¼Œå®ƒä»¬éƒ½åˆ©ç”¨äº†åˆ†æ²» (divide and conquer) çš„æ€æƒ³â€”â€”å°†åŸé—®é¢˜åˆ’åˆ†æˆè‹¥å¹²ä¸ªè§„æ¨¡è¾ƒå°è€Œç»“æ„ä¸åŸé—®é¢˜ç›¸åŒæˆ–ç›¸ä¼¼çš„å­é—®é¢˜ï¼Œç„¶ååˆ†åˆ«è§£å†³è¿™äº›å­é—®é¢˜ï¼Œæœ€ååˆå¹¶å­é—®é¢˜çš„è§£ï¼Œå³å¯å¾—åˆ°ä¸ºåŸé—®é¢˜çš„è§£ã€‚åªä¸è¿‡åŒºåˆ«åœ¨äºæ˜¯è¿›è¡Œæ™®é€šåœ°åˆ†æ²»è¿˜æ˜¯åŠ¨æ€è§„åˆ’ã€‚\næˆ‘ä»¬å°†æ–æ³¢é‚£å¥‘æ•°åˆ—ä¸­ç›¸é‚»çš„ä¸¤é¡¹ $F(n)$ å’Œ $F(n-1)$ å†™æˆä¸€ä¸ª $2 \\times 1$ çš„çŸ©é˜µï¼Œé€šè¿‡è®¡ç®—å¯ä»¥å¾—åˆ°ä»¥ä¸‹ç»“è®ºï¼š \\[ \\begin{bmatrix} F_n \\cr F_{n-1} \\end{bmatrix} = \\begin{bmatrix} F_{n-1} + F_{n-2} \\cr F_{n-1} \\end{bmatrix} = \\begin{bmatrix} 1 \\times F_{n-1}+1 \\times F_{n-2} \\cr 1 \\times F_{n-1}+0 \\times F_{n-2} \\end{bmatrix} = \\begin{bmatrix}1\u0026amp;1 \\cr 1\u0026amp;0 \\end{bmatrix}\\times\\begin{bmatrix}F_{n-1} \\cr F_{n-2}\\end{bmatrix} \\] æ¨å¾—ï¼š \\[ \\begin{bmatrix}F_n \\cr F_{n-1} \\end{bmatrix} =\\begin{bmatrix}1\u0026amp;1 \\cr 1\u0026amp;0 \\end{bmatrix}^{n-1} \\times \\begin{bmatrix}F_{1} \\cr F_{0} \\end{bmatrix} =\\begin{bmatrix}1\u0026amp;1 \\cr 1\u0026amp;0 \\end{bmatrix}^{n-1} \\times \\begin{bmatrix}1 \\cr 0 \\end{bmatrix} \\] å› æ­¤è¦æ±‚æ–æ³¢é‚£å¥‘æ•° $F(n)$ï¼Œå…³é”®æ˜¯è®¡ç®—äºŒé˜¶çŸ©é˜µ $\\begin{bmatrix}1\u0026amp;1\\\\1\u0026amp;0\\end{bmatrix}$ çš„ $n - 1$ çš„æ¬¡æ–¹ã€‚æœ€ç»ˆå–ç›¸ä¹˜ç»“æœçŸ©é˜µç¬¬ä¸€è¡Œç¬¬ä¸€åˆ—æ•°å­—å³å¯ã€‚\næ±‚æ–¹é˜µçš„ $n-1$ æ¬¡æ–¹ä¹ä¸€çœ‹éå¸¸ç¹å¤ï¼Œè€Œä¸”è¦æ±‚è¿™ä¹ˆå¤šæ¬¡çš„ä¹˜æ–¹ï¼Œæ—¶é—´å¤æ‚åº¦ä¹Ÿä¸º $O(n)$ï¼Œç›¸è¾ƒäºå¾ªç¯ç®—æ³•æ²¡æœ‰è¿›æ­¥ã€‚ é‚£ä¹ˆï¼Œä¸ºä»€ä¹ˆæˆ‘ä»¬è¿˜è¦è®¨è®ºè¿™ä¸ªæ–¹æ³•å‘¢ï¼Ÿå› ä¸ºå¹‚è¿ç®—æ˜¯å¯ä»¥é€šè¿‡äºŒåˆ†å¹‚æ¥ä¼˜åŒ–åŠ é€Ÿçš„ã€‚æ¯”å¦‚è¯´ï¼Œå½“æˆ‘ä»¬éœ€è¦è®¡ç®— $a^n$ æ—¶ï¼š \\[ a^n=\\begin{cases} a^{\\frac{n}{2}}\\times a^{\\frac{n}{2}}\u0026amp;,\\text{ if $x$ is even} \\cr a^{\\frac{n-1}{2}}\\times a^{\\frac{n-1}{2}}\\times a\u0026amp;,\\text{ if $x$ is odd} \\end{cases} \\] è¿™ä¸ªæ–¹æ³•ä¹Ÿè¿ç”¨äº†åˆ†æ²»çš„æ€æƒ³ï¼ŒèŠ‚çœäº†å¤§çº¦ $n/2 - 1$ æ¬¡ä¹˜æ³•è¿ç®—ã€‚é‚£ä¹ˆæ—¶é—´å¤æ‚åº¦ä¹Ÿç”±åŸæ¥çš„ $O(n)$ é™ä½ä¸º $O(\\log n)$ã€‚\nç®—æ³•çš„ C++ ä»£ç å¦‚ä¸‹ï¼š\nvoid multiply(int F[2][2], int M[2][2]);\t// è®¡ç®—çŸ©é˜µ FÃ—M void power(int F[2][2], int n);\t// æ±‚çŸ©é˜µ F çš„ n æ¬¡æ–¹  int fibonacci(int first, int second, int n) { int F[2][2] = { {1, 1}, {1, 0} }; if (n == 0) return 0; power(F, n - 1); // è®¡ç®—ç›®æ ‡äºŒé˜¶çŸ©é˜µçš„ n - 1 æ¬¡æ–¹  return F[0][0]; } void multiply(int F[2][2], int M[2][2]) { int x = F[0][0] * M[0][0] + F[0][1] * M[1][0]; int y = F[0][0] * M[0][1] + F[0][1] * M[1][1]; int z = F[1][0] * M[0][0] + F[1][1] * M[1][0]; int w = F[1][0] * M[0][1] + F[1][1] * M[1][1]; F[0][0] = x; F[0][1] = y; F[1][0] = z; F[1][1] = w; } void power(int F[2][2], int n) { if (n == 0 || n == 1) return; int M[2][2] = { {1, 1}, {1, 0} }; power(F, n / 2); // äºŒåˆ†å¹‚æ–¹æ³•  multiply(F, F); if (n % 2 != 0) multiply(F, M); } æ—¶é—´å¤æ‚åº¦ï¼š$O(\\log n)$ã€‚\nç©ºé—´å¤æ‚åº¦ï¼šç®—æ³•æ‰€éœ€çš„è¾…åŠ©ç©ºé—´ä»ä¸ºå¸¸é‡ï¼ˆè™½ç„¶å¯èƒ½ç›¸å¯¹è¾ƒå¤§ï¼‰ï¼Œæ•…ä¸º $O(1)$ã€‚\n  å‚è€ƒï¼š\n$1.$ æ–æ³¢é‚£å¥‘æ•°çš„æ—¶é—´å¤æ‚åº¦ã€ç©ºé—´å¤æ‚åº¦è¯¦è§£ - lxf_styleçš„åšå®¢ - CSDNåšå®¢\n$2.$ Fibonacci Sequence - MathIsFun.com\n$3.$ Fibonacci sequence algorithm in Javascript â€“ Developers Writing â€“ Medium\n$4.$ è®¡ç®—æ–æ³¢çº³å¥‘æ•°ï¼Œåˆ†æç®—æ³•å¤æ‚åº¦ Â· GoCalf Blog\n$5.$ Time complexity of recursive Fibonacci program - GeeksforGeeks\n$6.$ Program for Fibonacci numbers - GeeksforGeeks\n$7.$ äºŒåˆ†å¹‚ï¼Œå¿«é€Ÿå¹‚ï¼ŒçŸ©é˜µå¿«é€Ÿå¹‚ï¼Œå¿«é€Ÿä¹˜ - ä¸ç£Š_mlçš„åšå®¢ - CSDNåšå®¢\n ","permalink":"https://jifan.tech/posts/2019-03-01-ds-notes-1/","summary":"æ–æ³¢é‚£å¥‘æ•°åˆ— æ–æ³¢é‚£å¥‘æ•°åˆ—ï¼ˆFibonacci Sequenceï¼‰æ˜¯ä¸€ä¸²æ•°å­—ï¼š \\[ (0,)\\ 1,\\ 1,\\ 2,\\ 3,\\ 5,\\ 8,\\ 13,\\ 21,\\ 34,\\ 55,\\ 89,\\ 144,\\ \u0026hellip; \\] å¾ˆå®¹æ˜“çœ‹å‡ºï¼Œæ¯ä¸€ä¸ªæ•°ï¼ˆé™¤ç¬¬ 1ã€2 ä¸ª","title":"æ•°æ®ç»“æ„ç¬”è®°ï¼šæ±‚è§£æ–æ³¢é‚£å¥‘æ•°åˆ—ç®—æ³•çš„å¤æ‚åº¦"},{"content":" å†ä¸€æ¬¡åœ°ã€ä»å¤´å¼€å§‹å­¦ä¹ C/C++ã€‚\n C++ æ•°æ®ç±»å‹åŠå…¶è¡¨ç¤ºèŒƒå›´ è¿™ä¸€éƒ¨åˆ†æ˜¯åŸºç¡€ï¼Œä¸è¿‡æˆ‘ä¹‹å‰éƒ½æ²¡æœ‰ç³»ç»Ÿæ€§çš„ææ¸…æ¥šï¼Œæ‰€ä»¥ç°åœ¨è¿˜æ˜¯å…ˆæŠŠè¿™äº›çŸ¥è¯†ç‚¹åˆ—å‡ºæ¥ï¼Œè¯¥éƒ¨åˆ†å‚è€ƒC++ æ•°æ®ç±»å‹ - èœé¸Ÿæ•™ç¨‹ã€‚\n1. åŸºæœ¬çš„å†…ç½®ç±»å‹ C++ ä¸ºç¨‹åºå‘˜æä¾›äº†ç§ç±»ä¸°å¯Œçš„å†…ç½®æ•°æ®ç±»å‹å’Œç”¨æˆ·è‡ªå®šä¹‰çš„æ•°æ®ç±»å‹ã€‚ä¸‹è¡¨åˆ—å‡ºäº†ä¸ƒç§åŸºæœ¬çš„ C++ æ•°æ®ç±»å‹ï¼š\n   ç±»å‹ å…³é”®å­—     å¸ƒå°”å‹ bool   å­—ç¬¦å‹ char   æ•´å‹ int   æµ®ç‚¹å‹ float   åŒæµ®ç‚¹å‹ double   æ— ç±»å‹ void   å®½å­—ç¬¦å‹ wchar_t    å…¶ä¸­ï¼Œwchar_t å®é™…ä¸Šæ˜¯ï¼š\ntypedef wchar_t short int; æ‰€ä»¥ wchar_t å®é™…ä¸Šçš„ç©ºé—´å’Œ short int ä¸€æ ·ã€‚ ä¸€äº›åŸºæœ¬ç±»å‹å¯ä»¥ä½¿ç”¨ä¸€ä¸ªæˆ–å¤šä¸ªç±»å‹ä¿®é¥°ç¬¦è¿›è¡Œä¿®é¥°ï¼š\n signed unsigned short long  2. å„ç§å˜é‡ç±»å‹çš„å¤§å°    æ•°æ®ç±»å‹ å­—èŠ‚æ•° è¡¨ç¤ºèŒƒå›´     char 1 $-128 \\sim 127 \\ ||\\ 0 \\sim 255$   unsigned char 1 $0 \\sim 255$   signed char 1 $-128 \\sim 127$   int 4 $-2^{31} \\sim 2^{31}-1$   unsigned int 4 $0 \\sim 2^{32} - 1$   signed int 4 $-2^{31} \\sim 2^{31}-1$   short int 2 $-2^{15} \\sim 2^{15}-1$   unsigned short int 2 $0 \\sim 2^{16} - 1$   signed short int 2 $-2^{15} \\sim 2^{15}-1$   long int 8 $-2^{63} \\sim 2^{63} - 1$   unsigned long int 8 $0 \\sim 2^{64} - 1$   signed long int 8 $-2^{63} \\sim 2^{63} - 1$   float 4 $-3.40 \\times 10^{38} \\sim 3.40 \\times 10^{38}$   double 8 $-1.79\\times10^{308} \\sim 1.79 \\times 10^{308}$    æ³¨ï¼šä¸åŒç³»ç»Ÿå¯èƒ½ä¼šæœ‰æ‰€å·®å¼‚ã€‚\næµ®ç‚¹æ•°çš„æ¯”è¾ƒ  åœ¨å­¦ä¹ ã€Šç®—æ³•ç¬”è®°ã€‹ä¸€ä¹¦æ—¶ï¼Œä½œè€…ä»‹ç»äº†â€œæå°æ•°â€ç”¨ä»¥ä¿®æ­£æµ®ç‚¹æ•°åœ¨è®¡ç®—æœºä¸­å­˜å‚¨ä¸è®¡ç®—äº§ç”Ÿçš„è¯¯å·®ã€‚è¿™ä¸€ç‚¹æ˜¯æˆ‘åœ¨ä¹‹å‰å­¦ä¹ ä¸­æ‰€æ²¡æœ‰æ„è¯†åˆ°çš„ï¼Œäºæ˜¯åœ¨æ­¤å½’çº³ä¸€ä¸‹ç›¸å…³çš„å†…å®¹ã€‚\n ç”±äºè®¡ç®—æœºä¸­é‡‡ç”¨æœ‰é™ä½çš„äºŒè¿›åˆ¶ç¼–ç ï¼Œå› æ­¤æµ®ç‚¹æ•°åœ¨è®¡ç®—æœºä¸­çš„å­˜å‚¨å¹¶ä¸æ€»æ˜¯ç²¾ç¡®çš„ã€‚ä¾‹å¦‚åœ¨ç»è¿‡å¤§é‡è¿ç®—åï¼Œä¸€ä¸ªæµ®ç‚¹å‹çš„æ•° 3.14 åœ¨è®¡ç®—æœºä¸­å°±å¯èƒ½å­˜å‚¨æˆ 3.1400000000001ï¼Œä¹Ÿæœ‰å¯èƒ½å­˜å‚¨æˆ 3.1399999999999ï¼Œè¿™ç§æƒ…å†µä¸‹ä¼šå¯¹æ¯”è¾ƒæ“ä½œå¸¦æ¥æå¤§çš„å¹²æ‰°ï¼ˆå› ä¸ºC/C++ä¸­çš„ == æ“ä½œæ˜¯å®Œå…¨ç›¸åŒæ‰èƒ½åˆ¤å®šä¸º trueï¼‰ã€‚äºæ˜¯åœ¨æ–‡ä¸­ï¼Œä½œè€…å¼•å…¥äº†ä¸€ä¸ªæå°æ•° eps æ¥å¯¹è¿™ç§è¯¯å·®è¿›è¡Œä¿®æ­£ã€‚\nç»éªŒè¡¨æ˜ï¼Œeps å– $1e-8$ï¼ˆ$10^{-8}$ï¼‰ åœ¨å¤§å¤šæ•°æƒ…å†µä¸‹æ—¢ä¸ä¼šæ¼åˆ¤ï¼Œä¹Ÿä¸ä¼šè¯¯åˆ¤ã€‚å› æ­¤å¯å°† eps å®šä¹‰ä¸ºå¸¸é‡ $1e-8$ï¼š\nconst double eps = 1e-8; 1. ç­‰äºè¿ç®—ç¬¦ == ä¸‹å›¾ä¸ºç­‰äºåŒºé—´ç¤ºæ„å›¾ï¼š\n å›¾ 1 ç­‰äºåŒºé—´ç¤ºæ„å›¾\n  å¦‚å›¾æ‰€ç¤ºï¼Œå¦‚æœä¸€ä¸ªæ•° a è½åœ¨äº† $[b - eps, b + eps]$ çš„åŒºé—´ä¸­ï¼Œå°±åˆ¤æ–­ a == b æˆç«‹ã€‚ä¸ºäº†ä½¿æ¯”è¾ƒæ›´ä¸ºæ–¹ä¾¿ï¼ŒæŠŠæ¯”è¾ƒæ“ä½œå†™æˆå®å®šä¹‰çš„å½¢å¼ï¼š\n#include \u0026lt;math.h\u0026gt;#define Equ(a, b) ((fabs((a) - (b))) - (eps)) // æ‹¬å·æ˜¯ä¸ºé˜²æ­¢å®å®šä¹‰å¯èƒ½å¸¦æ¥çš„é”™è¯¯ 2. å¤§äºè¿ç®—ç¬¦ \u0026gt; ä¸‹å›¾ä¸ºå¤§äºåŒºé—´ç¤ºæ„å›¾ï¼š\n å›¾ 2 å¤§äºåŒºé—´ç¤ºæ„å›¾\n  å¦‚å›¾æ‰€ç¤ºï¼Œå¦‚æœä¸€ä¸ªæ•° a è¦å¤§äº bï¼Œé‚£ä¹ˆå°±å¿…é¡»åœ¨è¯¯å·® eps æ‰°åŠ¨èŒƒå›´ä¹‹å¤–å¤§äº bï¼Œå› æ­¤åªæœ‰å¤§äº b + eps çš„æ•°æ‰èƒ½åˆ¤å®šä¸ºå¤§äº bï¼ˆä¹Ÿå³ $a - b \u0026gt; eps$ï¼‰ã€‚\n#define More(a, b) (((a) - (b)) \u0026gt; (eps)) 3. å°äºè¿ç®—ç¬¦ \u0026lt; ä¸‹å›¾ä¸ºå°äºåŒºé—´ç¤ºæ„å›¾ï¼š\n å›¾ 3 å°äºåŒºé—´ç¤ºæ„å›¾\n  å¦‚å›¾æ‰€ç¤ºï¼Œå¦‚æœä¸€ä¸ªæ•° a è¦å°äº bï¼Œé‚£ä¹ˆå°±å¿…é¡»åœ¨è¯¯å·® eps æ‰°åŠ¨èŒƒå›´ä¹‹å¤–å°äº bï¼Œå› æ­¤åªæœ‰å°äº b - eps çš„æ•°æ‰èƒ½åˆ¤å®šä¸ºå°äº bï¼ˆä¹Ÿå³ $a - b \u0026lt; -eps$ï¼‰ã€‚\n#define Less(a, b) (((a) - (b)) \u0026lt; (-eps)) 4. å¤§äºç­‰äºè¿ç®—ç¬¦ \u0026gt;= ä¸‹å›¾ä¸ºå¤§äºç­‰äºåŒºé—´ç¤ºæ„å›¾ï¼š\n å›¾ 4 å¤§äºç­‰äºåŒºé—´ç¤ºæ„å›¾\n  å¦‚å›¾æ‰€ç¤ºï¼Œç”±äºå¤§äºç­‰äºè¿ç®—ç¬¦å¯ä»¥ç†è§£ä¸ºå¤§äºè¿ç®—ç¬¦å’Œç­‰äºè¿ç®—ç¬¦çš„ç»“åˆï¼Œäºæ˜¯éœ€è¦è®©ä¸€ä¸ªæ•° a åœ¨è¯¯å·®æ‰°åŠ¨èŒƒå›´å†…å¤§äºæˆ–è€…ç­‰äº bï¼Œå› æ­¤å¤§äº b - eps çš„æ•°éƒ½åº”å½“åˆ¤å®šä¸ºå¤§äºç­‰äº bï¼ˆä¹Ÿå³ $a - b \u0026gt; -eps$ï¼‰ã€‚\n#define MoreEqu(a, b) (((a) - (b)) \u0026gt; (-eps)) 5. å°äºç­‰äºè¿ç®—ç¬¦ \u0026lt;= ä¸‹å›¾ä¸ºå°äºç­‰äºåŒºé—´ç¤ºæ„å›¾ï¼š\n å›¾ 5 å°äºç­‰äºåŒºé—´ç¤ºæ„å›¾\n  å¦‚å›¾æ‰€ç¤ºï¼Œç”±äºå°äºç­‰äºè¿ç®—ç¬¦å¯ä»¥ç†è§£ä¸ºå°äºè¿ç®—ç¬¦å’Œç­‰äºè¿ç®—ç¬¦çš„ç»“åˆï¼Œäºæ˜¯éœ€è¦è®©ä¸€ä¸ªæ•° a åœ¨è¯¯å·®æ‰°åŠ¨èŒƒå›´å†…å°äºæˆ–è€…ç­‰äº bï¼Œå› æ­¤å°äº b + eps çš„æ•°éƒ½åº”å½“åˆ¤å®šä¸ºå°äºç­‰äº bï¼ˆä¹Ÿå³ $a - b \u0026lt; eps$ï¼‰ã€‚\n#define LessEqu(a, b) (((a) - (b)) \u0026lt; (eps)) 6. åœ†å‘¨ç‡ Ï€ åœ†å‘¨ç‡ Ï€ å¯ç”± $arccos(-1)$ è®¡ç®—å¾—åˆ°ï¼š\n#include \u0026lt;math.h\u0026gt;const double PI = acos(-1.0); æ±‡æ€»ç»“æœä¸ºå¦‚ä¸‹ä»£ç ï¼š\n#include \u0026lt;math.h\u0026gt;const double eps = 1e-8; const double PI = acos(-1.0); #define Equ(a, b) ((fabs((a) - (b))) - (eps)) #define More(a, b) (((a) - (b)) \u0026gt; (eps)) #define Less(a, b) (((a) - (b)) \u0026lt; (-eps)) #define MoreEqu(a, b) (((a) - (b)) \u0026gt; (-eps)) #define LessEqu(a, b) (((a) - (b)) \u0026lt; (eps)) è¯»å–â€œå¤§æ•°â€ æœ‰çš„æ—¶å€™ï¼Œæˆ‘éœ€è¦è¯»å…¥ä¸€ä¸ªå¾ˆå¤§çš„æ•´æ•°ï¼ˆä¾‹å¦‚ï¼Œ1234567890987654321123456789ï¼‰ï¼Œå¹¶è®¡ç®—å‡ºå®ƒçš„å„ä½æ•°å­—ä¹‹å’Œã€‚ç”¨ int ($-2^{31} \\sim 2^{31} - 1$) æˆ–è€… long int ($-2^{63} \\sim 2^{63} - 1$) éƒ½ä¸æ»¡è¶³è¦æ±‚ã€‚è¿™æ—¶å¯ä»¥å°†è¿™æ ·ä¸€ä¸ªâ€œå¤§æ•°â€ä½œä¸ºå­—ç¬¦ä¸²ï¼ˆæˆ–æ˜¯å­—ç¬¦æ•°ç»„ï¼‰è¯»å…¥ã€‚\n å­—ç¬¦ä¸²å®é™…ä¸Šæ˜¯ä½¿ç”¨ null å­—ç¬¦ '\\0' ç»ˆæ­¢çš„ä¸€ç»´å­—ç¬¦æ•°ç»„ã€‚å› æ­¤ï¼Œä¸€ä¸ªä»¥ null ç»“å°¾çš„å­—ç¬¦ä¸²ï¼ŒåŒ…å«äº†ç»„æˆå­—ç¬¦ä¸²çš„å­—ç¬¦ã€‚\n æˆ‘ä»¬å¯ä»¥ä½¿ç”¨ getchar() å‡½æ•°ï¼Œå°†è¯¥æ•°å­—çš„æ¯ä¸€ä½ä½œä¸ºå­—ç¬¦è¯»å…¥åˆ°æˆ‘ä»¬çš„å­—ç¬¦ä¸²æ•°ç»„ä¸­ã€‚\n C åº“å‡½æ•° int getchar(void) ä»æ ‡å‡†è¾“å…¥ stdin è·å–ä¸€ä¸ªå­—ç¬¦ï¼ˆä¸€ä¸ªæ— ç¬¦å·å­—ç¬¦ï¼‰ã€‚è¿™ç­‰åŒäº getc å¸¦æœ‰ stdin ä½œä¸ºå‚æ•°ã€‚\n ç”¨ç¨‹åºå¯ä»¥ç®€å•åœ°è¡¨ç¤ºä¸ºï¼š\n#include \u0026lt;stdio.h\u0026gt; int main() { char n[100]; int i = 0; printf(\u0026#34;Input: \u0026#34;); while ((n[i] = getchar()) != \u0026#39;\\n\u0026#39;) { // é€ä½è¯»å…¥æ•°å­—  i++; } printf(\u0026#34;Output: \u0026#34;); for (int k = 0; k \u0026lt; i; k++) { printf(\u0026#34;%c\u0026#34;, n[k]); // é€ä½è¾“å‡ºæ•°å­—  } printf(\u0026#34;\\n\\n\u0026#34;); return 0; } å½“æˆ‘ä»¬è¾“å…¥æ•°å­— 1234567890987654321123456789ï¼Œä¹Ÿä¼šå¾—åˆ°ç›¸åº”çš„è¾“å‡ºï¼š\n å›¾ 6 è¾“å‡ºç»“æœ\n  æ­¤æ—¶ï¼Œå­˜å‚¨å­—ç¬¦çš„æ•°ç»„ n ä¸ºï¼š\n å›¾ 7 å­—ç¬¦æ•°ç»„åœ¨å†…å­˜ä¸­çš„å€¼\n  ","permalink":"https://jifan.tech/posts/2019-02-27-cpp-study-notes-1/","summary":"å†ä¸€æ¬¡åœ°ã€ä»å¤´å¼€å§‹å­¦ä¹ C/C++ã€‚ C++ æ•°æ®ç±»å‹åŠå…¶è¡¨ç¤ºèŒƒå›´ è¿™ä¸€éƒ¨åˆ†æ˜¯åŸºç¡€ï¼Œä¸è¿‡æˆ‘ä¹‹å‰éƒ½æ²¡æœ‰ç³»ç»Ÿæ€§çš„ææ¸…æ¥šï¼Œæ‰€ä»¥ç°åœ¨è¿˜æ˜¯å…ˆæŠŠè¿™äº›çŸ¥è¯†ç‚¹åˆ—å‡ºæ¥ï¼Œè¯¥","title":"C++ å­¦ä¹ ç¬”è®°ï¼šæ•°æ®ç±»å‹ã€æµ®ç‚¹æ•°çš„æ¯”è¾ƒä»¥åŠâ€œå¤§æ•°â€çš„è¯»å–"}]