<!DOCTYPE html>
<html lang="en" dir="auto">

<head><meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="robots" content="index, follow">
<title>JavaScript 学习笔记（二）：对象、对象的属性以及对象的方法 | Jifan&#39;s Blog</title>
<meta name="keywords" content="JavaScript, Course Learning" />
<meta name="description" content="本篇学习笔记是在慕课网上学习JavaScript深入浅出时所做笔记，内容主要来自课程课件及老师讲解，同时穿插自己的一些理解和尝试。部分资料整理自 MDN Web Docs。
 4.1 对象概述 对象中包含一系列属性，这些属性是无序的。每个属性都有一个字符串 key 和对应的 value。
var obj_0 = { x : 1, y : 2 }; obj_0.x;	// 1 obj_0.y;	// 2  var obj = {}; obj[1] = 1; obj[&#39;1&#39;] = 2; obj; // Object {1: 2}  obj[{}] = true; obj[{x: 1}] = true; obj; // Object {1: 2, [object Object]: true} 函数 function、数组 Array 等都是对象。
4.2 创建对象、原型链 1. 字面量
var obj1 = { x : 1, y : 2 }; var obj2 = { x: 1, y: 2, o: {	// 嵌套  z: 3, n: 4 } }; 2.">
<meta name="author" content="Thistledown">
<link rel="canonical" href="https://jifan.tech/posts/2019-01-10-javascript-study-notes-2/" />
<link crossorigin="anonymous" href="/assets/css/stylesheet.min.48a18943c2fc15c38a372b8dde1f5e5dc0bc64fa6cb90f5a817d2f8c76b7f3ae.css" integrity="sha256-SKGJQ8L8FcOKNyuN3h9eXcC8ZPpsuQ9agX0vjHa3864=" rel="preload stylesheet" as="style">
<script defer crossorigin="anonymous" src="/assets/js/highlight.min.4dcb3c4f38462f66c6b6137227726f5543cb934cca9788f041c087e374491df2.js" integrity="sha256-Tcs8TzhGL2bGthNyJ3JvVUPLk0zKl4jwQcCH43RJHfI="
    onload="hljs.initHighlightingOnLoad();"></script>
<link rel="icon" href="https://jifan.tech/favicon.ico">
<link rel="icon" type="image/png" sizes="16x16" href="https://jifan.tech/favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="https://jifan.tech/favicon-32x32.png">
<link rel="apple-touch-icon" href="https://jifan.tech/apple-touch-icon.png">
<link rel="mask-icon" href="https://jifan.tech/safari-pinned-tab.svg">
<meta name="theme-color" content="#2e2e33">
<meta name="msapplication-TileColor" content="#2e2e33">
<noscript>
    <style>
        #theme-toggle,
        .top-link {
            display: none;
        }

    </style>
    <style>
        @media (prefers-color-scheme: dark) {
            :root {
                --theme: rgb(29, 30, 32);
                --entry: rgb(46, 46, 51);
                --primary: rgb(218, 218, 219);
                --secondary: rgb(155, 156, 157);
                --tertiary: rgb(65, 66, 68);
                --content: rgb(196, 196, 197);
                --hljs-bg: rgb(46, 46, 51);
                --code-bg: rgb(55, 56, 62);
                --border: rgb(51, 51, 51);
            }

            .list {
                background: var(--theme);
            }

            .list:not(.dark)::-webkit-scrollbar-track {
                background: 0 0;
            }

            .list:not(.dark)::-webkit-scrollbar-thumb {
                border-color: var(--theme);
            }
        }

    </style>
</noscript><meta property="og:title" content="JavaScript 学习笔记（二）：对象、对象的属性以及对象的方法" />
<meta property="og:description" content="本篇学习笔记是在慕课网上学习JavaScript深入浅出时所做笔记，内容主要来自课程课件及老师讲解，同时穿插自己的一些理解和尝试。部分资料整理自 MDN Web Docs。
 4.1 对象概述 对象中包含一系列属性，这些属性是无序的。每个属性都有一个字符串 key 和对应的 value。
var obj_0 = { x : 1, y : 2 }; obj_0.x;	// 1 obj_0.y;	// 2  var obj = {}; obj[1] = 1; obj[&#39;1&#39;] = 2; obj; // Object {1: 2}  obj[{}] = true; obj[{x: 1}] = true; obj; // Object {1: 2, [object Object]: true} 函数 function、数组 Array 等都是对象。
4.2 创建对象、原型链 1. 字面量
var obj1 = { x : 1, y : 2 }; var obj2 = { x: 1, y: 2, o: {	// 嵌套  z: 3, n: 4 } }; 2." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://jifan.tech/posts/2019-01-10-javascript-study-notes-2/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2019-01-10T00:00:00&#43;00:00" />
<meta property="article:modified_time" content="2019-01-10T00:00:00&#43;00:00" />

<meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="JavaScript 学习笔记（二）：对象、对象的属性以及对象的方法"/>
<meta name="twitter:description" content="本篇学习笔记是在慕课网上学习JavaScript深入浅出时所做笔记，内容主要来自课程课件及老师讲解，同时穿插自己的一些理解和尝试。部分资料整理自 MDN Web Docs。
 4.1 对象概述 对象中包含一系列属性，这些属性是无序的。每个属性都有一个字符串 key 和对应的 value。
var obj_0 = { x : 1, y : 2 }; obj_0.x;	// 1 obj_0.y;	// 2  var obj = {}; obj[1] = 1; obj[&#39;1&#39;] = 2; obj; // Object {1: 2}  obj[{}] = true; obj[{x: 1}] = true; obj; // Object {1: 2, [object Object]: true} 函数 function、数组 Array 等都是对象。
4.2 创建对象、原型链 1. 字面量
var obj1 = { x : 1, y : 2 }; var obj2 = { x: 1, y: 2, o: {	// 嵌套  z: 3, n: 4 } }; 2."/>


<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BreadcrumbList",
  "itemListElement": [, 
    {
      "@type": "ListItem",
      "position":  2 ,
      "name": "Posts",
      "item": "https://jifan.tech/posts/"
    }, 
    {
      "@type": "ListItem",
      "position":  3 ,
      "name": "JavaScript 学习笔记（二）：对象、对象的属性以及对象的方法",
      "item": "https://jifan.tech/posts/2019-01-10-javascript-study-notes-2/"
    }
  ]
}
</script>
<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BlogPosting",
  "headline": "JavaScript 学习笔记（二）：对象、对象的属性以及对象的方法",
  "name": "JavaScript 学习笔记（二）：对象、对象的属性以及对象的方法",
  "description": "本篇学习笔记是在慕课网上学习JavaScript深入浅出时所做笔记，内容主要来自课程课件及老师讲解，同时穿插自己的一些理解和尝试。部分资料整理自 MDN Web Docs。\n 4.1 对象概述 对象中包含一系列属性，这些属性是无序的。每个属性都有一个字符串 key 和对应的 value。\nvar obj_0 = { x : 1, y : 2 }; obj_0.x;\t// 1 obj_0.y;\t// 2  var obj = {}; obj[1] = 1; obj[\u0026#39;1\u0026#39;] = 2; obj; // Object {1: 2}  obj[{}] = true; obj[{x: 1}] = true; obj; // Object {1: 2, [object Object]: true} 函数 function、数组 Array 等都是对象。\n4.2 创建对象、原型链 1. 字面量\nvar obj1 = { x : 1, y : 2 }; var obj2 = { x: 1, y: 2, o: {\t// 嵌套  z: 3, n: 4 } }; 2.",
  "keywords": [
    "JavaScript", "Course Learning"
  ],
  "articleBody": " 本篇学习笔记是在慕课网上学习JavaScript深入浅出时所做笔记，内容主要来自课程课件及老师讲解，同时穿插自己的一些理解和尝试。部分资料整理自 MDN Web Docs。\n 4.1 对象概述 对象中包含一系列属性，这些属性是无序的。每个属性都有一个字符串 key 和对应的 value。\nvar obj_0 = { x : 1, y : 2 }; obj_0.x;\t// 1 obj_0.y;\t// 2  var obj = {}; obj[1] = 1; obj['1'] = 2; obj; // Object {1: 2}  obj[{}] = true; obj[{x: 1}] = true; obj; // Object {1: 2, [object Object]: true} 函数 function、数组 Array 等都是对象。\n4.2 创建对象、原型链 1. 字面量\nvar obj1 = { x : 1, y : 2 }; var obj2 = { x: 1, y: 2, o: {\t// 嵌套  z: 3, n: 4 } }; 2. new / 原型链\nfunction foo() {}; foo.prototype.z = 3; var obj = new foo(); obj.x = 1; obj.y = 2; 原型链：\nobj.x;\t// 1 obj.y;\t// 2 obj.z;\t// 3 (通过原型链向上查找，有属性'z') typeof obj.toString;\t// 'function' (toString 在 Object.prototype 上) 'z' in obj;\t// true (z 是 obj 从 foo 中继承过来的) obj.hasOwnProperty('z');\t// false (z 并不在对象中，而是在对象的原型链上) 如果赋值：\nobj.z = 5; 原型链：\nobj.hasOwnProperty('z');\t// true foo.prototype.z;\t// (still) 3 obj.z;\t// 5  delete obj.z;\t// true (在对象 obj 中删除属性 z) obj.z;\t// 3  delete obj.z;\t// true (再次删除) obj.z;\t// still 3 (原型链上的属性不会被修改！) 3. Object.create\nObject.create() 是一个系统内置的函数，这个函数会接受一个参数（一般是一个对象），它会返回一个新创建的对象，并让这个对象的原型，指向这个参数。\nvar obj = Object.create({ x : 1 }); obj.x;\t// 1 typeof obj.toString;\t// function obj.hasOwnProperty('x')\t// false var obj = Object.create(null); obj.toString;\t// undefined 4.3 属性操作 4.3.1 属性读写 var obj = { x : 1, y : 2 }; // 访问对象属性 obj.x;\t// 1 obj['y'];\t// 2 // obj['x'] = 3; obj.y = 4; 属性读写 - 遍历：\nvar obj = { x1: 1, x2 : 2, x3 : 3 }; var i = 1, n = 3; for (; i  n; i++) { console.log(obj['x' + i]);\t// 输出 1, 2, 3 } var p; for (p in obj) {\t// 用 for … in 方法可能会把原型链上的一些属性遍历出来  console.log(p);\t// 输出 x1, x2, x3（顺序不确定）  console.log(obj[p]);\t// 输出 1, 2, 3（顺序不确定) } 属性读写 - 异常：\nvar obj = { x : 1 }; obj.y;\t// undefined var yz = obj.y.z;\t// TypeError: Cannot read property 'z' of undefined obj.y.z = 2;\t// TypeError: Cannot set property 'z' of undefined  // 读取时的判断 var yz; if (obj.y) { yz = obj.y.z; } // or var yz = obj \u0026\u0026 obj.y \u0026\u0026 obj.y.z; 4.3.2 属性删除 var person = { age: 28, title: 'fe' }; delete person.age;\t// true delete person['title'];\t// true person.age;\t// undefined delete person.age;\t// true （重复删除）  delete Object.prototype;\t// false （不允许删除） var descriptor = Object.getOwnPropertyDescriptor(Object, 'prototype');\t// 获取对象的一个属性中的所有标签 descriptor.configurable;\t// false 4.3.3 属性检测 var cat = new Object; cat.legs = 4; cat.name = 'Kitty'; 'legs' in cat;\t// true 'abc' in cat;\t// false 'toString' in cat;\t// true (inherited property!)(in 操作符会在原型链中向上查找)  cat.hasOwnProperty('legs');\t// true cat.hasOwnProperty('toString');\t// false (该对象上没有该属性，尽管原型链上有)  cat.propertyIsEnumerable('legs');\t// true (判断该属性是否可枚举) cat.propertyIsEnumerable('toString');\t// false  // 自定义对象属性 Object.defineProperty(cat, 'price', {enumerable: false, value: 1000}); cat.propertyIsEnumerable('price');\t// false cat.hasOwnProperty('price');\t// true  if (cat \u0026\u0026 cat.legs) { // cat 存在，cat.legs 存在  cat.legs *= 2; } if (cat.legs != undefined) { // !== undefined, or, !== null } if (cat.legs !== undefined) { // only if cat.legs is not undefined } 4.3.4 属性枚举 var o = { x: 1, y: 2, z: 3 }; 'toString' in o;\t// true o.propertyIsEnumerable('toString');\t// false（默认 false） var key; for (key in o) {\t// 枚举 o 中（enumerable / 可枚举的）属性  console.log(key);\t// x, y, z （不会出现 toString 等属性） } var obj = Object.create(o); obj.a = 4; var key; for (key in obj) { console.log(key);\t// a, x, y, z } var obj = Object.create(o); obj.a = 4; var key; for (key in obj) { if (obj.hasOwnProperty(key)) {\t// 过滤掉原型链上的属性  console.log(key);\t// a  } } 4.4 get / set 方法 另一种读写属性的方式\nvar man = { name: 'Bosn',\t// 课程老师的名字 :)  weibo: '@Bosn', get age() {\t// get 方法  return new Date().getFullYear() - 1988; }, set age(val) {\t// set方法  console.log('Age can\\'t be set to ' + val); } } console.log(man.age);\t// 31（访问 man.age 时，自动调用 get 方法） man.age = 100;\t// Age cat't be set to 100（为 man.age 赋值时，自动调用 set 方法） console.log(man.age);\t// still 31（调用 get 方法） 更复杂的例子：\nvar man = { weibo: '@Bosn', $age: null,\t// $age 与 age 是不同的，这里的 $ 符号表示不在外部暴露这个属性*  get age() { if (this.$age == undefined) { return new Date().getFullYear() - 1988; } else { return this.$age; } }, set age(val) { val = +val;\t// 一元 + 操作符，用以将 val 转化为数字  // 例如：+123 = 123, +'123' = 123, +'abc' = NaN  if (!isNaN(val) \u0026\u0026 val  0 \u0026\u0026 val  150) { this.$age = +val; } else { throw new Error('Incorrect val = ' + val); } } } console.log(man.age);\t// 31 man.age = 100; console.log(man.age);\t// 100 man.age = 'abc';\t// error: Incorrect val = NaN get / set 与原型链\nfunction foo() {} Object.defineProperty(foo.prototype, 'z', { get: function() { return 1; } }); var obj = new foo(); obj.z;\t// 1 obj.z;\t// 10 obj.z;\t// still 1 这是因为当 obj 对象上没有该属性，并且在原型链上查找时发现有对应的 get 或 set 方法时，尝试对该属性赋值就会调用原型链上的 get / set 方法，而不会再去给当前对象添加新属性。如果需要给 obj 对象添加这样一个属性并实现修改，可以使用以下方法：\nObject.defineProperty(obj, 'z', { value: 100, configurable: true\t// 默认为 false }); obj.z;\t// 100 delete obj.z;\t// true obj.z;\t// back to 1 var o = {}; Object.defineProperty(o, 'x', { value: 1 });\t// writable = false, configurable = false; var obj = Object.create(o); obj.x;\t// 1 obj.x = 200; obj.x;\t// still 1, can't change it  Object.defineProperty(obj, 'x', { writable: true, configurable: true, value: 100 }); obj.x;\t// 100 obj.x = 500; obj.x;\t// 500 4.5 属性标签  属性标签即指属性描述符\n 4.5.1 获取属性标签 Object.getOwnPropertyDescriptor(obj, prop)\n  该方法返回指定对象上一个自有属性对应的属性描述符\n（自有属性指的是直接赋予该对象的属性，不需要从原型链上进行查找的属性）\n  参数：\n obj：需要查找的目标对象 prop：目标对象内属性名称 （String 类型）    返回值：\n 如果指定的属性存在于对象上，则返回其属性描述符对象（property descriptor），否则返回 undefined    一个属性描述符是一个记录，由下面属性当中的某些组成：\n value：该属性的值（仅针对数据属性描述有效） writable：当且仅当属性的值可以改变时为 true（仅针对数据属性描述有效） get：获取该属性的访问器函数（getter），如果没有访问器，该值为 undefined（仅针对包含访问器或设置器的属性描述有效） set：获取该属性的设置器函数（setter），如果没有设置器，该值为 undefined（仅针对包含访问器或设置器的属性描述有效） configurable：当且仅当指定对象的属性描述可以被改变或者属性可被删除时，为 true enumerable：当且仅当指定对象的属性可以被枚举出时，为 true    示例：\nObject.getOwnPropertyDescriptor({pro: true}, 'pro'); // Object {value: true, writable: true, enumerable: true, configurable: true} Object.getOwnPropertyDescriptor({pro: true}, 'pro'); // undefined 4.5.2 设置属性标签 Object.defineProperty(obj, prop, descriptor)\n 该方法会直接在一个对象上定义一个新属性，或者修改一个对象的现有属性， 并返回这个对象。 参数：  obj：要在其上定义属性的对象 prop：要定义或修改的属性的名次（String 类型） descriptor：将被定义或修改的属性描述符   返回值：被传递给函数的对象 该方法允许精确添加或修改对象的属性。通过赋值操作添加的普通属性是可枚举的，能够在属性枚举期间呈现出来（for...in 或 Object.keys 方法）， 这些属性的值可以被改变，也可以被删除。这个方法允许修改默认的额外选项（或配置）。**注意：**默认情况下，使用 Object.defineProperty() 添加的属性值是不可修改的。  示例 1：\nvar person = {}; Object.defineProperty(person, 'name', { configurable: false, writable: false, enumerable: true, value: 'Bosn Ma' }); person.name;\t// Bosn Ma person.name = 1; person.name;\t// still Bosn Ma delete person.name;\t//false  Object.defineProperty(person, 'type', { configurable: true, writable: true, enumerable: false, value: 'Object' }); Object.keys(person);\t// [\"name\"] (因为，name 可枚举，type 不可枚举) 示例 2：\nObject.defineProperties(person, {\t// 类似于 Object.defineProperty()，可以同时定义多个属性  title: {value: 'fe', enumerable: true},\t// 未声明的属性标签默认都为 false  corp: {value: 'BABA', enumerable: true}, salary: {value: 50000, enumerable: true, writable: true} }); Object.getOwnPropertyDescriptor(person, 'salary'); // Object {value: 50000, writable: true, enumerable: true, configurable: false} Object.getOwnPropertyDescriptor(person, 'corp'); // Object {value: \"BABA\", writable: false, enumerable: true, configurable: false} 示例 3：\nObject.defineProperties(person, {\t// 更加复杂化  title: {value: 'fe', enumerable: true},\tcorp: {value: 'BABA', enumerable: true}, salary: {value: 50000, enumerable: true, writable: true}, luck: { get: function() { return Math.random()  0.5 ? 'good' : 'bad'; } }, promote: { set: function(level) { this.salary *= 1 + level * 0.1; } } }); Object.getOwnPropertyDescriptor(person, 'salary'); // Object {value: 50000, writable: true, enumerable: true, configurable: false} Object.getOwnPropertyDescriptor(person, 'corp'); // Object {value: \"BABA\", writable: false, enumerable: true, configurable: false} person.salary;\t// 50000 person.promote = 2; person.salary;\t// 60000 4.5.3 configurable 与 writalbe 的限制 4.6 对象标签、对象序列化 4.6.1 对象标签 1. 原型标签 __proto__\n Object.prototype 的 __proto__ 属性是一个访问器属性（一个 getter 函数和一个 setter 函数）， 暴露了通过它访问的对象的内部 [[Prototype]] (一个对象或 null)，任何一个 __proto__ 的存取属性都继承于Object.prototype。 使用 __proto__ 是有争议的，也不鼓励使用它。因为它从来没有被包括在 EcmaScript 语言规范中，但是现代浏览器都实现了它。  2. class 标签\n 表示对象的类型 没有直接查看或修改的方式，可以间接通过 Object.prototype.toString 的方式去获取  var toString = Object.prototype.toString;\t// 用以获取每个对象的类型 function getType(o) {return toString.call(o).slice(8, -1);} toString.call(null);\t// \"[object Null]\" getType(null);\t// \"Null\" getType(undefined);\t// \"Number\" getType(new Number(1));\t// \"Number\" typeof new Number(1);\t// \"object\" getType(true);\t// \"Boolean\" getType(new Boolean(true));\t// \"Boolean\" typeof new Number(true);\t// \"object\" 3. extensible 标签\nObject.isExtensible() 方法判断一个对象是否是可扩展的（是否可以在它上面添加新的属性）\n 参数：  obj：需要检测的队形   返回值：表示给定对象是否可扩展的一个 Boolean 默认情况下，对象是可扩展的：即可以为他们添加新的属性。以及它们的 __proto__ 属性可以被更改。Object.preventExtensions，Object.seal 或 Object.freeze 方法都可以标记一个对象为不可扩展（non-extensible）。  Object.seal()方法封闭一个对象，阻止添加新属性并将所有现有属性标记为不可配置。当前属性的值只要可写就可以改变。\n  参数：\n obj：将要被密封的对象    返回值：被密封的对象\n  尝试删除一个密封对象的属性或者将某个密封对象的属性从数据属性转换成访问器属性，结果会静默失败或抛出TypeError（在 严格模式 中最常见的，但不唯一）。\n不会影响从原型链上继承的属性。但 __proto__ 属性的值也会不能修改。\n  Object.freeze() 方法可以冻结一个对象，冻结指的是不能向这个对象添加新的属性，不能修改其已有属性的值，不能删除已有属性，以及不能修改该对象已有属性的可枚举性、可配置性、可写性。\n  参数：\n obj：要被冻结的对象    返回值：被冻结的对象（而不是创建一个被冻结的副本）\n  被冻结对象自身的所有属性都不可能以任何方式被修改。任何修改尝试都会失败，无论是静默地还是通过抛出TypeError异常（最常见但不仅限于 严格模式）。\n数据属性的值不可更改，访问器属性（有getter和setter）也同样（但由于是函数调用，给人的错觉是还是可以修改这个属性）。如果一个属性的值是个对象，则这个对象中的属性是可以修改的，除非它也是个冻结对象。数组作为一种对象，被冻结，其元素不能被修改。没有数组元素可以被添加或移除。\n  var obj = {x: 1, y: 2}; Object.isExtensible(obj);\t// true Object.preventExtensions(obj); Object.isExtensible(obj);\t// false obj.z = 1; obj.z;\t// undefined (add new property failed) Object.getOwnPropertyDescriptor(obj, 'x'); // Object {value: 1, writable: true, enumerable: true, configurable: true} // 原有属性仍然是可以修改、删除的  Object.seal(obj); Object.getOwnPropertyDescriptor(obj, 'x'); // Object {value: 1, writable: true, enumerable: true, configurable: false} Object.isSealed(obj);\t// true  Object.freeze(obj); Object.getOwnPropertyDescriptor(obj, 'x'); // Object {value: 1, writable: false, enumerable: true, configurable: false} Object.isFrozen(obj);\t// true  // [CAUTION] Do not affects prototype chain! 4.6.2 序列化、其他对象方法 1. 序列化\nJSON.stringify() 方法是将一个 JavaScript 值（对象或者数组）转换为一个 JSON 字符串，如果指定了 replacer 是一个函数，则可以替换值，或者如果指定了 replacer 是一个数组，可选的仅包括指定的属性。\nJSON.stringify(value[, replacer[, space]])  参数：  value：将要序列化成一个 JSON 字符串的值 replacer 可选：如果该参数是一个函数，则在序列化过程中，被序列化的值的每个属性都会经过该函数的转换和处理；如果该参数是一个数组，则只有包含在这个数组中的属性名才会被序列化到最终的 JSON 字符串中；如果该参数为null或者未提供，则对象所有的属性都会被序列化；关于该参数更详细的解释和示例，请参考使用原生的 JSON 对象一文。 space 可选：指定缩进用的空白字符串，用于美化输出（pretty-print）；如果参数是一个数字，它代表有多少的空格；上限为 10。该值若小于 1，则意味着没有空格；如果该参数为字符串（字符串的前十个字母），该字符串将被作为空格；如果该参数没有提供（或者为 null）将没有空格。   返回值：一个表示给定值的 JSON 字符串 关于序列化，下面有五点注意事项：  非数组对象的属性不能保证以特定的顺序出现在序列化后的字符串中 布尔值、数字、字符串的包装对象在序列化过程中会自动转换为对应的原始值 undefined、任意的函数以及 symbol 值，在序列化中会被忽略（出现在非数组对象的属性值中）或者被转换成 null （出现在数组中时） 所有以 symbol 值为属性键的属性都会被完全忽略掉，即使 replacer 参数中强制指定包含了它们 不可枚举的属性会被忽略    JSON.parse() 方法用来解析JSON字符串，构造由字符串描述的JavaScript值或对象。提供可选的 reviver 函数用以在返回之前对所得到的对象执行变换（操作）。\nJSON.parse(text[, reviver])  参数：  text：将要被解析成 JavaScript 值的字符串，关于 JSON 的语法格式，请参考：JSON。 reviver 可选：转换器，如果传入该参数（函数），可以用来修改解析生成的原始值，调用时机在 parser 函数返回之前   返回值：Object 类型，对应给定的 JSON 文本的对象 / 值 异常：若传入的字符串不符合 JSON 规范，则会抛出 SyntaxError 异常  var obj = {x: 1, y: true, z: [1, 2, 3], nullVal: null}; JSON.stringify(obj);\t// \"{\"x\": 1, \"y\": true, \"z\": [1, 2, 3], \"nullVal\": null}\"  obj = {val: undefined, a: NaN, b: Infinity, c: new Date()}; JSON.stringify(obj);\t// \"{\"a\": null, \"b\": null, \"c\": \"2019-01-09T14:15:43.910Z\"}\"  obj = JSON.parse('{\"x\": 1}'); obj.x;\t// 1 2. 序列化 - 自定义\nvar obj = { x: 1, y: 2, o: { o1: 1, o2: 2, toJSON: function() { return this.o1 + this.o2; } } }; JSON.stringify(obj);\t// \"{\"x\": 1, \"y\": 2, \"o\": 3}\" 3. 其他对象方法\nvar obj = {x: 1, y: 2}; obj.toString();\t// \"[object Object]\" obj.toString = function() {return this.x + this.y;};\t// 自定义 toString  'Result ' + obj;\t// \"Result 3\", by toString +obj;\t// 3, from toString  obj.valueOf = function() {return this.x + this.y + 100;};\t// 自定义 valueOf +obj;\t// 103, from valueOf 'Result ' + obj;\t// still \"Result 103\" 无论一元操作符 + 还是作为字符串拼接的二元操作符 +，在具体操作时都会尝试把对象转换为基本类型。它会先去找 valueOf ，如果其返回基本类型，则会以该值作为结果繁殖，当 valueOf 不存在或返回对象时，就会去找 toString。若二者都没存在或都返回对象，则会报错。\n",
  "wordCount" : "1575",
  "inLanguage": "en",
  "datePublished": "2019-01-10T00:00:00Z",
  "dateModified": "2019-01-10T00:00:00Z",
  "author":{
    "@type": "Person",
    "name": "Thistledown"
  },
  "mainEntityOfPage": {
    "@type": "WebPage",
    "@id": "https://jifan.tech/posts/2019-01-10-javascript-study-notes-2/"
  },
  "publisher": {
    "@type": "Organization",
    "name": "Jifan's Blog",
    "logo": {
      "@type": "ImageObject",
      "url": "https://jifan.tech/favicon.ico"
    }
  }
}
</script>
</head>

<body class="" id="top">
<script>
    if (localStorage.getItem("pref-theme") === "dark") {
        document.body.classList.add('dark');
    } else if (localStorage.getItem("pref-theme") === "light") {
        document.body.classList.remove('dark')
    } else if (window.matchMedia('(prefers-color-scheme: dark)').matches) {
        document.body.classList.add('dark');
    }

</script>

<header class="header">
    <nav class="nav">
        <div class="logo">
            <a href="https://jifan.tech" accesskey="h" title="Jifan&#39;s Blog (Alt + H)">Jifan&#39;s Blog</a>
            <span class="logo-switches">
                <button id="theme-toggle" accesskey="t" title="(Alt + T)">
                    <svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"
                        fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                        stroke-linejoin="round">
                        <path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"></path>
                    </svg>
                    <svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"
                        fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                        stroke-linejoin="round">
                        <circle cx="12" cy="12" r="5"></circle>
                        <line x1="12" y1="1" x2="12" y2="3"></line>
                        <line x1="12" y1="21" x2="12" y2="23"></line>
                        <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
                        <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
                        <line x1="1" y1="12" x2="3" y2="12"></line>
                        <line x1="21" y1="12" x2="23" y2="12"></line>
                        <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
                        <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
                    </svg>
                </button>
            </span>
        </div>
        <ul id="menu">
            <li>
                <a href="https://jifan.tech/archives/" title="Posts">
                    <span>Posts</span>
                </a>
            </li>
            <li>
                <a href="https://jifan.tech/projects/" title="Projects">
                    <span>Projects</span>
                </a>
            </li>
            <li>
                <a href="https://jifan.tech/search/" title="Search (Alt &#43; /)" accesskey=/>
                    <span>Search</span>
                </a>
            </li>
        </ul>
    </nav>
</header>
<main class="main">

<article class="post-single">
  <header class="post-header">
    
    <h1 class="post-title">
      JavaScript 学习笔记（二）：对象、对象的属性以及对象的方法
    </h1>
    <div class="post-meta"><span title='2019-01-10 00:00:00 +0000 UTC'>January 10, 2019</span>&nbsp;·&nbsp;Thistledown

</div>
  </header> <div class="toc">
    <details >
        <summary accesskey="c" title="(Alt + C)">
            <span class="details">Table of Contents</span>
        </summary>

        <div class="inner"><ul>
                <li>
                    <a href="#41-%e5%af%b9%e8%b1%a1%e6%a6%82%e8%bf%b0" aria-label="4.1 对象概述">4.1 对象概述</a></li>
                <li>
                    <a href="#42-%e5%88%9b%e5%bb%ba%e5%af%b9%e8%b1%a1%e5%8e%9f%e5%9e%8b%e9%93%be" aria-label="4.2 创建对象、原型链">4.2 创建对象、原型链</a></li>
                <li>
                    <a href="#43-%e5%b1%9e%e6%80%a7%e6%93%8d%e4%bd%9c" aria-label="4.3 属性操作">4.3 属性操作</a><ul>
                        <ul>
                        
                <li>
                    <a href="#431-%e5%b1%9e%e6%80%a7%e8%af%bb%e5%86%99" aria-label="4.3.1 属性读写">4.3.1 属性读写</a></li>
                <li>
                    <a href="#432-%e5%b1%9e%e6%80%a7%e5%88%a0%e9%99%a4" aria-label="4.3.2 属性删除">4.3.2 属性删除</a></li>
                <li>
                    <a href="#433-%e5%b1%9e%e6%80%a7%e6%a3%80%e6%b5%8b" aria-label="4.3.3 属性检测">4.3.3 属性检测</a></li>
                <li>
                    <a href="#434-%e5%b1%9e%e6%80%a7%e6%9e%9a%e4%b8%be" aria-label="4.3.4 属性枚举">4.3.4 属性枚举</a></li></ul>
                    </ul>
                </li>
                <li>
                    <a href="#44-get--set-%e6%96%b9%e6%b3%95" aria-label="4.4 get / set 方法">4.4 <code>get</code> / <code>set</code> 方法</a></li>
                <li>
                    <a href="#45-%e5%b1%9e%e6%80%a7%e6%a0%87%e7%ad%be" aria-label="4.5 属性标签">4.5 属性标签</a><ul>
                        <ul>
                        
                <li>
                    <a href="#451-%e8%8e%b7%e5%8f%96%e5%b1%9e%e6%80%a7%e6%a0%87%e7%ad%be" aria-label="4.5.1 获取属性标签">4.5.1 获取属性标签</a></li>
                <li>
                    <a href="#452-%e8%ae%be%e7%bd%ae%e5%b1%9e%e6%80%a7%e6%a0%87%e7%ad%be" aria-label="4.5.2 设置属性标签">4.5.2 设置属性标签</a></li>
                <li>
                    <a href="#453-configurable-%e4%b8%8e-writalbe-%e7%9a%84%e9%99%90%e5%88%b6" aria-label="4.5.3 configurable 与 writalbe 的限制">4.5.3 <code>configurable</code> 与 <code>writalbe</code> 的限制</a></li></ul>
                    </ul>
                </li>
                <li>
                    <a href="#46-%e5%af%b9%e8%b1%a1%e6%a0%87%e7%ad%be%e5%af%b9%e8%b1%a1%e5%ba%8f%e5%88%97%e5%8c%96" aria-label="4.6 对象标签、对象序列化">4.6 对象标签、对象序列化</a><ul>
                        <ul>
                        
                <li>
                    <a href="#461-%e5%af%b9%e8%b1%a1%e6%a0%87%e7%ad%be" aria-label="4.6.1 对象标签">4.6.1 对象标签</a></li>
                <li>
                    <a href="#462-%e5%ba%8f%e5%88%97%e5%8c%96%e5%85%b6%e4%bb%96%e5%af%b9%e8%b1%a1%e6%96%b9%e6%b3%95" aria-label="4.6.2 序列化、其他对象方法">4.6.2 序列化、其他对象方法</a>
                </li>
            </ul>
            </ul>
            </li>
            </ul>
        </div>
    </details>
</div>

  <div class="post-content"><blockquote>
<p>本篇学习笔记是在<a href="https://www.imooc.com/">慕课网</a>上学习<a href="https://www.imooc.com/learn/277">JavaScript深入浅出</a>时所做笔记，内容主要来自课程课件及老师讲解，同时穿插自己的一些理解和尝试。部分资料整理自 <a href="https://developer.mozilla.org/">MDN Web Docs</a>。</p>
</blockquote>
<h2 id="41-对象概述">4.1 对象概述<a hidden class="anchor" aria-hidden="true" href="#41-对象概述">#</a></h2>
<p>对象中包含一系列属性，这些属性是<strong>无序</strong>的。每个属性都有一个<strong>字符串</strong> <code>key</code> 和对应的 <code>value</code>。</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-javascript" data-lang="javascript"><span class="line"><span class="cl"><span class="kd">var</span> <span class="nx">obj_0</span> <span class="o">=</span> <span class="p">{</span> <span class="nx">x</span> <span class="o">:</span> <span class="mi">1</span><span class="p">,</span> <span class="nx">y</span> <span class="o">:</span> <span class="mi">2</span> <span class="p">};</span>
</span></span><span class="line"><span class="cl"><span class="nx">obj_0</span><span class="p">.</span><span class="nx">x</span><span class="p">;</span>	<span class="c1">// 1
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nx">obj_0</span><span class="p">.</span><span class="nx">y</span><span class="p">;</span>	<span class="c1">// 2
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>
</span></span><span class="line"><span class="cl"><span class="kd">var</span> <span class="nx">obj</span> <span class="o">=</span> <span class="p">{};</span>
</span></span><span class="line"><span class="cl"><span class="nx">obj</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="nx">obj</span><span class="p">[</span><span class="s1">&#39;1&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">2</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="nx">obj</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="c1">// Object {1: 2}
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>
</span></span><span class="line"><span class="cl"><span class="nx">obj</span><span class="p">[{}]</span> <span class="o">=</span> <span class="kc">true</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="nx">obj</span><span class="p">[{</span><span class="nx">x</span><span class="o">:</span> <span class="mi">1</span><span class="p">}]</span> <span class="o">=</span> <span class="kc">true</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="nx">obj</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="c1">// Object {1: 2, [object Object]: true}
</span></span></span></code></pre></div><p>函数 <code>function</code>、数组 <code>Array</code> 等都是对象。</p>
<h2 id="42-创建对象原型链">4.2 创建对象、原型链<a hidden class="anchor" aria-hidden="true" href="#42-创建对象原型链">#</a></h2>
<p><strong>1. 字面量</strong></p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-javascript" data-lang="javascript"><span class="line"><span class="cl"><span class="kd">var</span> <span class="nx">obj1</span> <span class="o">=</span> <span class="p">{</span> <span class="nx">x</span> <span class="o">:</span> <span class="mi">1</span><span class="p">,</span> <span class="nx">y</span> <span class="o">:</span> <span class="mi">2</span> <span class="p">};</span>
</span></span><span class="line"><span class="cl"><span class="kd">var</span> <span class="nx">obj2</span> <span class="o">=</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nx">x</span><span class="o">:</span> <span class="mi">1</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="nx">y</span><span class="o">:</span> <span class="mi">2</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="nx">o</span><span class="o">:</span> <span class="p">{</span>	<span class="c1">// 嵌套
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>        <span class="nx">z</span><span class="o">:</span> <span class="mi">3</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="nx">n</span><span class="o">:</span> <span class="mi">4</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">};</span>
</span></span></code></pre></div><p><strong>2. <code>new</code> / 原型链</strong></p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-javascript" data-lang="javascript"><span class="line"><span class="cl"><span class="kd">function</span> <span class="nx">foo</span><span class="p">()</span> <span class="p">{};</span>
</span></span><span class="line"><span class="cl"><span class="nx">foo</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">z</span> <span class="o">=</span> <span class="mi">3</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kd">var</span> <span class="nx">obj</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">foo</span><span class="p">();</span>
</span></span><span class="line"><span class="cl"><span class="nx">obj</span><span class="p">.</span><span class="nx">x</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="nx">obj</span><span class="p">.</span><span class="nx">y</span> <span class="o">=</span> <span class="mi">2</span><span class="p">;</span>
</span></span></code></pre></div><p>原型链：</p>
<p><img loading="lazy" src="https://ws1.sinaimg.cn/large/006y42ybgy1fz08hx4v69j309p0c0jt5.jpg" alt=""  />
</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-javascript" data-lang="javascript"><span class="line"><span class="cl"><span class="nx">obj</span><span class="p">.</span><span class="nx">x</span><span class="p">;</span>	<span class="c1">// 1
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nx">obj</span><span class="p">.</span><span class="nx">y</span><span class="p">;</span>	<span class="c1">// 2
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nx">obj</span><span class="p">.</span><span class="nx">z</span><span class="p">;</span>	<span class="c1">// 3 (通过原型链向上查找，有属性&#39;z&#39;)
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="k">typeof</span> <span class="nx">obj</span><span class="p">.</span><span class="nx">toString</span><span class="p">;</span>	<span class="c1">// &#39;function&#39; (toString 在 Object.prototype 上)
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="s1">&#39;z&#39;</span> <span class="k">in</span> <span class="nx">obj</span><span class="p">;</span>	<span class="c1">// true (z 是 obj 从 foo 中继承过来的)
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nx">obj</span><span class="p">.</span><span class="nx">hasOwnProperty</span><span class="p">(</span><span class="s1">&#39;z&#39;</span><span class="p">);</span>	<span class="c1">// false (z 并不在对象中，而是在对象的原型链上)
</span></span></span></code></pre></div><p>如果赋值：</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-javascript" data-lang="javascript"><span class="line"><span class="cl"><span class="nx">obj</span><span class="p">.</span><span class="nx">z</span> <span class="o">=</span> <span class="mi">5</span><span class="p">;</span>
</span></span></code></pre></div><p>原型链：</p>
<p><img loading="lazy" src="https://ws1.sinaimg.cn/large/006y42ybgy1fz08oezgmej309q0d70uu.jpg" alt=""  />
</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-javascript" data-lang="javascript"><span class="line"><span class="cl"><span class="nx">obj</span><span class="p">.</span><span class="nx">hasOwnProperty</span><span class="p">(</span><span class="s1">&#39;z&#39;</span><span class="p">);</span>	<span class="c1">// true
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nx">foo</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">z</span><span class="p">;</span>	<span class="c1">// (still) 3
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nx">obj</span><span class="p">.</span><span class="nx">z</span><span class="p">;</span>	<span class="c1">// 5
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>
</span></span><span class="line"><span class="cl"><span class="k">delete</span> <span class="nx">obj</span><span class="p">.</span><span class="nx">z</span><span class="p">;</span>	<span class="c1">// true (在对象 obj 中删除属性 z)
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nx">obj</span><span class="p">.</span><span class="nx">z</span><span class="p">;</span>	<span class="c1">// 3
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>
</span></span><span class="line"><span class="cl"><span class="k">delete</span> <span class="nx">obj</span><span class="p">.</span><span class="nx">z</span><span class="p">;</span>	<span class="c1">// true (再次删除)
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nx">obj</span><span class="p">.</span><span class="nx">z</span><span class="p">;</span>	<span class="c1">// still 3 (原型链上的属性不会被修改！)
</span></span></span></code></pre></div><p><strong>3. <code>Object.create</code></strong></p>
<p><code>Object.create()</code> 是一个系统内置的函数，这个函数会接受一个参数（一般是一个对象），它会返回一个新创建的对象，并让这个对象的原型，指向这个参数。</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-javascript" data-lang="javascript"><span class="line"><span class="cl"><span class="kd">var</span> <span class="nx">obj</span> <span class="o">=</span> <span class="nb">Object</span><span class="p">.</span><span class="nx">create</span><span class="p">({</span> <span class="nx">x</span> <span class="o">:</span> <span class="mi">1</span> <span class="p">});</span>
</span></span><span class="line"><span class="cl"><span class="nx">obj</span><span class="p">.</span><span class="nx">x</span><span class="p">;</span>	<span class="c1">// 1
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="k">typeof</span> <span class="nx">obj</span><span class="p">.</span><span class="nx">toString</span><span class="p">;</span>	<span class="c1">// function
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nx">obj</span><span class="p">.</span><span class="nx">hasOwnProperty</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">)</span>	<span class="c1">// false
</span></span></span></code></pre></div><p><img loading="lazy" src="https://ws1.sinaimg.cn/large/006y42ybgy1fz093tjkqkj30a603edga.jpg" alt=""  />
</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-javascript" data-lang="javascript"><span class="line"><span class="cl"><span class="kd">var</span> <span class="nx">obj</span> <span class="o">=</span> <span class="nb">Object</span><span class="p">.</span><span class="nx">create</span><span class="p">(</span><span class="kc">null</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="nx">obj</span><span class="p">.</span><span class="nx">toString</span><span class="p">;</span>	<span class="c1">// undefined
</span></span></span></code></pre></div><h2 id="43-属性操作">4.3 属性操作<a hidden class="anchor" aria-hidden="true" href="#43-属性操作">#</a></h2>
<h4 id="431-属性读写">4.3.1 属性读写<a hidden class="anchor" aria-hidden="true" href="#431-属性读写">#</a></h4>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-javascript" data-lang="javascript"><span class="line"><span class="cl"><span class="kd">var</span> <span class="nx">obj</span> <span class="o">=</span> <span class="p">{</span> <span class="nx">x</span> <span class="o">:</span> <span class="mi">1</span><span class="p">,</span> <span class="nx">y</span> <span class="o">:</span> <span class="mi">2</span> <span class="p">};</span>
</span></span><span class="line"><span class="cl"><span class="c1">// 访问对象属性
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nx">obj</span><span class="p">.</span><span class="nx">x</span><span class="p">;</span>	<span class="c1">// 1
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nx">obj</span><span class="p">[</span><span class="s1">&#39;y&#39;</span><span class="p">];</span>	<span class="c1">// 2
</span></span></span><span class="line"><span class="cl"><span class="c1">// 
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nx">obj</span><span class="p">[</span><span class="s1">&#39;x&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">3</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="nx">obj</span><span class="p">.</span><span class="nx">y</span> <span class="o">=</span> <span class="mi">4</span><span class="p">;</span>
</span></span></code></pre></div><p>属性读写 - 遍历：</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-javascript" data-lang="javascript"><span class="line"><span class="cl"><span class="kd">var</span> <span class="nx">obj</span> <span class="o">=</span> <span class="p">{</span> <span class="nx">x1</span><span class="o">:</span> <span class="mi">1</span><span class="p">,</span> <span class="nx">x2</span> <span class="o">:</span> <span class="mi">2</span><span class="p">,</span> <span class="nx">x3</span> <span class="o">:</span> <span class="mi">3</span> <span class="p">};</span>
</span></span><span class="line"><span class="cl"><span class="kd">var</span> <span class="nx">i</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="nx">n</span> <span class="o">=</span> <span class="mi">3</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">for</span> <span class="p">(;</span> <span class="nx">i</span> <span class="o">&lt;=</span> <span class="nx">n</span><span class="p">;</span> <span class="nx">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">obj</span><span class="p">[</span><span class="s1">&#39;x&#39;</span> <span class="o">+</span> <span class="nx">i</span><span class="p">]);</span>	<span class="c1">// 输出 1, 2, 3
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kd">var</span> <span class="nx">p</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="k">for</span> <span class="p">(</span><span class="nx">p</span> <span class="k">in</span> <span class="nx">obj</span><span class="p">)</span> <span class="p">{</span>	<span class="c1">// 用 for … in 方法可能会把原型链上的一些属性遍历出来
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">p</span><span class="p">);</span>	<span class="c1">// 输出 x1, x2, x3（顺序不确定）
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">obj</span><span class="p">[</span><span class="nx">p</span><span class="p">]);</span>	<span class="c1">// 输出 1, 2, 3（顺序不确定)
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="p">}</span>
</span></span></code></pre></div><p>属性读写 - 异常：</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-javascript" data-lang="javascript"><span class="line"><span class="cl"><span class="kd">var</span> <span class="nx">obj</span> <span class="o">=</span> <span class="p">{</span> <span class="nx">x</span> <span class="o">:</span> <span class="mi">1</span> <span class="p">};</span>
</span></span><span class="line"><span class="cl"><span class="nx">obj</span><span class="p">.</span><span class="nx">y</span><span class="p">;</span>	<span class="c1">// undefined
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="kd">var</span> <span class="nx">yz</span> <span class="o">=</span> <span class="nx">obj</span><span class="p">.</span><span class="nx">y</span><span class="p">.</span><span class="nx">z</span><span class="p">;</span>	<span class="c1">// TypeError: Cannot read property &#39;z&#39; of undefined
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nx">obj</span><span class="p">.</span><span class="nx">y</span><span class="p">.</span><span class="nx">z</span> <span class="o">=</span> <span class="mi">2</span><span class="p">;</span>	<span class="c1">// TypeError: Cannot set property &#39;z&#39; of undefined
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>
</span></span><span class="line"><span class="cl"><span class="c1">// 读取时的判断
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="kd">var</span> <span class="nx">yz</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="k">if</span> <span class="p">(</span><span class="nx">obj</span><span class="p">.</span><span class="nx">y</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nx">yz</span> <span class="o">=</span> <span class="nx">obj</span><span class="p">.</span><span class="nx">y</span><span class="p">.</span><span class="nx">z</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="c1">// or
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="kd">var</span> <span class="nx">yz</span> <span class="o">=</span> <span class="nx">obj</span> <span class="o">&amp;&amp;</span> <span class="nx">obj</span><span class="p">.</span><span class="nx">y</span> <span class="o">&amp;&amp;</span> <span class="nx">obj</span><span class="p">.</span><span class="nx">y</span><span class="p">.</span><span class="nx">z</span><span class="p">;</span>
</span></span></code></pre></div><h4 id="432-属性删除">4.3.2 属性删除<a hidden class="anchor" aria-hidden="true" href="#432-属性删除">#</a></h4>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-javascript" data-lang="javascript"><span class="line"><span class="cl"><span class="kd">var</span> <span class="nx">person</span> <span class="o">=</span> <span class="p">{</span> <span class="nx">age</span><span class="o">:</span> <span class="mi">28</span><span class="p">,</span> <span class="nx">title</span><span class="o">:</span> <span class="s1">&#39;fe&#39;</span> <span class="p">};</span>
</span></span><span class="line"><span class="cl"><span class="k">delete</span> <span class="nx">person</span><span class="p">.</span><span class="nx">age</span><span class="p">;</span>	<span class="c1">// true
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="k">delete</span> <span class="nx">person</span><span class="p">[</span><span class="s1">&#39;title&#39;</span><span class="p">];</span>	<span class="c1">// true
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nx">person</span><span class="p">.</span><span class="nx">age</span><span class="p">;</span>	<span class="c1">// undefined
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="k">delete</span> <span class="nx">person</span><span class="p">.</span><span class="nx">age</span><span class="p">;</span>	<span class="c1">// true （重复删除）
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>
</span></span><span class="line"><span class="cl"><span class="k">delete</span> <span class="nb">Object</span><span class="p">.</span><span class="nx">prototype</span><span class="p">;</span>	<span class="c1">// false （不允许删除）
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="kd">var</span> <span class="nx">descriptor</span> <span class="o">=</span> <span class="nb">Object</span><span class="p">.</span><span class="nx">getOwnPropertyDescriptor</span><span class="p">(</span><span class="nb">Object</span><span class="p">,</span> <span class="s1">&#39;prototype&#39;</span><span class="p">);</span>	<span class="c1">// 获取对象的一个属性中的所有标签
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nx">descriptor</span><span class="p">.</span><span class="nx">configurable</span><span class="p">;</span>	<span class="c1">// false
</span></span></span></code></pre></div><h4 id="433-属性检测">4.3.3 属性检测<a hidden class="anchor" aria-hidden="true" href="#433-属性检测">#</a></h4>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-javascript" data-lang="javascript"><span class="line"><span class="cl"><span class="kd">var</span> <span class="nx">cat</span> <span class="o">=</span> <span class="k">new</span> <span class="nb">Object</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="nx">cat</span><span class="p">.</span><span class="nx">legs</span> <span class="o">=</span> <span class="mi">4</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="nx">cat</span><span class="p">.</span><span class="nx">name</span> <span class="o">=</span> <span class="s1">&#39;Kitty&#39;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="s1">&#39;legs&#39;</span> <span class="k">in</span> <span class="nx">cat</span><span class="p">;</span>	<span class="c1">// true
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="s1">&#39;abc&#39;</span> <span class="k">in</span> <span class="nx">cat</span><span class="p">;</span>	<span class="c1">// false
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="s1">&#39;toString&#39;</span> <span class="k">in</span> <span class="nx">cat</span><span class="p">;</span>	<span class="c1">// true (inherited property!)(in 操作符会在原型链中向上查找)
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>
</span></span><span class="line"><span class="cl"><span class="nx">cat</span><span class="p">.</span><span class="nx">hasOwnProperty</span><span class="p">(</span><span class="s1">&#39;legs&#39;</span><span class="p">);</span>	<span class="c1">// true
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nx">cat</span><span class="p">.</span><span class="nx">hasOwnProperty</span><span class="p">(</span><span class="s1">&#39;toString&#39;</span><span class="p">);</span>	<span class="c1">// false (该对象上没有该属性，尽管原型链上有)
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>
</span></span><span class="line"><span class="cl"><span class="nx">cat</span><span class="p">.</span><span class="nx">propertyIsEnumerable</span><span class="p">(</span><span class="s1">&#39;legs&#39;</span><span class="p">);</span>	<span class="c1">// true (判断该属性是否可枚举)
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nx">cat</span><span class="p">.</span><span class="nx">propertyIsEnumerable</span><span class="p">(</span><span class="s1">&#39;toString&#39;</span><span class="p">);</span>	<span class="c1">// false
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>
</span></span><span class="line"><span class="cl"><span class="c1">// 自定义对象属性
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nb">Object</span><span class="p">.</span><span class="nx">defineProperty</span><span class="p">(</span><span class="nx">cat</span><span class="p">,</span> <span class="s1">&#39;price&#39;</span><span class="p">,</span> <span class="p">{</span><span class="nx">enumerable</span><span class="o">:</span> <span class="kc">false</span><span class="p">,</span> <span class="nx">value</span><span class="o">:</span> <span class="mi">1000</span><span class="p">});</span>
</span></span><span class="line"><span class="cl"><span class="nx">cat</span><span class="p">.</span><span class="nx">propertyIsEnumerable</span><span class="p">(</span><span class="s1">&#39;price&#39;</span><span class="p">);</span>	<span class="c1">// false
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nx">cat</span><span class="p">.</span><span class="nx">hasOwnProperty</span><span class="p">(</span><span class="s1">&#39;price&#39;</span><span class="p">);</span>	<span class="c1">// true
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>
</span></span><span class="line"><span class="cl"><span class="k">if</span> <span class="p">(</span><span class="nx">cat</span> <span class="o">&amp;&amp;</span> <span class="nx">cat</span><span class="p">.</span><span class="nx">legs</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="c1">// cat 存在，cat.legs 存在
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="nx">cat</span><span class="p">.</span><span class="nx">legs</span> <span class="o">*=</span> <span class="mi">2</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="k">if</span> <span class="p">(</span><span class="nx">cat</span><span class="p">.</span><span class="nx">legs</span> <span class="o">!=</span> <span class="kc">undefined</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="c1">// !== undefined, or, !== null 
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="k">if</span> <span class="p">(</span><span class="nx">cat</span><span class="p">.</span><span class="nx">legs</span> <span class="o">!==</span> <span class="kc">undefined</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="c1">// only if cat.legs is not undefined
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="p">}</span>
</span></span></code></pre></div><h4 id="434-属性枚举">4.3.4 属性枚举<a hidden class="anchor" aria-hidden="true" href="#434-属性枚举">#</a></h4>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-javascript" data-lang="javascript"><span class="line"><span class="cl"><span class="kd">var</span> <span class="nx">o</span> <span class="o">=</span> <span class="p">{</span> <span class="nx">x</span><span class="o">:</span> <span class="mi">1</span><span class="p">,</span> <span class="nx">y</span><span class="o">:</span> <span class="mi">2</span><span class="p">,</span> <span class="nx">z</span><span class="o">:</span> <span class="mi">3</span> <span class="p">};</span>
</span></span><span class="line"><span class="cl"><span class="s1">&#39;toString&#39;</span> <span class="k">in</span> <span class="nx">o</span><span class="p">;</span>	<span class="c1">// true
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nx">o</span><span class="p">.</span><span class="nx">propertyIsEnumerable</span><span class="p">(</span><span class="s1">&#39;toString&#39;</span><span class="p">);</span>	<span class="c1">// false（默认 false）
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="kd">var</span> <span class="nx">key</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="k">for</span> <span class="p">(</span><span class="nx">key</span> <span class="k">in</span> <span class="nx">o</span><span class="p">)</span> <span class="p">{</span>	<span class="c1">// 枚举 o 中（enumerable / 可枚举的）属性
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">key</span><span class="p">);</span>	<span class="c1">// x, y, z （不会出现 toString 等属性）
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kd">var</span> <span class="nx">obj</span> <span class="o">=</span> <span class="nb">Object</span><span class="p">.</span><span class="nx">create</span><span class="p">(</span><span class="nx">o</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="nx">obj</span><span class="p">.</span><span class="nx">a</span> <span class="o">=</span> <span class="mi">4</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="kd">var</span> <span class="nx">key</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="k">for</span> <span class="p">(</span><span class="nx">key</span> <span class="k">in</span> <span class="nx">obj</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">key</span><span class="p">);</span>	<span class="c1">// a, x, y, z
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kd">var</span> <span class="nx">obj</span> <span class="o">=</span> <span class="nb">Object</span><span class="p">.</span><span class="nx">create</span><span class="p">(</span><span class="nx">o</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="nx">obj</span><span class="p">.</span><span class="nx">a</span> <span class="o">=</span> <span class="mi">4</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="kd">var</span> <span class="nx">key</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="k">for</span> <span class="p">(</span><span class="nx">key</span> <span class="k">in</span> <span class="nx">obj</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="p">(</span><span class="nx">obj</span><span class="p">.</span><span class="nx">hasOwnProperty</span><span class="p">(</span><span class="nx">key</span><span class="p">))</span> <span class="p">{</span>	<span class="c1">// 过滤掉原型链上的属性
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>        <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">key</span><span class="p">);</span>	<span class="c1">// a
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></div><h2 id="44-get--set-方法">4.4 <code>get</code> / <code>set</code> 方法<a hidden class="anchor" aria-hidden="true" href="#44-get--set-方法">#</a></h2>
<p>另一种读写属性的方式</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-javascript" data-lang="javascript"><span class="line"><span class="cl"><span class="kd">var</span> <span class="nx">man</span> <span class="o">=</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nx">name</span><span class="o">:</span> <span class="s1">&#39;Bosn&#39;</span><span class="p">,</span>	<span class="c1">// 课程老师的名字 :)
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="nx">weibo</span><span class="o">:</span> <span class="s1">&#39;@Bosn&#39;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="nx">get</span> <span class="nx">age</span><span class="p">()</span> <span class="p">{</span>	<span class="c1">// get 方法
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>        <span class="k">return</span> <span class="k">new</span> <span class="nb">Date</span><span class="p">().</span><span class="nx">getFullYear</span><span class="p">()</span> <span class="o">-</span> <span class="mi">1988</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="p">},</span>
</span></span><span class="line"><span class="cl">    <span class="nx">set</span> <span class="nx">age</span><span class="p">(</span><span class="nx">val</span><span class="p">)</span> <span class="p">{</span>	<span class="c1">// set方法
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>        <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s1">&#39;Age can\&#39;t be set to &#39;</span> <span class="o">+</span> <span class="nx">val</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">man</span><span class="p">.</span><span class="nx">age</span><span class="p">);</span>	<span class="c1">// 31（访问 man.age 时，自动调用 get 方法）
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nx">man</span><span class="p">.</span><span class="nx">age</span> <span class="o">=</span> <span class="mi">100</span><span class="p">;</span>	<span class="c1">// Age cat&#39;t be set to 100（为 man.age 赋值时，自动调用 set 方法）
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">man</span><span class="p">.</span><span class="nx">age</span><span class="p">);</span>	<span class="c1">// still 31（调用 get 方法）
</span></span></span></code></pre></div><p>更复杂的例子：</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-javascript" data-lang="javascript"><span class="line"><span class="cl"><span class="kd">var</span> <span class="nx">man</span> <span class="o">=</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nx">weibo</span><span class="o">:</span> <span class="s1">&#39;@Bosn&#39;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="nx">$age</span><span class="o">:</span> <span class="kc">null</span><span class="p">,</span>	<span class="c1">// $age 与 age 是不同的，这里的 $ 符号表示不在外部暴露这个属性*
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="nx">get</span> <span class="nx">age</span><span class="p">()</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="k">if</span> <span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">$age</span> <span class="o">==</span> <span class="kc">undefined</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="k">return</span> <span class="k">new</span> <span class="nb">Date</span><span class="p">().</span><span class="nx">getFullYear</span><span class="p">()</span> <span class="o">-</span> <span class="mi">1988</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="k">return</span> <span class="k">this</span><span class="p">.</span><span class="nx">$age</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="p">},</span>
</span></span><span class="line"><span class="cl">    <span class="nx">set</span> <span class="nx">age</span><span class="p">(</span><span class="nx">val</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="nx">val</span> <span class="o">=</span> <span class="o">+</span><span class="nx">val</span><span class="p">;</span>	<span class="c1">// 一元 + 操作符，用以将 val 转化为数字
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>        <span class="c1">// 例如：+123 =&gt; 123, +&#39;123&#39; =&gt; 123, +&#39;abc&#39; =&gt; NaN
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>        <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nb">isNaN</span><span class="p">(</span><span class="nx">val</span><span class="p">)</span> <span class="o">&amp;&amp;</span> <span class="nx">val</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="o">&amp;&amp;</span> <span class="nx">val</span> <span class="o">&lt;</span> <span class="mi">150</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="k">this</span><span class="p">.</span><span class="nx">$age</span> <span class="o">=</span> <span class="o">+</span><span class="nx">val</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="k">throw</span> <span class="k">new</span> <span class="nb">Error</span><span class="p">(</span><span class="s1">&#39;Incorrect val = &#39;</span> <span class="o">+</span> <span class="nx">val</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">man</span><span class="p">.</span><span class="nx">age</span><span class="p">);</span>	<span class="c1">// 31
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nx">man</span><span class="p">.</span><span class="nx">age</span> <span class="o">=</span> <span class="mi">100</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">man</span><span class="p">.</span><span class="nx">age</span><span class="p">);</span>	<span class="c1">// 100
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nx">man</span><span class="p">.</span><span class="nx">age</span> <span class="o">=</span> <span class="s1">&#39;abc&#39;</span><span class="p">;</span>	<span class="c1">// error: Incorrect val = NaN
</span></span></span></code></pre></div><p><code>get</code> / <code>set</code> 与原型链</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-javascript" data-lang="javascript"><span class="line"><span class="cl"><span class="kd">function</span> <span class="nx">foo</span><span class="p">()</span> <span class="p">{}</span>
</span></span><span class="line"><span class="cl"><span class="nb">Object</span><span class="p">.</span><span class="nx">defineProperty</span><span class="p">(</span><span class="nx">foo</span><span class="p">.</span><span class="nx">prototype</span><span class="p">,</span> <span class="s1">&#39;z&#39;</span><span class="p">,</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nx">get</span><span class="o">:</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span> <span class="k">return</span> <span class="mi">1</span><span class="p">;</span> <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">});</span>
</span></span><span class="line"><span class="cl"><span class="kd">var</span> <span class="nx">obj</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">foo</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nx">obj</span><span class="p">.</span><span class="nx">z</span><span class="p">;</span>	<span class="c1">// 1
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nx">obj</span><span class="p">.</span><span class="nx">z</span><span class="p">;</span>	<span class="c1">// 10
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nx">obj</span><span class="p">.</span><span class="nx">z</span><span class="p">;</span>	<span class="c1">// still 1
</span></span></span></code></pre></div><p><img loading="lazy" src="https://ws1.sinaimg.cn/large/006y42ybgy1fz0cjq3ekwj30bu0djjti.jpg" alt=""  />
</p>
<p>这是因为当 <code>obj</code> 对象上没有该属性，并且在原型链上查找时发现有对应的 <code>get</code> 或 <code>set</code> 方法时，尝试对该属性赋值就会调用原型链上的 <code>get</code> / <code>set</code> 方法，而不会再去给当前对象添加新属性。如果需要给 <code>obj</code> 对象添加这样一个属性并实现修改，可以使用以下方法：</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-javascript" data-lang="javascript"><span class="line"><span class="cl"><span class="nb">Object</span><span class="p">.</span><span class="nx">defineProperty</span><span class="p">(</span><span class="nx">obj</span><span class="p">,</span> <span class="s1">&#39;z&#39;</span><span class="p">,</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nx">value</span><span class="o">:</span> <span class="mi">100</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="nx">configurable</span><span class="o">:</span> <span class="kc">true</span>	<span class="c1">// 默认为 false
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="p">});</span>
</span></span><span class="line"><span class="cl"><span class="nx">obj</span><span class="p">.</span><span class="nx">z</span><span class="p">;</span>	<span class="c1">// 100
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="k">delete</span> <span class="nx">obj</span><span class="p">.</span><span class="nx">z</span><span class="p">;</span>	<span class="c1">// true
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nx">obj</span><span class="p">.</span><span class="nx">z</span><span class="p">;</span>	<span class="c1">// back to 1
</span></span></span></code></pre></div><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-javascript" data-lang="javascript"><span class="line"><span class="cl"><span class="kd">var</span> <span class="nx">o</span> <span class="o">=</span> <span class="p">{};</span>
</span></span><span class="line"><span class="cl"><span class="nb">Object</span><span class="p">.</span><span class="nx">defineProperty</span><span class="p">(</span><span class="nx">o</span><span class="p">,</span> <span class="s1">&#39;x&#39;</span><span class="p">,</span> <span class="p">{</span> <span class="nx">value</span><span class="o">:</span> <span class="mi">1</span> <span class="p">});</span>	<span class="c1">// writable = false, configurable = false;
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="kd">var</span> <span class="nx">obj</span> <span class="o">=</span> <span class="nb">Object</span><span class="p">.</span><span class="nx">create</span><span class="p">(</span><span class="nx">o</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="nx">obj</span><span class="p">.</span><span class="nx">x</span><span class="p">;</span>	<span class="c1">// 1
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nx">obj</span><span class="p">.</span><span class="nx">x</span> <span class="o">=</span> <span class="mi">200</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="nx">obj</span><span class="p">.</span><span class="nx">x</span><span class="p">;</span>	<span class="c1">// still 1, can&#39;t change it
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>
</span></span><span class="line"><span class="cl"><span class="nb">Object</span><span class="p">.</span><span class="nx">defineProperty</span><span class="p">(</span><span class="nx">obj</span><span class="p">,</span> <span class="s1">&#39;x&#39;</span><span class="p">,</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nx">writable</span><span class="o">:</span> <span class="kc">true</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="nx">configurable</span><span class="o">:</span> <span class="kc">true</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="nx">value</span><span class="o">:</span> <span class="mi">100</span>
</span></span><span class="line"><span class="cl"><span class="p">});</span>
</span></span><span class="line"><span class="cl"><span class="nx">obj</span><span class="p">.</span><span class="nx">x</span><span class="p">;</span>	<span class="c1">// 100
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nx">obj</span><span class="p">.</span><span class="nx">x</span> <span class="o">=</span> <span class="mi">500</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="nx">obj</span><span class="p">.</span><span class="nx">x</span><span class="p">;</span>	<span class="c1">// 500
</span></span></span></code></pre></div><h2 id="45-属性标签">4.5 属性标签<a hidden class="anchor" aria-hidden="true" href="#45-属性标签">#</a></h2>
<blockquote>
<p>属性标签即指属性描述符</p>
</blockquote>
<h4 id="451-获取属性标签">4.5.1 获取属性标签<a hidden class="anchor" aria-hidden="true" href="#451-获取属性标签">#</a></h4>
<p><code>Object.getOwnPropertyDescriptor(obj, prop)</code></p>
<ul>
<li>
<p>该方法返回指定对象上一个自有属性对应的属性描述符</p>
<p>（自有属性指的是直接赋予该对象的属性，不需要从原型链上进行查找的属性）</p>
</li>
<li>
<p>参数：</p>
<ul>
<li><code>obj</code>：需要查找的目标对象</li>
<li><code>prop</code>：目标对象内属性名称 （<code>String</code> 类型）</li>
</ul>
</li>
<li>
<p>返回值：</p>
<ul>
<li>如果指定的属性存在于对象上，则返回其属性描述符对象（property descriptor），否则返回 <code>undefined</code></li>
</ul>
</li>
<li>
<p>一个属性描述符是一个记录，由下面属性当中的某些组成：</p>
<ul>
<li><code>value</code>：该属性的值（仅针对数据属性描述有效）</li>
<li><code>writable</code>：当且仅当属性的值可以改变时为 <code>true</code>（仅针对数据属性描述有效）</li>
<li><code>get</code>：获取该属性的访问器函数（getter），如果没有访问器，该值为 <code>undefined</code>（仅针对包含访问器或设置器的属性描述有效）</li>
<li><code>set</code>：获取该属性的设置器函数（setter），如果没有设置器，该值为 <code>undefined</code>（仅针对包含访问器或设置器的属性描述有效）</li>
<li><code>configurable</code>：当且仅当指定对象的属性描述可以被改变或者属性可被删除时，为 <code>true</code></li>
<li><code>enumerable</code>：当且仅当指定对象的属性可以被枚举出时，为 <code>true</code></li>
</ul>
</li>
</ul>
<p>示例：</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-javascript" data-lang="javascript"><span class="line"><span class="cl"><span class="nb">Object</span><span class="p">.</span><span class="nx">getOwnPropertyDescriptor</span><span class="p">({</span><span class="nx">pro</span><span class="o">:</span> <span class="kc">true</span><span class="p">},</span> <span class="s1">&#39;pro&#39;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="c1">// Object {value: true, writable: true, enumerable: true, configurable: true}
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nb">Object</span><span class="p">.</span><span class="nx">getOwnPropertyDescriptor</span><span class="p">({</span><span class="nx">pro</span><span class="o">:</span> <span class="kc">true</span><span class="p">},</span> <span class="s1">&#39;pro&#39;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="c1">// undefined
</span></span></span></code></pre></div><h4 id="452-设置属性标签">4.5.2 设置属性标签<a hidden class="anchor" aria-hidden="true" href="#452-设置属性标签">#</a></h4>
<p><code>Object.defineProperty(obj, prop, descriptor)</code></p>
<ul>
<li>该方法会直接在一个对象上定义一个新属性，或者修改一个对象的现有属性， 并返回这个对象。</li>
<li>参数：
<ul>
<li><code>obj</code>：要在其上定义属性的对象</li>
<li><code>prop</code>：要定义或修改的属性的名次（<code>String</code> 类型）</li>
<li><code>descriptor</code>：将被定义或修改的属性描述符</li>
</ul>
</li>
<li>返回值：被传递给函数的对象</li>
<li>该方法允许精确添加或修改对象的属性。通过赋值操作添加的普通属性是可枚举的，能够在属性枚举期间呈现出来（<code>for...in</code>  或  <code>Object.keys</code> 方法）， 这些属性的值可以被改变，也可以被删除。这个方法允许修改默认的额外选项（或配置）。**注意：**默认情况下，使用 <code>Object.defineProperty()</code> 添加的属性值是不可修改的。</li>
</ul>
<p>示例 1：</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-javascript" data-lang="javascript"><span class="line"><span class="cl"><span class="kd">var</span> <span class="nx">person</span> <span class="o">=</span> <span class="p">{};</span>
</span></span><span class="line"><span class="cl"><span class="nb">Object</span><span class="p">.</span><span class="nx">defineProperty</span><span class="p">(</span><span class="nx">person</span><span class="p">,</span> <span class="s1">&#39;name&#39;</span><span class="p">,</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nx">configurable</span><span class="o">:</span> <span class="kc">false</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="nx">writable</span><span class="o">:</span> <span class="kc">false</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="nx">enumerable</span><span class="o">:</span> <span class="kc">true</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="nx">value</span><span class="o">:</span> <span class="s1">&#39;Bosn Ma&#39;</span>
</span></span><span class="line"><span class="cl"><span class="p">});</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nx">person</span><span class="p">.</span><span class="nx">name</span><span class="p">;</span>	<span class="c1">// Bosn Ma
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nx">person</span><span class="p">.</span><span class="nx">name</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="nx">person</span><span class="p">.</span><span class="nx">name</span><span class="p">;</span>	<span class="c1">// still Bosn Ma
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="k">delete</span> <span class="nx">person</span><span class="p">.</span><span class="nx">name</span><span class="p">;</span>	<span class="c1">//false
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>
</span></span><span class="line"><span class="cl"><span class="nb">Object</span><span class="p">.</span><span class="nx">defineProperty</span><span class="p">(</span><span class="nx">person</span><span class="p">,</span> <span class="s1">&#39;type&#39;</span><span class="p">,</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nx">configurable</span><span class="o">:</span> <span class="kc">true</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="nx">writable</span><span class="o">:</span> <span class="kc">true</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="nx">enumerable</span><span class="o">:</span> <span class="kc">false</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="nx">value</span><span class="o">:</span> <span class="s1">&#39;Object&#39;</span>
</span></span><span class="line"><span class="cl"><span class="p">});</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nb">Object</span><span class="p">.</span><span class="nx">keys</span><span class="p">(</span><span class="nx">person</span><span class="p">);</span>	<span class="c1">// [&#34;name&#34;] (因为，name 可枚举，type 不可枚举)
</span></span></span></code></pre></div><p>示例 2：</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-javascript" data-lang="javascript"><span class="line"><span class="cl"><span class="nb">Object</span><span class="p">.</span><span class="nx">defineProperties</span><span class="p">(</span><span class="nx">person</span><span class="p">,</span> <span class="p">{</span>	<span class="c1">// 类似于 Object.defineProperty()，可以同时定义多个属性
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="nx">title</span><span class="o">:</span> <span class="p">{</span><span class="nx">value</span><span class="o">:</span> <span class="s1">&#39;fe&#39;</span><span class="p">,</span> <span class="nx">enumerable</span><span class="o">:</span> <span class="kc">true</span><span class="p">},</span>	<span class="c1">// 未声明的属性标签默认都为 false
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="nx">corp</span><span class="o">:</span> <span class="p">{</span><span class="nx">value</span><span class="o">:</span> <span class="s1">&#39;BABA&#39;</span><span class="p">,</span> <span class="nx">enumerable</span><span class="o">:</span> <span class="kc">true</span><span class="p">},</span>
</span></span><span class="line"><span class="cl">    <span class="nx">salary</span><span class="o">:</span> <span class="p">{</span><span class="nx">value</span><span class="o">:</span> <span class="mi">50000</span><span class="p">,</span> <span class="nx">enumerable</span><span class="o">:</span> <span class="kc">true</span><span class="p">,</span> <span class="nx">writable</span><span class="o">:</span> <span class="kc">true</span><span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">});</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nb">Object</span><span class="p">.</span><span class="nx">getOwnPropertyDescriptor</span><span class="p">(</span><span class="nx">person</span><span class="p">,</span> <span class="s1">&#39;salary&#39;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="c1">// Object {value: 50000, writable: true, enumerable: true, configurable: false}
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nb">Object</span><span class="p">.</span><span class="nx">getOwnPropertyDescriptor</span><span class="p">(</span><span class="nx">person</span><span class="p">,</span> <span class="s1">&#39;corp&#39;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="c1">// Object {value: &#34;BABA&#34;, writable: false, enumerable: true, configurable: false}
</span></span></span></code></pre></div><p>示例 3：</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-javascript" data-lang="javascript"><span class="line"><span class="cl"><span class="nb">Object</span><span class="p">.</span><span class="nx">defineProperties</span><span class="p">(</span><span class="nx">person</span><span class="p">,</span> <span class="p">{</span>	<span class="c1">// 更加复杂化
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="nx">title</span><span class="o">:</span> <span class="p">{</span><span class="nx">value</span><span class="o">:</span> <span class="s1">&#39;fe&#39;</span><span class="p">,</span> <span class="nx">enumerable</span><span class="o">:</span> <span class="kc">true</span><span class="p">},</span>	
</span></span><span class="line"><span class="cl">    <span class="nx">corp</span><span class="o">:</span> <span class="p">{</span><span class="nx">value</span><span class="o">:</span> <span class="s1">&#39;BABA&#39;</span><span class="p">,</span> <span class="nx">enumerable</span><span class="o">:</span> <span class="kc">true</span><span class="p">},</span>
</span></span><span class="line"><span class="cl">    <span class="nx">salary</span><span class="o">:</span> <span class="p">{</span><span class="nx">value</span><span class="o">:</span> <span class="mi">50000</span><span class="p">,</span> <span class="nx">enumerable</span><span class="o">:</span> <span class="kc">true</span><span class="p">,</span> <span class="nx">writable</span><span class="o">:</span> <span class="kc">true</span><span class="p">},</span>
</span></span><span class="line"><span class="cl">    <span class="nx">luck</span><span class="o">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="nx">get</span><span class="o">:</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="k">return</span> <span class="nb">Math</span><span class="p">.</span><span class="nx">random</span><span class="p">()</span> <span class="o">&gt;</span> <span class="mf">0.5</span> <span class="o">?</span> <span class="s1">&#39;good&#39;</span> <span class="o">:</span> <span class="s1">&#39;bad&#39;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="p">},</span>
</span></span><span class="line"><span class="cl">    <span class="nx">promote</span><span class="o">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="nx">set</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">level</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="k">this</span><span class="p">.</span><span class="nx">salary</span> <span class="o">*=</span> <span class="mi">1</span> <span class="o">+</span> <span class="nx">level</span> <span class="o">*</span> <span class="mf">0.1</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">});</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nb">Object</span><span class="p">.</span><span class="nx">getOwnPropertyDescriptor</span><span class="p">(</span><span class="nx">person</span><span class="p">,</span> <span class="s1">&#39;salary&#39;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="c1">// Object {value: 50000, writable: true, enumerable: true, configurable: false}
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nb">Object</span><span class="p">.</span><span class="nx">getOwnPropertyDescriptor</span><span class="p">(</span><span class="nx">person</span><span class="p">,</span> <span class="s1">&#39;corp&#39;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="c1">// Object {value: &#34;BABA&#34;, writable: false, enumerable: true, configurable: false}
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nx">person</span><span class="p">.</span><span class="nx">salary</span><span class="p">;</span>	<span class="c1">// 50000
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nx">person</span><span class="p">.</span><span class="nx">promote</span> <span class="o">=</span> <span class="mi">2</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="nx">person</span><span class="p">.</span><span class="nx">salary</span><span class="p">;</span>	<span class="c1">// 60000
</span></span></span></code></pre></div><h4 id="453-configurable-与-writalbe-的限制">4.5.3 <code>configurable</code> 与 <code>writalbe</code> 的限制<a hidden class="anchor" aria-hidden="true" href="#453-configurable-与-writalbe-的限制">#</a></h4>
<p><img loading="lazy" src="https://ws1.sinaimg.cn/large/006y42ybgy1fz0oqk586hj30rx0db0tv.jpg" alt=""  />
</p>
<h2 id="46-对象标签对象序列化">4.6 对象标签、对象序列化<a hidden class="anchor" aria-hidden="true" href="#46-对象标签对象序列化">#</a></h2>
<h4 id="461-对象标签">4.6.1 对象标签<a hidden class="anchor" aria-hidden="true" href="#461-对象标签">#</a></h4>
<p><strong>1. 原型标签 <code>__proto__</code></strong></p>
<ul>
<li><code>Object.prototype</code> 的 <code>__proto__</code> 属性是一个访问器属性（一个 <code>getter</code> 函数和一个 <code>setter</code> 函数）， 暴露了通过它访问的对象的内部 <code>[[Prototype]]</code> (一个对象或  <code>null</code>)，任何一个 <code>__proto__</code> 的存取属性都继承于<code>Object.prototype</code>。</li>
<li>使用 <code>__proto__</code> 是有争议的，也不鼓励使用它。因为它从来没有被包括在 EcmaScript 语言规范中，但是现代浏览器都实现了它。</li>
</ul>
<p><img loading="lazy" src="https://ws1.sinaimg.cn/large/006y42ybgy1fz0p0r3ra9j30hm0dogna.jpg" alt=""  />
</p>
<p><strong>2. <code>class</code> 标签</strong></p>
<ul>
<li>表示对象的类型</li>
<li>没有直接查看或修改的方式，可以间接通过 <code>Object.prototype.toString</code> 的方式去获取</li>
</ul>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-javascript" data-lang="javascript"><span class="line"><span class="cl"><span class="kd">var</span> <span class="nx">toString</span> <span class="o">=</span> <span class="nb">Object</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">toString</span><span class="p">;</span>	<span class="c1">// 用以获取每个对象的类型
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="kd">function</span> <span class="nx">getType</span><span class="p">(</span><span class="nx">o</span><span class="p">)</span> <span class="p">{</span><span class="k">return</span> <span class="nx">toString</span><span class="p">.</span><span class="nx">call</span><span class="p">(</span><span class="nx">o</span><span class="p">).</span><span class="nx">slice</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">);}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nx">toString</span><span class="p">.</span><span class="nx">call</span><span class="p">(</span><span class="kc">null</span><span class="p">);</span>	<span class="c1">// &#34;[object Null]&#34;
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nx">getType</span><span class="p">(</span><span class="kc">null</span><span class="p">);</span>	<span class="c1">// &#34;Null&#34;
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nx">getType</span><span class="p">(</span><span class="kc">undefined</span><span class="p">);</span>	<span class="c1">// &#34;Number&#34;
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nx">getType</span><span class="p">(</span><span class="k">new</span> <span class="nb">Number</span><span class="p">(</span><span class="mi">1</span><span class="p">));</span>	<span class="c1">// &#34;Number&#34;
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="k">typeof</span> <span class="k">new</span> <span class="nb">Number</span><span class="p">(</span><span class="mi">1</span><span class="p">);</span>	<span class="c1">// &#34;object&#34;
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nx">getType</span><span class="p">(</span><span class="kc">true</span><span class="p">);</span>	<span class="c1">// &#34;Boolean&#34;
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nx">getType</span><span class="p">(</span><span class="k">new</span> <span class="nb">Boolean</span><span class="p">(</span><span class="kc">true</span><span class="p">));</span>	<span class="c1">// &#34;Boolean&#34;
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="k">typeof</span> <span class="k">new</span> <span class="nb">Number</span><span class="p">(</span><span class="kc">true</span><span class="p">);</span>	<span class="c1">// &#34;object&#34;
</span></span></span></code></pre></div><p><strong>3. <code>extensible</code> 标签</strong></p>
<p><code>Object.isExtensible()</code> 方法判断一个对象是否是可扩展的（是否可以在它上面添加新的属性）</p>
<ul>
<li>参数：
<ul>
<li><code>obj</code>：需要检测的队形</li>
</ul>
</li>
<li>返回值：表示给定对象是否可扩展的一个 <code>Boolean</code></li>
<li>默认情况下，对象是可扩展的：即可以为他们添加新的属性。以及它们的 <code>__proto__</code> 属性可以被更改。<code>Object.preventExtensions</code>，<code>Object.seal</code> 或 <code>Object.freeze</code> 方法都可以标记一个对象为不可扩展（non-extensible）。</li>
</ul>
<p><code>Object.seal()</code>方法封闭一个对象，阻止添加新属性并将所有现有属性标记为不可配置。当前属性的值只要可写就可以改变。</p>
<ul>
<li>
<p>参数：</p>
<ul>
<li><code>obj</code>：将要被密封的对象</li>
</ul>
</li>
<li>
<p>返回值：被密封的对象</p>
</li>
<li>
<p>尝试删除一个密封对象的属性或者将某个密封对象的属性从数据属性转换成访问器属性，结果会静默失败或抛出<code>TypeError</code>（在 <code>严格模式</code> 中最常见的，但不唯一）。</p>
<p>不会影响从原型链上继承的属性。但 <code>__proto__</code> 属性的值也会不能修改。</p>
</li>
</ul>
<p><code>Object.freeze()</code> 方法可以冻结一个对象，冻结指的是不能向这个对象添加新的属性，不能修改其已有属性的值，不能删除已有属性，以及不能修改该对象已有属性的可枚举性、可配置性、可写性。</p>
<ul>
<li>
<p>参数：</p>
<ul>
<li><code>obj</code>：要被冻结的对象</li>
</ul>
</li>
<li>
<p>返回值：被冻结的对象（而不是创建一个被冻结的副本）</p>
</li>
<li>
<p>被冻结对象自身的所有属性都不可能以任何方式被修改。任何修改尝试都会失败，无论是静默地还是通过抛出<code>TypeError</code>异常（最常见但不仅限于 <code>严格模式</code>）。</p>
<p>数据属性的值不可更改，访问器属性（有getter和setter）也同样（但由于是函数调用，给人的错觉是还是可以修改这个属性）。如果一个属性的值是个对象，则这个对象中的属性是可以修改的，除非它也是个冻结对象。数组作为一种对象，被冻结，其元素不能被修改。没有数组元素可以被添加或移除。</p>
</li>
</ul>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-javascript" data-lang="javascript"><span class="line"><span class="cl"><span class="kd">var</span> <span class="nx">obj</span> <span class="o">=</span> <span class="p">{</span><span class="nx">x</span><span class="o">:</span> <span class="mi">1</span><span class="p">,</span> <span class="nx">y</span><span class="o">:</span> <span class="mi">2</span><span class="p">};</span>
</span></span><span class="line"><span class="cl"><span class="nb">Object</span><span class="p">.</span><span class="nx">isExtensible</span><span class="p">(</span><span class="nx">obj</span><span class="p">);</span>	<span class="c1">// true
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nb">Object</span><span class="p">.</span><span class="nx">preventExtensions</span><span class="p">(</span><span class="nx">obj</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="nb">Object</span><span class="p">.</span><span class="nx">isExtensible</span><span class="p">(</span><span class="nx">obj</span><span class="p">);</span>	<span class="c1">// false
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nx">obj</span><span class="p">.</span><span class="nx">z</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="nx">obj</span><span class="p">.</span><span class="nx">z</span><span class="p">;</span>	<span class="c1">// undefined (add new property failed)
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nb">Object</span><span class="p">.</span><span class="nx">getOwnPropertyDescriptor</span><span class="p">(</span><span class="nx">obj</span><span class="p">,</span> <span class="s1">&#39;x&#39;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="c1">// Object {value: 1, writable: true, enumerable: true, configurable: true}
</span></span></span><span class="line"><span class="cl"><span class="c1">// 原有属性仍然是可以修改、删除的
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>
</span></span><span class="line"><span class="cl"><span class="nb">Object</span><span class="p">.</span><span class="nx">seal</span><span class="p">(</span><span class="nx">obj</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="nb">Object</span><span class="p">.</span><span class="nx">getOwnPropertyDescriptor</span><span class="p">(</span><span class="nx">obj</span><span class="p">,</span> <span class="s1">&#39;x&#39;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="c1">// Object {value: 1, writable: true, enumerable: true, configurable: false}
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nb">Object</span><span class="p">.</span><span class="nx">isSealed</span><span class="p">(</span><span class="nx">obj</span><span class="p">);</span>	<span class="c1">// true
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>
</span></span><span class="line"><span class="cl"><span class="nb">Object</span><span class="p">.</span><span class="nx">freeze</span><span class="p">(</span><span class="nx">obj</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="nb">Object</span><span class="p">.</span><span class="nx">getOwnPropertyDescriptor</span><span class="p">(</span><span class="nx">obj</span><span class="p">,</span> <span class="s1">&#39;x&#39;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="c1">// Object {value: 1, writable: false, enumerable: true, configurable: false}
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nb">Object</span><span class="p">.</span><span class="nx">isFrozen</span><span class="p">(</span><span class="nx">obj</span><span class="p">);</span>	<span class="c1">// true
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>
</span></span><span class="line"><span class="cl"><span class="c1">// [CAUTION] Do not affects prototype chain!
</span></span></span></code></pre></div><h4 id="462-序列化其他对象方法">4.6.2 序列化、其他对象方法<a hidden class="anchor" aria-hidden="true" href="#462-序列化其他对象方法">#</a></h4>
<p><strong>1. 序列化</strong></p>
<p><code>JSON.stringify()</code> 方法是将一个 JavaScript 值（对象或者数组）转换为一个 JSON 字符串，如果指定了 <code>replacer</code> 是一个函数，则可以替换值，或者如果指定了 <code>replacer</code> 是一个数组，可选的仅包括指定的属性。</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-javascript" data-lang="javascript"><span class="line"><span class="cl"><span class="nx">JSON</span><span class="p">.</span><span class="nx">stringify</span><span class="p">(</span><span class="nx">value</span><span class="p">[,</span> <span class="nx">replacer</span><span class="p">[,</span> <span class="nx">space</span><span class="p">]])</span>
</span></span></code></pre></div><ul>
<li>参数：
<ul>
<li><code>value</code>：将要序列化成一个 JSON 字符串的值</li>
<li><code>replacer</code> <code>可选</code>：如果该参数是一个函数，则在序列化过程中，被序列化的值的每个属性都会经过该函数的转换和处理；如果该参数是一个数组，则只有包含在这个数组中的属性名才会被序列化到最终的 JSON 字符串中；如果该参数为null或者未提供，则对象所有的属性都会被序列化；关于该参数更详细的解释和示例，请参考<a href="https://developer.mozilla.org/zh-CN/docs/Web/JavaScript/Guide/Using_native_JSON#The_replacer_parameter">使用原生的 JSON 对象</a>一文。</li>
<li><code>space</code> <code>可选</code>：指定缩进用的空白字符串，用于美化输出（pretty-print）；如果参数是一个数字，它代表有多少的空格；上限为 10。该值若小于 1，则意味着没有空格；如果该参数为字符串（字符串的前十个字母），该字符串将被作为空格；如果该参数没有提供（或者为 <code>null</code>）将没有空格。</li>
</ul>
</li>
<li>返回值：一个表示给定值的 <strong>JSON 字符串</strong></li>
<li>关于序列化，下面有五点注意事项：
<ul>
<li>非数组对象的属性不能保证以特定的顺序出现在序列化后的字符串中</li>
<li>布尔值、数字、字符串的包装对象在序列化过程中会自动转换为对应的原始值</li>
<li><code>undefined</code>、任意的函数以及 symbol 值，在序列化中会被忽略（出现在非数组对象的属性值中）或者被转换成 <code>null</code> （出现在数组中时）</li>
<li>所有以 symbol 值为属性键的属性都会被完全忽略掉，即使 <code>replacer</code> 参数中强制指定包含了它们</li>
<li>不可枚举的属性会被忽略</li>
</ul>
</li>
</ul>
<p><code>JSON.parse()</code> 方法用来解析JSON字符串，构造由字符串描述的JavaScript值或对象。提供可选的 reviver 函数用以在返回之前对所得到的对象执行变换（操作）。</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-javascript" data-lang="javascript"><span class="line"><span class="cl"><span class="nx">JSON</span><span class="p">.</span><span class="nx">parse</span><span class="p">(</span><span class="nx">text</span><span class="p">[,</span> <span class="nx">reviver</span><span class="p">])</span>
</span></span></code></pre></div><ul>
<li>参数：
<ul>
<li><code>text</code>：将要被解析成 JavaScript 值的字符串，关于 JSON 的语法格式，请参考：<a href="https://developer.mozilla.org/zh-CN/docs/Web/JavaScript/Reference/Global_Objects/JSON"><code>JSON</code></a>。</li>
<li><code>reviver</code> <code>可选</code>：转换器，如果传入该参数（函数），可以用来修改解析生成的原始值，调用时机在 parser 函数返回之前</li>
</ul>
</li>
<li>返回值：<code>Object</code> 类型，对应给定的 JSON 文本的对象 / 值</li>
<li>异常：若传入的字符串不符合 JSON 规范，则会抛出 <code>SyntaxError</code> 异常</li>
</ul>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-javascript" data-lang="javascript"><span class="line"><span class="cl"><span class="kd">var</span> <span class="nx">obj</span> <span class="o">=</span> <span class="p">{</span><span class="nx">x</span><span class="o">:</span> <span class="mi">1</span><span class="p">,</span> <span class="nx">y</span><span class="o">:</span> <span class="kc">true</span><span class="p">,</span> <span class="nx">z</span><span class="o">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span> <span class="nx">nullVal</span><span class="o">:</span> <span class="kc">null</span><span class="p">};</span>
</span></span><span class="line"><span class="cl"><span class="nx">JSON</span><span class="p">.</span><span class="nx">stringify</span><span class="p">(</span><span class="nx">obj</span><span class="p">);</span>	<span class="c1">// &#34;{&#34;x&#34;: 1, &#34;y&#34;: true, &#34;z&#34;: [1, 2, 3], &#34;nullVal&#34;: null}&#34;
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>
</span></span><span class="line"><span class="cl"><span class="nx">obj</span> <span class="o">=</span> <span class="p">{</span><span class="nx">val</span><span class="o">:</span> <span class="kc">undefined</span><span class="p">,</span> <span class="nx">a</span><span class="o">:</span> <span class="kc">NaN</span><span class="p">,</span> <span class="nx">b</span><span class="o">:</span> <span class="kc">Infinity</span><span class="p">,</span> <span class="nx">c</span><span class="o">:</span> <span class="k">new</span> <span class="nb">Date</span><span class="p">()};</span>
</span></span><span class="line"><span class="cl"><span class="nx">JSON</span><span class="p">.</span><span class="nx">stringify</span><span class="p">(</span><span class="nx">obj</span><span class="p">);</span>	<span class="c1">// &#34;{&#34;a&#34;: null, &#34;b&#34;: null, &#34;c&#34;: &#34;2019-01-09T14:15:43.910Z&#34;}&#34;
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>
</span></span><span class="line"><span class="cl"><span class="nx">obj</span> <span class="o">=</span> <span class="nx">JSON</span><span class="p">.</span><span class="nx">parse</span><span class="p">(</span><span class="s1">&#39;{&#34;x&#34;: 1}&#39;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="nx">obj</span><span class="p">.</span><span class="nx">x</span><span class="p">;</span>	<span class="c1">// 1
</span></span></span></code></pre></div><p><strong>2. 序列化 - 自定义</strong></p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-javascript" data-lang="javascript"><span class="line"><span class="cl"><span class="kd">var</span> <span class="nx">obj</span> <span class="o">=</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nx">x</span><span class="o">:</span> <span class="mi">1</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="nx">y</span><span class="o">:</span> <span class="mi">2</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="nx">o</span><span class="o">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="nx">o1</span><span class="o">:</span> <span class="mi">1</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="nx">o2</span><span class="o">:</span> <span class="mi">2</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="nx">toJSON</span><span class="o">:</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="k">return</span> <span class="k">this</span><span class="p">.</span><span class="nx">o1</span> <span class="o">+</span> <span class="k">this</span><span class="p">.</span><span class="nx">o2</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">};</span>
</span></span><span class="line"><span class="cl"><span class="nx">JSON</span><span class="p">.</span><span class="nx">stringify</span><span class="p">(</span><span class="nx">obj</span><span class="p">);</span>	<span class="c1">// &#34;{&#34;x&#34;: 1, &#34;y&#34;: 2, &#34;o&#34;: 3}&#34;
</span></span></span></code></pre></div><p><strong>3. 其他对象方法</strong></p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-javascript" data-lang="javascript"><span class="line"><span class="cl"><span class="kd">var</span> <span class="nx">obj</span> <span class="o">=</span> <span class="p">{</span><span class="nx">x</span><span class="o">:</span> <span class="mi">1</span><span class="p">,</span> <span class="nx">y</span><span class="o">:</span> <span class="mi">2</span><span class="p">};</span>
</span></span><span class="line"><span class="cl"><span class="nx">obj</span><span class="p">.</span><span class="nx">toString</span><span class="p">();</span>	<span class="c1">// &#34;[object Object]&#34;
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nx">obj</span><span class="p">.</span><span class="nx">toString</span> <span class="o">=</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span><span class="k">return</span> <span class="k">this</span><span class="p">.</span><span class="nx">x</span> <span class="o">+</span> <span class="k">this</span><span class="p">.</span><span class="nx">y</span><span class="p">;};</span>	<span class="c1">// 自定义 toString
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>
</span></span><span class="line"><span class="cl"><span class="s1">&#39;Result &#39;</span> <span class="o">+</span> <span class="nx">obj</span><span class="p">;</span>	<span class="c1">// &#34;Result 3&#34;, by toString
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="o">+</span><span class="nx">obj</span><span class="p">;</span>	<span class="c1">// 3, from toString
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>
</span></span><span class="line"><span class="cl"><span class="nx">obj</span><span class="p">.</span><span class="nx">valueOf</span> <span class="o">=</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span><span class="k">return</span> <span class="k">this</span><span class="p">.</span><span class="nx">x</span> <span class="o">+</span> <span class="k">this</span><span class="p">.</span><span class="nx">y</span> <span class="o">+</span> <span class="mi">100</span><span class="p">;};</span>	<span class="c1">// 自定义 valueOf
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="o">+</span><span class="nx">obj</span><span class="p">;</span>	<span class="c1">// 103, from valueOf
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="s1">&#39;Result &#39;</span> <span class="o">+</span> <span class="nx">obj</span><span class="p">;</span>	<span class="c1">// still &#34;Result 103&#34;
</span></span></span></code></pre></div><p>无论一元操作符 <code>+</code> 还是作为字符串拼接的二元操作符 <code>+</code>，在具体操作时都会尝试把对象转换为基本类型。它会先去找 <code>valueOf</code> ，如果其返回基本类型，则会以该值作为结果繁殖，当 <code>valueOf</code> 不存在或返回对象时，就会去找 <code>toString</code>。若二者都没存在或都返回对象，则会报错。</p>


  </div>

  <footer class="post-footer">
    <ul class="post-tags">
      <li><a href="https://jifan.tech/tags/javascript/">JavaScript</a></li>
      <li><a href="https://jifan.tech/tags/course-learning/">Course Learning</a></li>
    </ul>
<nav class="paginav">
  <a class="prev" href="https://jifan.tech/posts/2019-01-20-javascript-study-notes-3/">
    <span class="title">« Prev Page</span>
    <br>
    <span>JavaScript 学习笔记（三）：数组、数组操作以及数组方法</span>
  </a>
  <a class="next" href="https://jifan.tech/posts/2019-01-09-javascript-study-notes-1/">
    <span class="title">Next Page »</span>
    <br>
    <span>JavaScript 学习笔记（一）：数据类型、表达式、运算符和语句</span>
  </a>
</nav>

  </footer>
</article>
    </main>
    
<footer class="footer">
    <span>&copy; 2022 <a href="https://jifan.tech">Jifan&#39;s Blog</a></span>
    <span>
        Powered by
        <a href="https://gohugo.io/" rel="noopener noreferrer" target="_blank">Hugo</a> &
        <a href="https://git.io/hugopapermod" rel="noopener" target="_blank">PaperMod</a>
    </span>
</footer>
<a href="#top" aria-label="go to top" title="Go to Top (Alt + G)" class="top-link" id="top-link" accesskey="g">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentColor">
        <path d="M12 6H0l6-6z" />
    </svg>
</a>

<script>
    let menu = document.getElementById('menu')
    if (menu) {
        menu.scrollLeft = localStorage.getItem("menu-scroll-position");
        menu.onscroll = function () {
            localStorage.setItem("menu-scroll-position", menu.scrollLeft);
        }
    }

    document.querySelectorAll('a[href^="#"]').forEach(anchor => {
        anchor.addEventListener("click", function (e) {
            e.preventDefault();
            var id = this.getAttribute("href").substr(1);
            if (!window.matchMedia('(prefers-reduced-motion: reduce)').matches) {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView({
                    behavior: "smooth"
                });
            } else {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView();
            }
            if (id === "top") {
                history.replaceState(null, null, " ");
            } else {
                history.pushState(null, null, `#${id}`);
            }
        });
    });

</script>
<script>
    var mybutton = document.getElementById("top-link");
    window.onscroll = function () {
        if (document.body.scrollTop > 800 || document.documentElement.scrollTop > 800) {
            mybutton.style.visibility = "visible";
            mybutton.style.opacity = "1";
        } else {
            mybutton.style.visibility = "hidden";
            mybutton.style.opacity = "0";
        }
    };

</script>
<script>
    document.getElementById("theme-toggle").addEventListener("click", () => {
        if (document.body.className.includes("dark")) {
            document.body.classList.remove('dark');
            localStorage.setItem("pref-theme", 'light');
        } else {
            document.body.classList.add('dark');
            localStorage.setItem("pref-theme", 'dark');
        }
    })

</script>
<script>
    document.querySelectorAll('pre > code').forEach((codeblock) => {
        const container = codeblock.parentNode.parentNode;

        const copybutton = document.createElement('button');
        copybutton.classList.add('copy-code');
        copybutton.innerText = 'copy';

        function copyingDone() {
            copybutton.innerText = 'copied!';
            setTimeout(() => {
                copybutton.innerText = 'copy';
            }, 2000);
        }

        copybutton.addEventListener('click', (cb) => {
            if ('clipboard' in navigator) {
                navigator.clipboard.writeText(codeblock.textContent);
                copyingDone();
                return;
            }

            const range = document.createRange();
            range.selectNodeContents(codeblock);
            const selection = window.getSelection();
            selection.removeAllRanges();
            selection.addRange(range);
            try {
                document.execCommand('copy');
                copyingDone();
            } catch (e) { };
            selection.removeRange(range);
        });

        if (container.classList.contains("highlight")) {
            container.appendChild(copybutton);
        } else if (container.parentNode.firstChild == container) {
            
        } else if (codeblock.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName == "TABLE") {
            
            codeblock.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(copybutton);
        } else {
            
            codeblock.parentNode.appendChild(copybutton);
        }
    });
</script>
</body>

</html>
